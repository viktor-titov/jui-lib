// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import ease from 'tween-functions';
var Tween = /*#__PURE__*/function () {
  function Tween(_ref) {
    var _this = this;
    var duration = _ref.duration,
      from = _ref.from,
      to = _ref.to,
      delay = _ref.delay,
      onUpdate = _ref.onUpdate,
      onComplete = _ref.onComplete;
    this._frameCallback = function () {
      _this.timeoutID = undefined;
      _this.requestID = undefined;
      var current = Object.freeze(_this.getCurrent());
      if (_this.onUpdate) {
        _this.onUpdate(current);
      }
      if (_this.onComplete && current.done) {
        _this.onComplete(current);
      }
      if (current.done) {
        _this.onComplete = undefined;
        _this.onUpdate = undefined;
      } else {
        _this.requestID = window.requestAnimationFrame(_this._frameCallback);
      }
    };
    this.startTime = Date.now() + (delay || 0);
    this.duration = duration;
    this.from = from;
    this.to = to;
    if (!onUpdate && !onComplete) {
      this.onComplete = undefined;
      this.onUpdate = undefined;
      this.timeoutID = undefined;
      this.requestID = undefined;
    } else {
      this.onComplete = onComplete;
      this.onUpdate = onUpdate;
      if (delay) {
        // setTimeout from @types/node returns NodeJS.Timeout, so prefix with `window.`
        this.timeoutID = window.setTimeout(this._frameCallback, delay);
        this.requestID = undefined;
      } else {
        this.requestID = window.requestAnimationFrame(this._frameCallback);
        this.timeoutID = undefined;
      }
    }
  }
  var _proto = Tween.prototype;
  _proto.cancel = function cancel() {
    if (this.timeoutID != null) {
      clearTimeout(this.timeoutID);
      this.timeoutID = undefined;
    }
    if (this.requestID != null) {
      window.cancelAnimationFrame(this.requestID);
      this.requestID = undefined;
    }
    this.onComplete = undefined;
    this.onUpdate = undefined;
  };
  _proto.getCurrent = function getCurrent() {
    var t = Date.now() - this.startTime;
    if (t <= 0) {
      // still in the delay period
      return {
        done: false,
        value: this.from
      };
    }
    if (t >= this.duration) {
      // after the expiration
      return {
        done: true,
        value: this.to
      };
    }
    // mid-tween
    return {
      done: false,
      value: ease.easeOutQuint(t, this.from, this.to, this.duration)
    };
  };
  return Tween;
}();
export { Tween as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJlYXNlIiwiVHdlZW4iLCJfcmVmIiwiX3RoaXMiLCJkdXJhdGlvbiIsImZyb20iLCJ0byIsImRlbGF5Iiwib25VcGRhdGUiLCJvbkNvbXBsZXRlIiwiX2ZyYW1lQ2FsbGJhY2siLCJ0aW1lb3V0SUQiLCJ1bmRlZmluZWQiLCJyZXF1ZXN0SUQiLCJjdXJyZW50IiwiT2JqZWN0IiwiZnJlZXplIiwiZ2V0Q3VycmVudCIsImRvbmUiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93Iiwic2V0VGltZW91dCIsIl9wcm90byIsInByb3RvdHlwZSIsImNhbmNlbCIsImNsZWFyVGltZW91dCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwidCIsInZhbHVlIiwiZWFzZU91dFF1aW50IiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uL3NyYy9Ud2Vlbi50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE3IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy9cbi8vIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCBlYXNlIGZyb20gJ3R3ZWVuLWZ1bmN0aW9ucyc7XG5cbmltcG9ydCB7IFROaWwgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBUd2VlblN0YXRlIHtcbiAgZG9uZTogYm9vbGVhbjtcbiAgdmFsdWU6IG51bWJlcjtcbn1cblxudHlwZSBUVHdlZW5DYWxsYmFjayA9IChzdGF0ZTogVHdlZW5TdGF0ZSkgPT4gdm9pZDtcblxuZXhwb3J0IHR5cGUgVFR3ZWVuT3B0aW9ucyA9IHtcbiAgZGVsYXk/OiBudW1iZXI7XG4gIGR1cmF0aW9uOiBudW1iZXI7XG4gIGZyb206IG51bWJlcjtcbiAgb25Db21wbGV0ZT86IFRUd2VlbkNhbGxiYWNrO1xuICBvblVwZGF0ZT86IFRUd2VlbkNhbGxiYWNrO1xuICB0bzogbnVtYmVyO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVHdlZW4ge1xuICBvbkNvbXBsZXRlOiBUVHdlZW5DYWxsYmFjayB8IFROaWw7XG4gIG9uVXBkYXRlOiBUVHdlZW5DYWxsYmFjayB8IFROaWw7XG4gIGRlbGF5OiBudW1iZXIgfCBUTmlsO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICBmcm9tOiBudW1iZXI7XG4gIHJlcXVlc3RJRDogbnVtYmVyIHwgVE5pbDtcbiAgc3RhcnRUaW1lOiBudW1iZXI7XG4gIHRpbWVvdXRJRDogbnVtYmVyIHwgVE5pbDtcbiAgdG86IG51bWJlcjtcblxuICBjb25zdHJ1Y3Rvcih7IGR1cmF0aW9uLCBmcm9tLCB0bywgZGVsYXksIG9uVXBkYXRlLCBvbkNvbXBsZXRlIH06IFRUd2Vlbk9wdGlvbnMpIHtcbiAgICB0aGlzLnN0YXJ0VGltZSA9IERhdGUubm93KCkgKyAoZGVsYXkgfHwgMCk7XG4gICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgIHRoaXMuZnJvbSA9IGZyb207XG4gICAgdGhpcy50byA9IHRvO1xuICAgIGlmICghb25VcGRhdGUgJiYgIW9uQ29tcGxldGUpIHtcbiAgICAgIHRoaXMub25Db21wbGV0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMub25VcGRhdGUgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLnRpbWVvdXRJRCA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMucmVxdWVzdElEID0gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm9uQ29tcGxldGUgPSBvbkNvbXBsZXRlO1xuICAgICAgdGhpcy5vblVwZGF0ZSA9IG9uVXBkYXRlO1xuICAgICAgaWYgKGRlbGF5KSB7XG4gICAgICAgIC8vIHNldFRpbWVvdXQgZnJvbSBAdHlwZXMvbm9kZSByZXR1cm5zIE5vZGVKUy5UaW1lb3V0LCBzbyBwcmVmaXggd2l0aCBgd2luZG93LmBcbiAgICAgICAgdGhpcy50aW1lb3V0SUQgPSB3aW5kb3cuc2V0VGltZW91dCh0aGlzLl9mcmFtZUNhbGxiYWNrLCBkZWxheSk7XG4gICAgICAgIHRoaXMucmVxdWVzdElEID0gdW5kZWZpbmVkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0SUQgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX2ZyYW1lQ2FsbGJhY2spO1xuICAgICAgICB0aGlzLnRpbWVvdXRJRCA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfZnJhbWVDYWxsYmFjayA9ICgpID0+IHtcbiAgICB0aGlzLnRpbWVvdXRJRCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnJlcXVlc3RJRCA9IHVuZGVmaW5lZDtcbiAgICBjb25zdCBjdXJyZW50ID0gT2JqZWN0LmZyZWV6ZSh0aGlzLmdldEN1cnJlbnQoKSk7XG4gICAgaWYgKHRoaXMub25VcGRhdGUpIHtcbiAgICAgIHRoaXMub25VcGRhdGUoY3VycmVudCk7XG4gICAgfVxuICAgIGlmICh0aGlzLm9uQ29tcGxldGUgJiYgY3VycmVudC5kb25lKSB7XG4gICAgICB0aGlzLm9uQ29tcGxldGUoY3VycmVudCk7XG4gICAgfVxuICAgIGlmIChjdXJyZW50LmRvbmUpIHtcbiAgICAgIHRoaXMub25Db21wbGV0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHRoaXMub25VcGRhdGUgPSB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmVxdWVzdElEID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9mcmFtZUNhbGxiYWNrKTtcbiAgICB9XG4gIH07XG5cbiAgY2FuY2VsKCkge1xuICAgIGlmICh0aGlzLnRpbWVvdXRJRCAhPSBudWxsKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0SUQpO1xuICAgICAgdGhpcy50aW1lb3V0SUQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGlmICh0aGlzLnJlcXVlc3RJRCAhPSBudWxsKSB7XG4gICAgICB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5yZXF1ZXN0SUQpO1xuICAgICAgdGhpcy5yZXF1ZXN0SUQgPSB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHRoaXMub25Db21wbGV0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLm9uVXBkYXRlID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgZ2V0Q3VycmVudCgpOiBUd2VlblN0YXRlIHtcbiAgICBjb25zdCB0ID0gRGF0ZS5ub3coKSAtIHRoaXMuc3RhcnRUaW1lO1xuICAgIGlmICh0IDw9IDApIHtcbiAgICAgIC8vIHN0aWxsIGluIHRoZSBkZWxheSBwZXJpb2RcbiAgICAgIHJldHVybiB7IGRvbmU6IGZhbHNlLCB2YWx1ZTogdGhpcy5mcm9tIH07XG4gICAgfVxuICAgIGlmICh0ID49IHRoaXMuZHVyYXRpb24pIHtcbiAgICAgIC8vIGFmdGVyIHRoZSBleHBpcmF0aW9uXG4gICAgICByZXR1cm4geyBkb25lOiB0cnVlLCB2YWx1ZTogdGhpcy50byB9O1xuICAgIH1cbiAgICAvLyBtaWQtdHdlZW5cbiAgICByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IGVhc2UuZWFzZU91dFF1aW50KHQsIHRoaXMuZnJvbSwgdGhpcy50bywgdGhpcy5kdXJhdGlvbikgfTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxPQUFPQSxJQUFJLE1BQU0saUJBQWlCO0FBQUMsSUFvQmRDLEtBQUs7RUFXeEIsU0FBQUEsTUFBQUMsSUFBQSxFQUFnRjtJQUFBLElBQUFDLEtBQUE7SUFBQSxJQUFsRUMsUUFBUSxHQUFBRixJQUFBLENBQVJFLFFBQVE7TUFBRUMsSUFBSSxHQUFBSCxJQUFBLENBQUpHLElBQUk7TUFBRUMsRUFBRSxHQUFBSixJQUFBLENBQUZJLEVBQUU7TUFBRUMsS0FBSyxHQUFBTCxJQUFBLENBQUxLLEtBQUs7TUFBRUMsUUFBUSxHQUFBTixJQUFBLENBQVJNLFFBQVE7TUFBRUMsVUFBVSxHQUFBUCxJQUFBLENBQVZPLFVBQVU7SUFBQSxLQXdCN0RDLGNBQWMsR0FBRyxZQUFNO01BQ3JCUCxLQUFJLENBQUNRLFNBQVMsR0FBR0MsU0FBUztNQUMxQlQsS0FBSSxDQUFDVSxTQUFTLEdBQUdELFNBQVM7TUFDMUIsSUFBTUUsT0FBTyxHQUFHQyxNQUFNLENBQUNDLE1BQU0sQ0FBQ2IsS0FBSSxDQUFDYyxVQUFVLENBQUMsQ0FBQyxDQUFDO01BQ2hELElBQUlkLEtBQUksQ0FBQ0ssUUFBUSxFQUFFO1FBQ2pCTCxLQUFJLENBQUNLLFFBQVEsQ0FBQ00sT0FBTyxDQUFDO01BQ3hCO01BQ0EsSUFBSVgsS0FBSSxDQUFDTSxVQUFVLElBQUlLLE9BQU8sQ0FBQ0ksSUFBSSxFQUFFO1FBQ25DZixLQUFJLENBQUNNLFVBQVUsQ0FBQ0ssT0FBTyxDQUFDO01BQzFCO01B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