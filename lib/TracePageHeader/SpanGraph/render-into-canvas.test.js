// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { range as _range } from 'lodash';
import renderIntoCanvas, { ITEM_ALPHA, MIN_ITEM_HEIGHT, MAX_TOTAL_HEIGHT, MIN_ITEM_WIDTH, MIN_TOTAL_HEIGHT, MAX_ITEM_HEIGHT } from './render-into-canvas';
var BG_COLOR = '#FFFFFF';
var getCanvasWidth = function getCanvasWidth() {
  return window.innerWidth * 2;
};
var getBgFillRect = function getBgFillRect(items) {
  return {
    fillStyle: BG_COLOR,
    height: !items || items.length < MIN_TOTAL_HEIGHT ? MIN_TOTAL_HEIGHT : Math.min(MAX_TOTAL_HEIGHT, items.length),
    width: getCanvasWidth(),
    x: 0,
    y: 0
  };
};
describe('renderIntoCanvas()', function () {
  var basicItem = {
    valueWidth: 100,
    valueOffset: 50,
    serviceName: 'some-name'
  };
  var CanvasContext = /*#__PURE__*/function () {
    function CanvasContext() {
      this.fillRectAccumulator = [];
      this.fillStyle = undefined;
      this.fillRectAccumulator = [];
    }
    var _proto = CanvasContext.prototype;
    _proto.fillRect = function fillRect(x, y, width, height) {
      var fillStyle = this.fillStyle;
      this.fillRectAccumulator.push({
        fillStyle: fillStyle,
        height: height,
        width: width,
        x: x,
        y: y
      });
    };
    return CanvasContext;
  }();
  var Canvas = /*#__PURE__*/function () {
    function Canvas() {
      this.contexts = [];
      this.height = NaN;
      this.width = NaN;
      this.getContext = jest.fn(this._getContext.bind(this));
    }
    var _proto2 = Canvas.prototype;
    _proto2._getContext = function _getContext() {
      var ctx = new CanvasContext();
      this.contexts.push(ctx);
      return ctx;
    };
    return Canvas;
  }();
  function getColorFactory() {
    var i = 0;
    var inputOutput = [];
    function getFakeColor(str) {
      var rv = [i, i, i];
      i++;
      inputOutput.push({
        input: str,
        output: rv.slice()
      });
      return rv;
    }
    getFakeColor.inputOutput = inputOutput;
    return getFakeColor;
  }
  it('sets the width', function () {
    var canvas = new Canvas();
    expect(canvas.width !== canvas.width).toBe(true);
    renderIntoCanvas(canvas, [basicItem], 150, getColorFactory(), BG_COLOR);
    expect(canvas.width).toBe(getCanvasWidth());
  });
  describe('when there are limited number of items', function () {
    it('sets the height', function () {
      var canvas = new Canvas();
      expect(canvas.height !== canvas.height).toBe(true);
      renderIntoCanvas(canvas, [basicItem], 150, getColorFactory(), BG_COLOR);
      expect(canvas.height).toBe(MIN_TOTAL_HEIGHT);
    });
    it('draws the background', function () {
      var expectedDrawing = [getBgFillRect()];
      var canvas = new Canvas();
      var items = [];
      var totalValueWidth = 4000;
      var getFillColor = getColorFactory();
      renderIntoCanvas(canvas, items, totalValueWidth, getFillColor, BG_COLOR);
      expect(canvas.getContext.mock.calls).toEqual([['2d', {
        alpha: false
      }]]);
      expect(canvas.contexts.length).toBe(1);
      expect(canvas.contexts[0].fillRectAccumulator).toEqual(expectedDrawing);
    });
    it('draws the map', function () {
      var totalValueWidth = 4000;
      var items = [{
        valueWidth: 50,
        valueOffset: 50,
        serviceName: 'service-name-0'
      }, {
        valueWidth: 100,
        valueOffset: 100,
        serviceName: 'service-name-1'
      }, {
        valueWidth: 150,
        valueOffset: 150,
        serviceName: 'service-name-2'
      }];
      var expectedColors = [{
        input: items[0].serviceName,
        output: [0, 0, 0]
      }, {
        input: items[1].serviceName,
        output: [1, 1, 1]
      }, {
        input: items[2].serviceName,
        output: [2, 2, 2]
      }];
      var cHeight = items.length < MIN_TOTAL_HEIGHT ? MIN_TOTAL_HEIGHT : Math.min(items.length, MAX_TOTAL_HEIGHT);
      var expectedDrawings = [getBgFillRect()].concat(items.map(function (item, i) {
        var valueWidth = item.valueWidth,
          valueOffset = item.valueOffset;
        var color = expectedColors[i].output;
        var fillStyle = "rgba(" + color.concat(ITEM_ALPHA).join() + ")";
        var height = Math.min(MAX_ITEM_HEIGHT, Math.max(MIN_ITEM_HEIGHT, cHeight / items.length));
        var width = valueWidth / totalValueWidth * getCanvasWidth();
        var x = valueOffset / totalValueWidth * getCanvasWidth();
        var y = cHeight / items.length * i;
        return {
          fillStyle: fillStyle,
          height: height,
          width: width,
          x: x,
          y: y
        };
      }));
      var canvas = new Canvas();
      var getFillColor = getColorFactory();
      renderIntoCanvas(canvas, items, totalValueWidth, getFillColor, BG_COLOR);
      expect(getFillColor.inputOutput).toEqual(expectedColors);
      expect(canvas.getContext.mock.calls).toEqual([['2d', {
        alpha: false
      }]]);
      expect(canvas.contexts.length).toBe(1);
      expect(canvas.contexts[0].fillRectAccumulator).toEqual(expectedDrawings);
    });
  });
  describe('when there are many items', function () {
    it('sets the height when there are many items', function () {
      var canvas = new Canvas();
      var items = [];
      for (var i = 0; i < MIN_TOTAL_HEIGHT + 1; i++) {
        items.push(basicItem);
      }
      expect(canvas.height !== canvas.height).toBe(true);
      renderIntoCanvas(canvas, items, 150, getColorFactory(), BG_COLOR);
      expect(canvas.height).toBe(items.length);
    });
    it('draws the map', function () {
      var totalValueWidth = 4000;
      var items = _range(MIN_TOTAL_HEIGHT * 10).map(function (i) {
        return {
          valueWidth: i,
          valueOffset: i,
          serviceName: "service-name-" + i
        };
      });
      var expectedColors = items.map(function (item, i) {
        return {
          input: item.serviceName,
          output: [i, i, i]
        };
      });
      var expectedDrawings = [getBgFillRect(items)].concat(items.map(function (item, i) {
        var valueWidth = item.valueWidth,
          valueOffset = item.valueOffset;
        var color = expectedColors[i].output;
        var fillStyle = "rgba(" + color.concat(ITEM_ALPHA).join() + ")";
        var height = MIN_ITEM_HEIGHT;
        var width = Math.max(MIN_ITEM_WIDTH, valueWidth / totalValueWidth * getCanvasWidth());
        var x = valueOffset / totalValueWidth * getCanvasWidth();
        var y = MAX_TOTAL_HEIGHT / items.length * i;
        return {
          fillStyle: fillStyle,
          height: height,
          width: width,
          x: x,
          y: y
        };
      }));
      var canvas = new Canvas();
      var getFillColor = getColorFactory();
      renderIntoCanvas(canvas, items, totalValueWidth, getFillColor, BG_COLOR);
      expect(getFillColor.inputOutput).toEqual(expectedColors);
      expect(canvas.getContext.mock.calls).toEqual([['2d', {
        alpha: false
      }]]);
      expect(canvas.contexts.length).toBe(1);
      expect(canvas.contexts[0].fillRectAccumulator).toEqual(expectedDrawings);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyYW5nZSIsIl9yYW5nZSIsInJlbmRlckludG9DYW52YXMiLCJJVEVNX0FMUEhBIiwiTUlOX0lURU1fSEVJR0hUIiwiTUFYX1RPVEFMX0hFSUdIVCIsIk1JTl9JVEVNX1dJRFRIIiwiTUlOX1RPVEFMX0hFSUdIVCIsIk1BWF9JVEVNX0hFSUdIVCIsIkJHX0NPTE9SIiwiZ2V0Q2FudmFzV2lkdGgiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiZ2V0QmdGaWxsUmVjdCIsIml0ZW1zIiwiZmlsbFN0eWxlIiwiaGVpZ2h0IiwibGVuZ3RoIiwiTWF0aCIsIm1pbiIsIndpZHRoIiwieCIsInkiLCJkZXNjcmliZSIsImJhc2ljSXRlbSIsInZhbHVlV2lkdGgiLCJ2YWx1ZU9mZnNldCIsInNlcnZpY2VOYW1lIiwiQ2FudmFzQ29udGV4dCIsImZpbGxSZWN0QWNjdW11bGF0b3IiLCJ1bmRlZmluZWQiLCJfcHJvdG8iLCJwcm90b3R5cGUiLCJmaWxsUmVjdCIsInB1c2giLCJDYW52YXMiLCJjb250ZXh0cyIsIk5hTiIsImdldENvbnRleHQiLCJqZXN0IiwiZm4iLCJfZ2V0Q29udGV4dCIsImJpbmQiLCJfcHJvdG8yIiwiY3R4IiwiZ2V0Q29sb3JGYWN0b3J5IiwiaSIsImlucHV0T3V0cHV0IiwiZ2V0RmFrZUNvbG9yIiwic3RyIiwicnYiLCJpbnB1dCIsIm91dHB1dCIsInNsaWNlIiwiaXQiLCJjYW52YXMiLCJleHBlY3QiLCJ0b0JlIiwiZXhwZWN0ZWREcmF3aW5nIiwidG90YWxWYWx1ZVdpZHRoIiwiZ2V0RmlsbENvbG9yIiwibW9jayIsImNhbGxzIiwidG9FcXVhbCIsImFscGhhIiwiZXhwZWN0ZWRDb2xvcnMiLCJjSGVpZ2h0IiwiZXhwZWN0ZWREcmF3aW5ncyIsImNvbmNhdCIsIm1hcCIsIml0ZW0iLCJjb2xvciIsImpvaW4iLCJtYXgiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvVHJhY2VQYWdlSGVhZGVyL1NwYW5HcmFwaC9yZW5kZXItaW50by1jYW52YXMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMTcgVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgcmFuZ2UgYXMgX3JhbmdlIH0gZnJvbSAnbG9kYXNoJztcblxuaW1wb3J0IHJlbmRlckludG9DYW52YXMsIHtcbiAgSVRFTV9BTFBIQSxcbiAgTUlOX0lURU1fSEVJR0hULFxuICBNQVhfVE9UQUxfSEVJR0hULFxuICBNSU5fSVRFTV9XSURUSCxcbiAgTUlOX1RPVEFMX0hFSUdIVCxcbiAgTUFYX0lURU1fSEVJR0hULFxufSBmcm9tICcuL3JlbmRlci1pbnRvLWNhbnZhcyc7XG5cbmNvbnN0IEJHX0NPTE9SID0gJyNGRkZGRkYnO1xuXG5jb25zdCBnZXRDYW52YXNXaWR0aCA9ICgpID0+IHdpbmRvdy5pbm5lcldpZHRoICogMjtcbmNvbnN0IGdldEJnRmlsbFJlY3QgPSAoaXRlbXM/OiBBcnJheTx7IHZhbHVlV2lkdGg6IG51bWJlcjsgdmFsdWVPZmZzZXQ6IG51bWJlcjsgc2VydmljZU5hbWU6IHN0cmluZyB9PikgPT4gKHtcbiAgZmlsbFN0eWxlOiBCR19DT0xPUixcbiAgaGVpZ2h0OiAhaXRlbXMgfHwgaXRlbXMubGVuZ3RoIDwgTUlOX1RPVEFMX0hFSUdIVCA/IE1JTl9UT1RBTF9IRUlHSFQgOiBNYXRoLm1pbihNQVhfVE9UQUxfSEVJR0hULCBpdGVtcy5sZW5ndGgpLFxuICB3aWR0aDogZ2V0Q2FudmFzV2lkdGgoKSxcbiAgeDogMCxcbiAgeTogMCxcbn0pO1xuXG5kZXNjcmliZSgncmVuZGVySW50b0NhbnZhcygpJywgKCkgPT4ge1xuICBjb25zdCBiYXNpY0l0ZW0gPSB7IHZhbHVlV2lkdGg6IDEwMCwgdmFsdWVPZmZzZXQ6IDUwLCBzZXJ2aWNlTmFtZTogJ3NvbWUtbmFtZScgfTtcblxuICBjbGFzcyBDYW52YXNDb250ZXh0IHtcbiAgICBmaWxsU3R5bGU6IHVuZGVmaW5lZDtcbiAgICBmaWxsUmVjdEFjY3VtdWxhdG9yOiBBcnJheTx7IGZpbGxTdHlsZTogdW5kZWZpbmVkOyBoZWlnaHQ6IG51bWJlcjsgd2lkdGg6IG51bWJlcjsgeDogbnVtYmVyOyB5OiBudW1iZXIgfT4gPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgdGhpcy5maWxsU3R5bGUgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLmZpbGxSZWN0QWNjdW11bGF0b3IgPSBbXTtcbiAgICB9XG5cbiAgICBmaWxsUmVjdCh4OiBudW1iZXIsIHk6IG51bWJlciwgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcbiAgICAgIGNvbnN0IGZpbGxTdHlsZSA9IHRoaXMuZmlsbFN0eWxlO1xuICAgICAgdGhpcy5maWxsUmVjdEFjY3VtdWxhdG9yLnB1c2goe1xuICAgICAgICBmaWxsU3R5bGUsXG4gICAgICAgIGhlaWdodCxcbiAgICAgICAgd2lkdGgsXG4gICAgICAgIHgsXG4gICAgICAgIHksXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjbGFzcyBDYW52YXMge1xuICAgIGhlaWdodDogbnVtYmVyO1xuICAgIHdpZHRoOiBudW1iZXI7XG4gICAgY29udGV4dHM6IENhbnZhc0NvbnRleHRbXTtcbiAgICBnZXRDb250ZXh0OiBqZXN0Lk1vY2s7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgIHRoaXMuY29udGV4dHMgPSBbXTtcbiAgICAgIHRoaXMuaGVpZ2h0ID0gTmFOO1xuICAgICAgdGhpcy53aWR0aCA9IE5hTjtcbiAgICAgIHRoaXMuZ2V0Q29udGV4dCA9IGplc3QuZm4odGhpcy5fZ2V0Q29udGV4dC5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBfZ2V0Q29udGV4dCgpIHtcbiAgICAgIGNvbnN0IGN0eCA9IG5ldyBDYW52YXNDb250ZXh0KCk7XG4gICAgICB0aGlzLmNvbnRleHRzLnB1c2goY3R4KTtcbiAgICAgIHJldHVybiBjdHg7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Q29sb3JGYWN0b3J5KCkge1xuICAgIGxldCBpID0gMDtcbiAgICBjb25zdCBpbnB1dE91dHB1dDogQXJyYXk8eyBpbnB1dDogc3RyaW5nOyBvdXRwdXQ6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSB9PiA9IFtdO1xuICAgIGZ1bmN0aW9uIGdldEZha2VDb2xvcihzdHI6IHN0cmluZykge1xuICAgICAgY29uc3QgcnY6IFtudW1iZXIsIG51bWJlciwgbnVtYmVyXSA9IFtpLCBpLCBpXTtcbiAgICAgIGkrKztcbiAgICAgIGlucHV0T3V0cHV0LnB1c2goe1xuICAgICAgICBpbnB1dDogc3RyLFxuICAgICAgICBvdXRwdXQ6IHJ2LnNsaWNlKCkgYXMgW251bWJlciwgbnVtYmVyLCBudW1iZXJdLFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcnY7XG4gICAgfVxuICAgIGdldEZha2VDb2xvci5pbnB1dE91dHB1dCA9IGlucHV0T3V0cHV0O1xuICAgIHJldHVybiBnZXRGYWtlQ29sb3I7XG4gIH1cblxuICBpdCgnc2V0cyB0aGUgd2lkdGgnLCAoKSA9PiB7XG4gICAgY29uc3QgY2FudmFzID0gbmV3IENhbnZhcygpO1xuICAgIGV4cGVjdChjYW52YXMud2lkdGggIT09IGNhbnZhcy53aWR0aCkudG9CZSh0cnVlKTtcbiAgICByZW5kZXJJbnRvQ2FudmFzKGNhbnZhcyBhcyB1bmtub3duIGFzIEhUTUxDYW52YXNFbGVtZW50LCBbYmFzaWNJdGVtXSwgMTUwLCBnZXRDb2xvckZhY3RvcnkoKSwgQkdfQ09MT1IpO1xuICAgIGV4cGVjdChjYW52YXMud2lkdGgpLnRvQmUoZ2V0Q2FudmFzV2lkdGgoKSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd3aGVuIHRoZXJlIGFyZSBsaW1pdGVkIG51bWJlciBvZiBpdGVtcycsICgpID0+IHtcbiAgICBpdCgnc2V0cyB0aGUgaGVpZ2h0JywgKCkgPT4ge1xuICAgICAgY29uc3QgY2FudmFzID0gbmV3IENhbnZhcygpO1xuICAgICAgZXhwZWN0KGNhbnZhcy5oZWlnaHQgIT09IGNhbnZhcy5oZWlnaHQpLnRvQmUodHJ1ZSk7XG4gICAgICByZW5kZXJJbnRvQ2FudmFzKGNhbnZhcyBhcyB1bmtub3duIGFzIEhUTUxDYW52YXNFbGVtZW50LCBbYmFzaWNJdGVtXSwgMTUwLCBnZXRDb2xvckZhY3RvcnkoKSwgQkdfQ09MT1IpO1xuICAgICAgZXhwZWN0KGNhbnZhcy5oZWlnaHQpLnRvQmUoTUlOX1RPVEFMX0hFSUdIVCk7XG4gICAgfSk7XG5cbiAgICBpdCgnZHJhd3MgdGhlIGJhY2tncm91bmQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBleHBlY3RlZERyYXdpbmcgPSBbZ2V0QmdGaWxsUmVjdCgpXTtcbiAgICAgIGNvbnN0IGNhbnZhcyA9IG5ldyBDYW52YXMoKTtcbiAgICAgIGNvbnN0IGl0ZW1zOiBBcnJheTx7IHZhbHVlV2lkdGg6IG51bWJlcjsgdmFsdWVPZmZzZXQ6IG51bWJlcjsgc2VydmljZU5hbWU6IHN0cmluZyB9PiA9IFtdO1xuICAgICAgY29uc3QgdG90YWxWYWx1ZVdpZHRoID0gNDAwMDtcbiAgICAgIGNvbnN0IGdldEZpbGxDb2xvciA9IGdldENvbG9yRmFjdG9yeSgpO1xuICAgICAgcmVuZGVySW50b0NhbnZhcyhjYW52YXMgYXMgdW5rbm93biBhcyBIVE1MQ2FudmFzRWxlbWVudCwgaXRlbXMsIHRvdGFsVmFsdWVXaWR0aCwgZ2V0RmlsbENvbG9yLCBCR19DT0xPUik7XG4gICAgICBleHBlY3QoKGNhbnZhcy5nZXRDb250ZXh0IGFzIGplc3QuTW9jaykubW9jay5jYWxscykudG9FcXVhbChbWycyZCcsIHsgYWxwaGE6IGZhbHNlIH1dXSk7XG4gICAgICBleHBlY3QoY2FudmFzLmNvbnRleHRzLmxlbmd0aCkudG9CZSgxKTtcbiAgICAgIGV4cGVjdChjYW52YXMuY29udGV4dHNbMF0uZmlsbFJlY3RBY2N1bXVsYXRvcikudG9FcXVhbChleHBlY3RlZERyYXdpbmcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RyYXdzIHRoZSBtYXAnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0b3RhbFZhbHVlV2lkdGggPSA0MDAwO1xuICAgICAgY29uc3QgaXRlbXMgPSBbXG4gICAgICAgIHsgdmFsdWVXaWR0aDogNTAsIHZhbHVlT2Zmc2V0OiA1MCwgc2VydmljZU5hbWU6ICdzZXJ2aWNlLW5hbWUtMCcgfSxcbiAgICAgICAgeyB2YWx1ZVdpZHRoOiAxMDAsIHZhbHVlT2Zmc2V0OiAxMDAsIHNlcnZpY2VOYW1lOiAnc2VydmljZS1uYW1lLTEnIH0sXG4gICAgICAgIHsgdmFsdWVXaWR0aDogMTUwLCB2YWx1ZU9mZnNldDogMTUwLCBzZXJ2aWNlTmFtZTogJ3NlcnZpY2UtbmFtZS0yJyB9LFxuICAgICAgXTtcbiAgICAgIGNvbnN0IGV4cGVjdGVkQ29sb3JzID0gW1xuICAgICAgICB7IGlucHV0OiBpdGVtc1swXS5zZXJ2aWNlTmFtZSwgb3V0cHV0OiBbMCwgMCwgMF0gfSxcbiAgICAgICAgeyBpbnB1dDogaXRlbXNbMV0uc2VydmljZU5hbWUsIG91dHB1dDogWzEsIDEsIDFdIH0sXG4gICAgICAgIHsgaW5wdXQ6IGl0ZW1zWzJdLnNlcnZpY2VOYW1lLCBvdXRwdXQ6IFsyLCAyLCAyXSB9LFxuICAgICAgXTtcbiAgICAgIGNvbnN0IGNIZWlnaHQgPSBpdGVtcy5sZW5ndGggPCBNSU5fVE9UQUxfSEVJR0hUID8gTUlOX1RPVEFMX0hFSUdIVCA6IE1hdGgubWluKGl0ZW1zLmxlbmd0aCwgTUFYX1RPVEFMX0hFSUdIVCk7XG5cbiAgICAgIGNvbnN0IGV4cGVjdGVkRHJhd2luZ3MgPSBbXG4gICAgICAgIGdldEJnRmlsbFJlY3QoKSxcbiAgICAgICAgLi4uaXRlbXMubWFwKChpdGVtLCBpKSA9PiB7XG4gICAgICAgICAgY29uc3QgeyB2YWx1ZVdpZHRoLCB2YWx1ZU9mZnNldCB9ID0gaXRlbTtcbiAgICAgICAgICBjb25zdCBjb2xvciA9IGV4cGVjdGVkQ29sb3JzW2ldLm91dHB1dDtcbiAgICAgICAgICBjb25zdCBmaWxsU3R5bGUgPSBgcmdiYSgke2NvbG9yLmNvbmNhdChJVEVNX0FMUEhBKS5qb2luKCl9KWA7XG4gICAgICAgICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5taW4oTUFYX0lURU1fSEVJR0hULCBNYXRoLm1heChNSU5fSVRFTV9IRUlHSFQsIGNIZWlnaHQgLyBpdGVtcy5sZW5ndGgpKTtcbiAgICAgICAgICBjb25zdCB3aWR0aCA9ICh2YWx1ZVdpZHRoIC8gdG90YWxWYWx1ZVdpZHRoKSAqIGdldENhbnZhc1dpZHRoKCk7XG4gICAgICAgICAgY29uc3QgeCA9ICh2YWx1ZU9mZnNldCAvIHRvdGFsVmFsdWVXaWR0aCkgKiBnZXRDYW52YXNXaWR0aCgpO1xuICAgICAgICAgIGNvbnN0IHkgPSAoY0hlaWdodCAvIGl0ZW1zLmxlbmd0aCkgKiBpO1xuICAgICAgICAgIHJldHVybiB7IGZpbGxTdHlsZSwgaGVpZ2h0LCB3aWR0aCwgeCwgeSB9O1xuICAgICAgICB9KSxcbiAgICAgIF07XG4gICAgICBjb25zdCBjYW52YXMgPSBuZXcgQ2FudmFzKCk7XG4gICAgICBjb25zdCBnZXRGaWxsQ29sb3IgPSBnZXRDb2xvckZhY3RvcnkoKTtcbiAgICAgIHJlbmRlckludG9DYW52YXMoY2FudmFzIGFzIHVua25vd24gYXMgSFRNTENhbnZhc0VsZW1lbnQsIGl0ZW1zLCB0b3RhbFZhbHVlV2lkdGgsIGdldEZpbGxDb2xvciwgQkdfQ09MT1IpO1xuICAgICAgZXhwZWN0KGdldEZpbGxDb2xvci5pbnB1dE91dHB1dCkudG9FcXVhbChleHBlY3RlZENvbG9ycyk7XG4gICAgICBleHBlY3QoY2FudmFzLmdldENvbnRleHQubW9jay5jYWxscykudG9FcXVhbChbWycyZCcsIHsgYWxwaGE6IGZhbHNlIH1dXSk7XG4gICAgICBleHBlY3QoY2FudmFzLmNvbnRleHRzLmxlbmd0aCkudG9CZSgxKTtcbiAgICAgIGV4cGVjdChjYW52YXMuY29udGV4dHNbMF0uZmlsbFJlY3RBY2N1bXVsYXRvcikudG9FcXVhbChleHBlY3RlZERyYXdpbmdzKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3doZW4gdGhlcmUgYXJlIG1hbnkgaXRlbXMnLCAoKSA9PiB7XG4gICAgaXQoJ3NldHMgdGhlIGhlaWdodCB3aGVuIHRoZXJlIGFyZSBtYW55IGl0ZW1zJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2FudmFzID0gbmV3IENhbnZhcygpO1xuICAgICAgY29uc3QgaXRlbXMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTUlOX1RPVEFMX0hFSUdIVCArIDE7IGkrKykge1xuICAgICAgICBpdGVtcy5wdXNoKGJhc2ljSXRlbSk7XG4gICAgICB9XG4gICAgICBleHBlY3QoY2FudmFzLmhlaWdodCAhPT0gY2FudmFzLmhlaWdodCkudG9CZSh0cnVlKTtcbiAgICAgIHJlbmRlckludG9DYW52YXMoY2FudmFzIGFzIHVua25vd24gYXMgSFRNTENhbnZhc0VsZW1lbnQsIGl0ZW1zLCAxNTAsIGdldENvbG9yRmFjdG9yeSgpLCBCR19DT0xPUik7XG4gICAgICBleHBlY3QoY2FudmFzLmhlaWdodCkudG9CZShpdGVtcy5sZW5ndGgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ2RyYXdzIHRoZSBtYXAnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0b3RhbFZhbHVlV2lkdGggPSA0MDAwO1xuICAgICAgY29uc3QgaXRlbXMgPSBfcmFuZ2UoTUlOX1RPVEFMX0hFSUdIVCAqIDEwKS5tYXAoKGkpID0+ICh7XG4gICAgICAgIHZhbHVlV2lkdGg6IGksXG4gICAgICAgIHZhbHVlT2Zmc2V0OiBpLFxuICAgICAgICBzZXJ2aWNlTmFtZTogYHNlcnZpY2UtbmFtZS0ke2l9YCxcbiAgICAgIH0pKTtcbiAgICAgIGNvbnN0IGV4cGVjdGVkQ29sb3JzID0gaXRlbXMubWFwKChpdGVtLCBpKSA9PiAoe1xuICAgICAgICBpbnB1dDogaXRlbS5zZXJ2aWNlTmFtZSxcbiAgICAgICAgb3V0cHV0OiBbaSwgaSwgaV0sXG4gICAgICB9KSk7XG4gICAgICBjb25zdCBleHBlY3RlZERyYXdpbmdzID0gW1xuICAgICAgICBnZXRCZ0ZpbGxSZWN0KGl0ZW1zKSxcbiAgICAgICAgLi4uaXRlbXMubWFwKChpdGVtLCBpKSA9PiB7XG4gICAgICAgICAgY29uc3QgeyB2YWx1ZVdpZHRoLCB2YWx1ZU9mZnNldCB9ID0gaXRlbTtcbiAgICAgICAgICBjb25zdCBjb2xvciA9IGV4cGVjdGVkQ29sb3JzW2ldLm91dHB1dDtcbiAgICAgICAgICBjb25zdCBmaWxsU3R5bGUgPSBgcmdiYSgke2NvbG9yLmNvbmNhdChJVEVNX0FMUEhBKS5qb2luKCl9KWA7XG4gICAgICAgICAgY29uc3QgaGVpZ2h0ID0gTUlOX0lURU1fSEVJR0hUO1xuICAgICAgICAgIGNvbnN0IHdpZHRoID0gTWF0aC5tYXgoTUlOX0lURU1fV0lEVEgsICh2YWx1ZVdpZHRoIC8gdG90YWxWYWx1ZVdpZHRoKSAqIGdldENhbnZhc1dpZHRoKCkpO1xuICAgICAgICAgIGNvbnN0IHggPSAodmFsdWVPZmZzZXQgLyB0b3RhbFZhbHVlV2lkdGgpICogZ2V0Q2FudmFzV2lkdGgoKTtcbiAgICAgICAgICBjb25zdCB5ID0gKE1BWF9UT1RBTF9IRUlHSFQgLyBpdGVtcy5sZW5ndGgpICogaTtcbiAgICAgICAgICByZXR1cm4geyBmaWxsU3R5bGUsIGhlaWdodCwgd2lkdGgsIHgsIHkgfTtcbiAgICAgICAgfSksXG4gICAgICBdO1xuICAgICAgY29uc3QgY2FudmFzID0gbmV3IENhbnZhcygpO1xuICAgICAgY29uc3QgZ2V0RmlsbENvbG9yID0gZ2V0Q29sb3JGYWN0b3J5KCk7XG4gICAgICByZW5kZXJJbnRvQ2FudmFzKGNhbnZhcyBhcyB1bmtub3duIGFzIEhUTUxDYW52YXNFbGVtZW50LCBpdGVtcywgdG90YWxWYWx1ZVdpZHRoLCBnZXRGaWxsQ29sb3IsIEJHX0NPTE9SKTtcbiAgICAgIGV4cGVjdChnZXRGaWxsQ29sb3IuaW5wdXRPdXRwdXQpLnRvRXF1YWwoZXhwZWN0ZWRDb2xvcnMpO1xuICAgICAgZXhwZWN0KChjYW52YXMuZ2V0Q29udGV4dCBhcyBqZXN0Lk1vY2spLm1vY2suY2FsbHMpLnRvRXF1YWwoW1snMmQnLCB7IGFscGhhOiBmYWxzZSB9XV0pO1xuICAgICAgZXhwZWN0KGNhbnZhcy5jb250ZXh0cy5sZW5ndGgpLnRvQmUoMSk7XG4gICAgICBleHBlY3QoY2FudmFzLmNvbnRleHRzWzBdLmZpbGxSZWN0QWNjdW11bGF0b3IpLnRvRXF1YWwoZXhwZWN0ZWREcmF3aW5ncyk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBQVNBLEtBQUssSUFBSUMsTUFBTSxRQUFRLFFBQVE7QUFFeEMsT0FBT0MsZ0JBQWdCLElBQ3JCQyxVQUFVLEVBQ1ZDLGVBQWUsRUFDZkMsZ0JBQWdCLEVBQ2hCQyxjQUFjLEVBQ2RDLGdCQUFnQixFQUNoQkMsZUFBZSxRQUNWLHNCQUFzQjtBQUU3QixJQUFNQyxRQUFRLEdBQUcsU0FBUztBQUUxQixJQUFNQyxjQUFjLEdBQUcsU0FBakJBLGNBQWNBLENBQUE7RUFBQSxPQUFTQyxNQUFNLENBQUNDLFVBQVUsR0FBRyxDQUFDO0FBQUE7QUFDbEQsSUFBTUMsYUFBYSxHQUFHLFNBQWhCQSxhQUFhQSxDQUFJQyxLQUErRTtFQUFBLE9BQU07SUFDMUdDLFNBQVMsRUFBRU4sUUFBUTtJQUNuQk8sTUFBTSxFQUFFLENBQUNGLEtBQUssSUFBSUEsS0FBSyxDQUFDRyxNQUFNLEdBQUdWLGdCQUFnQixHQUFHQSxnQkFBZ0IsR0FBR1csSUFBSSxDQUFDQyxHQUFHLENBQUNkLGdCQUFnQixFQUFFUyxLQUFLLENBQUNHLE1BQU0sQ0FBQztJQUMvR0csS0FBSyxFQUFFVixjQUFjLENBQUMsQ0FBQztJQUN2QlcsQ0FBQyxFQUFFLENBQUM7SUFDSkMsQ0FBQyxFQUFFO0VBQ0wsQ0FBQztBQUFBLENBQUM7QUFFRkMsUUFBUSxDQUFDLG9CQUFvQixFQUFFLFlBQU07RUFDbkMsSUFBTUMsU0FBUyxHQUFHO0lBQUVDLFVBQVUsRUFBRSxHQUFHO0lBQUVDLFdBQVcsRUFBRSxFQUFFO0lBQUVDLFdBQVcsRUFBRTtFQUFZLENBQUM7RUFBQyxJQUUzRUMsYUFBYTtJQUlqQixTQUFBQSxjQUFBLEVBQWM7TUFBQSxLQUZkQyxtQkFBbUIsR0FBeUYsRUFBRTtNQUc1RyxJQUFJLENBQUNkLFNBQVMsR0FBR2UsU0FBUztNQUMxQixJQUFJLENBQUNELG1CQUFtQixHQUFHLEVBQUU7SUFDL0I7SUFBQyxJQUFBRSxNQUFBLEdBQUFILGFBQUEsQ0FBQUksU0FBQTtJQUFBRCxNQUFBLENBRURFLFFBQVEsR0FBUixTQUFBQSxTQUFTWixDQUFTLEVBQUVDLENBQVMsRUFBRUYsS0FBYSxFQUFFSixNQUFjLEVBQUU7TUFDNUQsSUFBTUQsU0FBUyxHQUFHLElBQUksQ0FBQ0EsU0FBUztNQUNoQyxJQUFJLENBQUNjLG1CQUFtQixDQUFDSyxJQUFJLENBQUM7UUFDNUJuQixTQUFTLEVBQVRBLFNBQVM7UUFDVEMsTUFBTSxFQUFOQSxNQUFNO1FBQ05JLEtBQUssRUFBTEEsS0FBSztRQUNMQyxDQUFDLEVBQURBLENBQUM7UUFDREMsQ0FBQyxFQUFEQTtNQUNGLENBQUMsQ0FBQztJQUNKLENBQUM7SUFBQSxPQUFBTSxhQUFBO0VBQUE7RUFBQSxJQUdHTyxNQUFNO0lBTVYsU0FBQUEsT0FBQSxFQUFjO01BQ1osSUFBSSxDQUFDQyxRQUFRLEdBQUcsRUFBRTtNQUNsQixJQUFJLENBQUNwQixNQUFNLEdBQUdxQixHQUFHO01BQ2pCLElBQUksQ0FBQ2pCLEtBQUssR0FBR2lCLEdBQUc7TUFDaEIsSUFBSSxDQUFDQyxVQUFVLEdBQUdDLElBQUksQ0FBQ0MsRUFBRSxDQUFDLElBQUksQ0FBQ0MsV0FBVyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDeEQ7SUFBQyxJQUFBQyxPQUFBLEdBQUFSLE1BQUEsQ0FBQUgsU0FBQTtJQUFBVyxPQUFBLENBRURGLFdBQVcsR0FBWCxTQUFBQSxZQUFBLEVBQWM7TUFDWixJQUFNRyxHQUFHLEdBQUcsSUFBSWhCLGFBQWEsQ0FBQyxDQUFDO01BQy9CLElBQUksQ0FBQ1EsUUFBUSxDQUFDRixJQUFJLENBQUNVLEdBQUcsQ0FBQztNQUN2QixPQUFPQSxHQUFHO0lBQ1osQ0FBQztJQUFBLE9BQUFULE1BQUE7RUFBQTtFQUdILFNBQVNVLGVBQWVBLENBQUEsRUFBRztJQUN6QixJQUFJQyxDQUFDLEdBQUcsQ0FBQztJQUNULElBQU1DLFdBQXVFLEdBQUcsRUFBRTtJQUNsRixTQUFTQyxZQUFZQSxDQUFDQyxHQUFXLEVBQUU7TUFDakMsSUFBTUMsRUFBNEIsR0FBRyxDQUFDSixDQUFDLEVBQUVBLENBQUMsRUFBRUEsQ0FBQyxDQUFDO01BQzlDQSxDQUFDLEVBQUU7TUFDSEMsV0FBVyxDQUFDYixJQUFJLENBQUM7UUFDZmlCLEtBQUssRUFBRUYsR0FBRztRQUNWRyxNQUFNLEVBQUVGLEVBQUUsQ0FBQ0csS0FBSyxDQUFDO01BQ25CLENBQUMsQ0FBQztNQUNGLE9BQU9ILEVBQUU7SUFDWDtJQUNBRixZQUFZLENBQUNELFdBQVcsR0FBR0EsV0FBVztJQUN0QyxPQUFPQyxZQUFZO0VBQ3JCO0VBRUFNLEVBQUUsQ0FBQyxnQkFBZ0IsRUFBRSxZQUFNO0lBQ3pCLElBQU1DLE1BQU0sR0FBRyxJQUFJcEIsTUFBTSxDQUFDLENBQUM7SUFDM0JxQixNQUFNLENBQUNELE1BQU0sQ0FBQ25DLEtBQUssS0FBS21DLE1BQU0sQ0FBQ25DLEtBQUssQ0FBQyxDQUFDcUMsSUFBSSxDQUFDLElBQUksQ0FBQztJQUNoRHZELGdCQUFnQixDQUFDcUQsTUFBTSxFQUFrQyxDQUFDL0IsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFcUIsZUFBZSxDQUFDLENBQUMsRUFBRXBDLFFBQVEsQ0FBQztJQUN2RytDLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDbkMsS0FBSyxDQUFDLENBQUNxQyxJQUFJLENBQUMvQyxjQUFjLENBQUMsQ0FBQyxDQUFDO0VBQzdDLENBQUMsQ0FBQztFQUVGYSxRQUFRLENBQUMsd0NBQXdDLEVBQUUsWUFBTTtJQUN2RCtCLEVBQUUsQ0FBQyxpQkFBaUIsRUFBRSxZQUFNO01BQzFCLElBQU1DLE1BQU0sR0FBRyxJQUFJcEIsTUFBTSxDQUFDLENBQUM7TUFDM0JxQixNQUFNLENBQUNELE1BQU0sQ0FBQ3ZDLE1BQU0sS0FBS3VDLE1BQU0sQ0FBQ3ZDLE1BQU0sQ0FBQyxDQUFDeUMsSUFBSSxDQUFDLElBQUksQ0FBQztNQUNsRHZELGdCQUFnQixDQUFDcUQsTUFBTSxFQUFrQyxDQUFDL0IsU0FBUyxDQUFDLEVBQUUsR0FBRyxFQUFFcUIsZUFBZSxDQUFDLENBQUMsRUFBRXBDLFFBQVEsQ0FBQztNQUN2RytDLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDdkMsTUFBTSxDQUFDLENBQUN5QyxJQUFJLENBQUNsRCxnQkFBZ0IsQ0FBQztJQUM5QyxDQUFDLENBQUM7SUFFRitDLEVBQUUsQ0FBQyxzQkFBc0IsRUFBRSxZQUFNO01BQy9CLElBQU1JLGVBQWUsR0FBRyxDQUFDN0MsYUFBYSxDQUFDLENBQUMsQ0FBQztNQUN6QyxJQUFNMEMsTUFBTSxHQUFHLElBQUlwQixNQUFNLENBQUMsQ0FBQztNQUMzQixJQUFNckIsS0FBOEUsR0FBRyxFQUFFO01BQ3pGLElBQU02QyxlQUFlLEdBQUcsSUFBSTtNQUM1QixJQUFNQyxZQUFZLEdBQUdmLGVBQWUsQ0FBQyxDQUFDO01BQ3RDM0MsZ0JBQWdCLENBQUNxRCxNQUFNLEVBQWtDekMsS0FBSyxFQUFFNkMsZUFBZSxFQUFFQyxZQUFZLEVBQUVuRCxRQUFRLENBQUM7TUFDeEcrQyxNQUFNLENBQUVELE1BQU0sQ0FBQ2pCLFVBQVUsQ0FBZXVCLElBQUksQ0FBQ0MsS0FBSyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFDLENBQUMsSUFBSSxFQUFFO1FBQUVDLEtBQUssRUFBRTtNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7TUFDdkZSLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDbkIsUUFBUSxDQUFDbkIsTUFBTSxDQUFDLENBQUN3QyxJQUFJLENBQUMsQ0FBQyxDQUFDO01BQ3RDRCxNQUFNLENBQUNELE1BQU0sQ0FBQ25CLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQ1AsbUJBQW1CLENBQUMsQ0FBQ2tDLE9BQU8sQ0FBQ0wsZUFBZSxDQUFDO0lBQ3pFLENBQUMsQ0FBQztJQUVGSixFQUFFLENBQUMsZUFBZSxFQUFFLFlBQU07TUFDeEIsSUFBTUssZUFBZSxHQUFHLElBQUk7TUFDNUIsSUFBTTdDLEtBQUssR0FBRyxDQUNaO1FBQUVXLFVBQVUsRUFBRSxFQUFFO1FBQUVDLFdBQVcsRUFBRSxFQUFFO1FBQUVDLFdBQVcsRUFBRTtNQUFpQixDQUFDLEVBQ2xFO1FBQUVGLFVBQVUsRUFBRSxHQUFHO1FBQUVDLFdBQVcsRUFBRSxHQUFHO1FBQUVDLFdBQVcsRUFBRTtNQUFpQixDQUFDLEVBQ3BFO1FBQUVGLFVBQVUsRUFBRSxHQUFHO1FBQUVDLFdBQVcsRUFBRSxHQUFHO1FBQUVDLFdBQVcsRUFBRTtNQUFpQixDQUFDLENBQ3JFO01BQ0QsSUFBTXNDLGNBQWMsR0FBRyxDQUNyQjtRQUFFZCxLQUFLLEVBQUVyQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNhLFdBQVc7UUFBRXlCLE1BQU0sRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQztNQUFFLENBQUMsRUFDbEQ7UUFBRUQsS0FBSyxFQUFFckMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDYSxXQUFXO1FBQUV5QixNQUFNLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7TUFBRSxDQUFDLEVBQ2xEO1FBQUVELEtBQUssRUFBRXJDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ2EsV0FBVztRQUFFeUIsTUFBTSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO01BQUUsQ0FBQyxDQUNuRDtNQUNELElBQU1jLE9BQU8sR0FBR3BELEtBQUssQ0FBQ0csTUFBTSxHQUFHVixnQkFBZ0IsR0FBR0EsZ0JBQWdCLEdBQUdXLElBQUksQ0FBQ0MsR0FBRyxDQUFDTCxLQUFLLENBQUNHLE1BQU0sRUFBRVosZ0JBQWdCLENBQUM7TUFFN0csSUFBTThELGdCQUFnQixJQUNwQnRELGFBQWEsQ0FBQyxDQUFDLEVBQUF1RCxNQUFBLENBQ1p0RCxLQUFLLENBQUN1RCxHQUFHLENBQUMsVUFBQ0MsSUFBSSxFQUFFeEIsQ0FBQyxFQUFLO1FBQ3hCLElBQVFyQixVQUFVLEdBQWtCNkMsSUFBSSxDQUFoQzdDLFVBQVU7VUFBRUMsV0FBVyxHQUFLNEMsSUFBSSxDQUFwQjVDLFdBQVc7UUFDL0IsSUFBTTZDLEtBQUssR0FBR04sY0FBYyxDQUFDbkIsQ0FBQyxDQUFDLENBQUNNLE1BQU07UUFDdEMsSUFBTXJDLFNBQVMsYUFBV3dELEtBQUssQ0FBQ0gsTUFBTSxDQUFDakUsVUFBVSxDQUFDLENBQUNxRSxJQUFJLENBQUMsQ0FBQyxNQUFHO1FBQzVELElBQU14RCxNQUFNLEdBQUdFLElBQUksQ0FBQ0MsR0FBRyxDQUFDWCxlQUFlLEVBQUVVLElBQUksQ0FBQ3VELEdBQUcsQ0FBQ3JFLGVBQWUsRUFBRThELE9BQU8sR0FBR3BELEtBQUssQ0FBQ0csTUFBTSxDQUFDLENBQUM7UUFDM0YsSUFBTUcsS0FBSyxHQUFJSyxVQUFVLEdBQUdrQyxlQUFlLEdBQUlqRCxjQUFjLENBQUMsQ0FBQztRQUMvRCxJQUFNVyxDQUFDLEdBQUlLLFdBQVcsR0FBR2lDLGVBQWUsR0FBSWpELGNBQWMsQ0FBQyxDQUFDO1FBQzVELElBQU1ZLENBQUMsR0FBSTRDLE9BQU8sR0FBR3BELEtBQUssQ0FBQ0csTUFBTSxHQUFJNkIsQ0FBQztRQUN0QyxPQUFPO1VBQUUvQixTQUFTLEVBQVRBLFNBQVM7VUFBRUMsTUFBTSxFQUFOQSxNQUFNO1VBQUVJLEtBQUssRUFBTEEsS0FBSztVQUFFQyxDQUFDLEVBQURBLENBQUM7VUFBRUMsQ0FBQyxFQUFEQTtRQUFFLENBQUM7TUFDM0MsQ0FBQyxDQUFDLENBQ0g7TUFDRCxJQUFNaUMsTUFBTSxHQUFHLElBQUlwQixNQUFNLENBQUMsQ0FBQztNQUMzQixJQUFNeUIsWUFBWSxHQUFHZixlQUFlLENBQUMsQ0FBQztNQUN0QzNDLGdCQUFnQixDQUFDcUQsTUFBTSxFQUFrQ3pDLEtBQUssRUFBRTZDLGVBQWUsRUFBRUMsWUFBWSxFQUFFbkQsUUFBUSxDQUFDO01BQ3hHK0MsTUFBTSxDQUFDSSxZQUFZLENBQUNiLFdBQVcsQ0FBQyxDQUFDZ0IsT0FBTyxDQUFDRSxjQUFjLENBQUM7TUFDeERULE1BQU0sQ0FBQ0QsTUFBTSxDQUFDakIsVUFBVSxDQUFDdUIsSUFBSSxDQUFDQyxLQUFLLENBQUMsQ0FBQ0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUU7UUFBRUMsS0FBSyxFQUFFO01BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztNQUN4RVIsTUFBTSxDQUFDRCxNQUFNLENBQUNuQixRQUFRLENBQUNuQixNQUFNLENBQUMsQ0FBQ3dDLElBQUksQ0FBQyxDQUFDLENBQUM7TUFDdENELE1BQU0sQ0FBQ0QsTUFBTSxDQUFDbkIsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDUCxtQkFBbUIsQ0FBQyxDQUFDa0MsT0FBTyxDQUFDSSxnQkFBZ0IsQ0FBQztJQUMxRSxDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRjVDLFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxZQUFNO0lBQzFDK0IsRUFBRSxDQUFDLDJDQUEyQyxFQUFFLFlBQU07TUFDcEQsSUFBTUMsTUFBTSxHQUFHLElBQUlwQixNQUFNLENBQUMsQ0FBQztNQUMzQixJQUFNckIsS0FBSyxHQUFHLEVBQUU7TUFDaEIsS0FBSyxJQUFJZ0MsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHdkMsZ0JBQWdCLEdBQUcsQ0FBQyxFQUFFdUMsQ0FBQyxFQUFFLEVBQUU7UUFDN0NoQyxLQUFLLENBQUNvQixJQUFJLENBQUNWLFNBQVMsQ0FBQztNQUN2QjtNQUNBZ0MsTUFBTSxDQUFDRCxNQUFNLENBQUN2QyxNQUFNLEtBQUt1QyxNQUFNLENBQUN2QyxNQUFNLENBQUMsQ0FBQ3lDLElBQUksQ0FBQyxJQUFJLENBQUM7TUFDbER2RCxnQkFBZ0IsQ0FBQ3FELE1BQU0sRUFBa0N6QyxLQUFLLEVBQUUsR0FBRyxFQUFFK0IsZUFBZSxDQUFDLENBQUMsRUFBRXBDLFFBQVEsQ0FBQztNQUNqRytDLE1BQU0sQ0FBQ0QsTUFBTSxDQUFDdkMsTUFBTSxDQUFDLENBQUN5QyxJQUFJLENBQUMzQyxLQUFLLENBQUNHLE1BQU0sQ0FBQztJQUMxQyxDQUFDLENBQUM7SUFFRnFDLEVBQUUsQ0FBQyxlQUFlLEVBQUUsWUFBTTtNQUN4QixJQUFNSyxlQUFlLEdBQUcsSUFBSTtNQUM1QixJQUFNN0MsS0FBSyxHQUFHYixNQUFNLENBQUNNLGdCQUFnQixHQUFHLEVBQUUsQ0FBQyxDQUFDOEQsR0FBRyxDQUFDLFVBQUN2QixDQUFDO1FBQUEsT0FBTTtVQUN0RHJCLFVBQVUsRUFBRXFCLENBQUM7VUFDYnBCLFdBQVcsRUFBRW9CLENBQUM7VUFDZG5CLFdBQVcsb0JBQWtCbUI7UUFDL0IsQ0FBQztNQUFBLENBQUMsQ0FBQztNQUNILElBQU1tQixjQUFjLEdBQUduRCxLQUFLLENBQUN1RCxHQUFHLENBQUMsVUFBQ0MsSUFBSSxFQUFFeEIsQ0FBQztRQUFBLE9BQU07VUFDN0NLLEtBQUssRUFBRW1CLElBQUksQ0FBQzNDLFdBQVc7VUFDdkJ5QixNQUFNLEVBQUUsQ0FBQ04sQ0FBQyxFQUFFQSxDQUFDLEVBQUVBLENBQUM7UUFDbEIsQ0FBQztNQUFBLENBQUMsQ0FBQztNQUNILElBQU1xQixnQkFBZ0IsSUFDcEJ0RCxhQUFhLENBQUNDLEtBQUssQ0FBQyxFQUFBc0QsTUFBQSxDQUNqQnRELEtBQUssQ0FBQ3VELEdBQUcsQ0FBQyxVQUFDQyxJQUFJLEVBQUV4QixDQUFDLEVBQUs7UUFDeEIsSUFBUXJCLFVBQVUsR0FBa0I2QyxJQUFJLENBQWhDN0MsVUFBVTtVQUFFQyxXQUFXLEdBQUs0QyxJQUFJLENBQXBCNUMsV0FBVztRQUMvQixJQUFNNkMsS0FBSyxHQUFHTixjQUFjLENBQUNuQixDQUFDLENBQUMsQ0FBQ00sTUFBTTtRQUN0QyxJQUFNckMsU0FBUyxhQUFXd0QsS0FBSyxDQUFDSCxNQUFNLENBQUNqRSxVQUFVLENBQUMsQ0FBQ3FFLElBQUksQ0FBQyxDQUFDLE1BQUc7UUFDNUQsSUFBTXhELE1BQU0sR0FBR1osZUFBZTtRQUM5QixJQUFNZ0IsS0FBSyxHQUFHRixJQUFJLENBQUN1RCxHQUFHLENBQUNuRSxjQUFjLEVBQUdtQixVQUFVLEdBQUdrQyxlQUFlLEdBQUlqRCxjQUFjLENBQUMsQ0FBQyxDQUFDO1FBQ3pGLElBQU1XLENBQUMsR0FBSUssV0FBVyxHQUFHaUMsZUFBZSxHQUFJakQsY0FBYyxDQUFDLENBQUM7UUFDNUQsSUFBTVksQ0FBQyxHQUFJakIsZ0JBQWdCLEdBQUdTLEtBQUssQ0FBQ0csTUFBTSxHQUFJNkIsQ0FBQztRQUMvQyxPQUFPO1VBQUUvQixTQUFTLEVBQVRBLFNBQVM7VUFBRUMsTUFBTSxFQUFOQSxNQUFNO1VBQUVJLEtBQUssRUFBTEEsS0FBSztVQUFFQyxDQUFDLEVBQURBLENBQUM7VUFBRUMsQ0FBQyxFQUFEQTtRQUFFLENBQUM7TUFDM0MsQ0FBQyxDQUFDLENBQ0g7TUFDRCxJQUFNaUMsTUFBTSxHQUFHLElBQUlwQixNQUFNLENBQUMsQ0FBQztNQUMzQixJQUFNeUIsWUFBWSxHQUFHZixlQUFlLENBQUMsQ0FBQztNQUN0QzNDLGdCQUFnQixDQUFDcUQsTUFBTSxFQUFrQ3pDLEtBQUssRUFBRTZDLGVBQWUsRUFBRUMsWUFBWSxFQUFFbkQsUUFBUSxDQUFDO01BQ3hHK0MsTUFBTSxDQUFDSSxZQUFZLENBQUNiLFdBQVcsQ0FBQyxDQUFDZ0IsT0FBTyxDQUFDRSxjQUFjLENBQUM7TUFDeERULE1BQU0sQ0FBRUQsTUFBTSxDQUFDakIsVUFBVSxDQUFldUIsSUFBSSxDQUFDQyxLQUFLLENBQUMsQ0FBQ0MsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUU7UUFBRUMsS0FBSyxFQUFFO01BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztNQUN2RlIsTUFBTSxDQUFDRCxNQUFNLENBQUNuQixRQUFRLENBQUNuQixNQUFNLENBQUMsQ0FBQ3dDLElBQUksQ0FBQyxDQUFDLENBQUM7TUFDdENELE1BQU0sQ0FBQ0QsTUFBTSxDQUFDbkIsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDUCxtQkFBbUIsQ0FBQyxDQUFDa0MsT0FBTyxDQUFDSSxnQkFBZ0IsQ0FBQztJQUMxRSxDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=