import _extends from "@babel/runtime/helpers/extends";
// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { values as _values } from 'lodash';
import traceGenerator from '../demo/trace-generators';
import { numberSortComparator } from '../utils/sort';
import { getSpanId, getSpanName, getSpanParentId, getSpanProcess, getSpanProcessId, getSpanServiceName, getSpanTimestamp } from './span';
import * as traceSelectors from './trace';
import { followsFromRef } from './trace.fixture';
var generatedTrace = traceGenerator.trace({
  numberOfSpans: 45
});
it('getTraceId() should return the traceID', function () {
  expect(traceSelectors.getTraceId(generatedTrace)).toBe(generatedTrace.traceID);
});
it('hydrateSpansWithProcesses() should return the trace with processes on each span', function () {
  var hydratedTrace = traceSelectors.hydrateSpansWithProcesses(generatedTrace);
  hydratedTrace.spans.forEach(function (span) {
    return expect(getSpanProcess(span)).toBe(generatedTrace.processes[getSpanProcessId(span)]);
  });
});
it('getTraceSpansAsMap() should return a map of all of the spans', function () {
  var spanMap = traceSelectors.getTraceSpansAsMap(generatedTrace);
  [].concat(spanMap.entries()).forEach(function (pair) {
    expect(pair[1]).toEqual(generatedTrace.spans.find(function (span) {
      return getSpanId(span) === pair[0];
    }));
  });
});
describe('getTraceSpanIdsAsTree()', function () {
  it('builds the tree properly', function () {
    var tree = traceSelectors.getTraceSpanIdsAsTree(generatedTrace);
    var spanMap = traceSelectors.getTraceSpansAsMap(generatedTrace);
    tree.walk(function (value, node) {
      var expectedParentValue = value === traceSelectors.TREE_ROOT_ID ? null : value;
      node.children.forEach(function (childNode) {
        expect(getSpanParentId(spanMap.get(childNode.value))).toBe(expectedParentValue);
      });
    });
  });
  it('#115 - handles FOLLOW_FROM refs', function () {
    expect(function () {
      return traceSelectors.getTraceSpanIdsAsTree(followsFromRef);
    }).not.toThrow();
  });
});
it('getParentSpan() should return the parent span of the tree', function () {
  expect(traceSelectors.getParentSpan(generatedTrace)).toBe(traceSelectors.getTraceSpansAsMap(generatedTrace).get(traceSelectors.getTraceSpanIdsAsTree(generatedTrace).children[0].value));
});
it('getParentSpan() should return the first span if there are multiple parents', function () {
  var initialTimestamp = new Date().getTime() * 1000;
  var firstSpan = {
    startTime: initialTimestamp,
    spanID: 'my-span-1',
    references: []
  };
  var trace = {
    spans: [{
      startTime: initialTimestamp + 2000,
      spanID: 'my-span-3',
      references: []
    }, firstSpan, {
      startTime: initialTimestamp + 1000,
      spanID: 'my-span-2',
      references: []
    }]
  };
  expect(traceSelectors.getParentSpan(trace)).toBe(firstSpan);
});
it('getTraceName() should return a formatted name for the first span', function () {
  var hydratedTrace = traceSelectors.hydrateSpansWithProcesses(generatedTrace);
  var parentSpan = traceSelectors.getParentSpan(hydratedTrace);
  expect(traceSelectors.getTraceName(hydratedTrace)).toBe(getSpanServiceName(parentSpan) + ": " + getSpanName(parentSpan));
});
it('getTraceSpanCount() should return the length of the spans array', function () {
  expect(traceSelectors.getTraceSpanCount(generatedTrace)).toBe(generatedTrace.spans.length);
});
it('getTraceDuration() should return the duration for the span', function () {
  expect(traceSelectors.getTraceDuration(generatedTrace)).toBe(generatedTrace.spans[0].duration);
});
it('getTraceTimestamp() should return the first timestamp for the conventional trace', function () {
  expect(traceSelectors.getTraceTimestamp(generatedTrace)).toBe(generatedTrace.spans[0].startTime);
});
it('getTraceDepth() should determine the total depth of the trace tree', function () {
  expect(traceSelectors.getTraceDepth(generatedTrace)).toBe(traceSelectors.getTraceSpanIdsAsTree(generatedTrace).depth - 1);
});
it('getSpanDepthForTrace() should determine the depth of a given span in the parent', function () {
  function testDepthCalc(span) {
    var depth = 2;
    var currentId = getSpanParentId(span);
    var findCurrentSpanById = function findCurrentSpanById(item) {
      return getSpanId(item) === currentId;
    };
    while (currentId !== getSpanId(generatedTrace.spans[0])) {
      depth++;
      currentId = getSpanParentId(generatedTrace.spans.find(findCurrentSpanById));
    }

    // console.log('hypothetical depth', depth);

    expect(traceSelectors.getSpanDepthForTrace({
      trace: generatedTrace,
      span: span
    })).toBe(depth);
  }

  // test depth calculations for a few random spans
  testDepthCalc(generatedTrace.spans[1]);
  testDepthCalc(generatedTrace.spans[Math.floor(generatedTrace.spans.length / 2)]);
  testDepthCalc(generatedTrace.spans[Math.floor(generatedTrace.spans.length / 4)]);
  testDepthCalc(generatedTrace.spans[Math.floor(generatedTrace.spans.length * 0.75)]);
});
it('getTraceServices() should return an unique array of all services in the trace', function () {
  var svcs = [].concat(traceSelectors.getTraceServices(generatedTrace)).sort();
  var set = new Set(_values(generatedTrace.processes).map(function (v) {
    return v.serviceName;
  }));
  var setSvcs = [].concat(set.values()).sort();
  expect(svcs).toEqual(setSvcs);
});
it('getTraceServiceCount() should return the length of the service list', function () {
  expect(traceSelectors.getTraceServiceCount(generatedTrace)).toBe(Object.values(generatedTrace.processes).reduce(function (results, process) {
    return results.add(process.serviceName);
  }, new Set()).size);
});
it('formatDurationForUnit() should use the formatters to return the proper value', function () {
  expect(traceSelectors.formatDurationForUnit({
    duration: 302000,
    unit: 'ms'
  })).toBe('302ms');
  expect(traceSelectors.formatDurationForUnit({
    duration: 1302000,
    unit: 'ms'
  })).toBe('1302ms');
  expect(traceSelectors.formatDurationForUnit({
    duration: 1302000,
    unit: 's'
  })).toBe('1.302s');
  expect(traceSelectors.formatDurationForUnit({
    duration: 90000,
    unit: 's'
  })).toBe('0.09s');
});
it('formatDurationForTrace() should return a ms value for traces shorter than a second', function () {
  var firstSpan = generatedTrace.spans[0];
  firstSpan.duration = 600000;
  expect(traceSelectors.formatDurationForTrace({
    trace: _extends({}, generatedTrace, {
      spans: [firstSpan]
    }),
    duration: 302000
  })).toBe('302ms');
});
it('formatDurationForTrace() should return a s value for traces longer than a second', function () {
  expect(traceSelectors.formatDurationForTrace({
    trace: _extends({}, generatedTrace, {
      spans: generatedTrace.spans.concat([_extends({}, generatedTrace.spans[0], {
        duration: 1000000
      })])
    }),
    duration: 302000
  })).toBe('0.302s');
  expect(traceSelectors.formatDurationForTrace({
    trace: _extends({}, generatedTrace, {
      spans: generatedTrace.spans.concat([_extends({}, generatedTrace.spans[0], {
        duration: 1200000
      })])
    }),
    duration: 302000
  })).toBe('0.302s');
});
it('getSortedSpans() should sort spans given a sort object', function () {
  expect(traceSelectors.getSortedSpans({
    trace: generatedTrace,
    spans: generatedTrace.spans,
    sort: {
      dir: 1,
      comparator: numberSortComparator,
      selector: getSpanTimestamp
    }
  })).toEqual([].concat(generatedTrace.spans).sort(function (spanA, spanB) {
    return spanA.startTime - spanB.startTime;
  }));
  expect(traceSelectors.getSortedSpans({
    trace: generatedTrace,
    spans: generatedTrace.spans,
    sort: {
      dir: -1,
      comparator: numberSortComparator,
      selector: getSpanTimestamp
    }
  })).toEqual([].concat(generatedTrace.spans).sort(function (spanA, spanB) {
    return spanB.startTime - spanA.startTime;
  }));
});
it('getTreeSizeForTraceSpan() should return the size for the parent span', function () {
  expect(traceSelectors.getTreeSizeForTraceSpan({
    trace: generatedTrace,
    span: generatedTrace.spans[0]
  })).toBe(generatedTrace.spans.length - 1);
});
it('getTreeSizeForTraceSpan() should return the size for a child span', function () {
  expect(traceSelectors.getTreeSizeForTraceSpan({
    trace: generatedTrace,
    span: generatedTrace.spans[1]
  })).toBe(traceSelectors.getTraceSpanIdsAsTree(generatedTrace).find(generatedTrace.spans[1].spanID).size - 1);
});
it('getTreeSizeForTraceSpan() should return -1 for an absent span', function () {
  var absentSpan = generatedTrace.spans[0];
  absentSpan.spanID = 'whatever';
  expect(traceSelectors.getTreeSizeForTraceSpan({
    trace: generatedTrace,
    span: absentSpan
  })).toBe(-1);
});
it('getTraceName() should return the trace name based on the parentSpan', function () {
  var serviceName = generatedTrace.processes[generatedTrace.spans[0].processID].serviceName;
  var operationName = generatedTrace.spans[0].operationName;
  expect(traceSelectors.getTraceName(generatedTrace)).toBe(serviceName + ": " + operationName);
});
it('omitCollapsedSpans() should filter out collapsed spans', function () {
  var span = generatedTrace.spans[1];
  var size = traceSelectors.getTraceSpanIdsAsTree(generatedTrace).find(span.spanID).size - 1;
  expect(traceSelectors.omitCollapsedSpans({
    trace: generatedTrace,
    spans: generatedTrace.spans,
    collapsed: [span.spanID]
  }).length).toBe(generatedTrace.spans.length - size);
});
it('getTicksForTrace() should return a list of ticks given interval parameters', function () {
  var trace = generatedTrace;
  var timestamp = new Date().getTime() * 1000;
  trace.spans.forEach(function (span) {
    span.duration = 3000000;
    span.startTime = timestamp;
  });
  expect(traceSelectors.getTicksForTrace({
    trace: trace,
    interval: 3,
    width: 10
  })).toEqual([{
    timestamp: timestamp,
    width: 10
  }, {
    timestamp: timestamp + 1000000,
    width: 10
  }, {
    timestamp: timestamp + 2000000,
    width: 10
  }, {
    timestamp: timestamp + 3000000,
    width: 10
  }]);
});
it('getTicksForTrace() should use defaults', function () {
  var timestamp = new Date().getTime() * 1000;
  var trace = traceGenerator.trace({
    numberOfSpans: 1
  });
  trace.spans = [{
    traceID: '5031233a-d0b5-5d41-9b4b-4c072bcf5020',
    processID: 'b5f4e0ff-7318-5017-a3f3-9c7b423a82aa',
    spanID: 'e871771f-f1b4-54af-9e9d-826259c2915e',
    flags: 0,
    logs: [],
    operationName: 'POST',
    startTime: timestamp,
    duration: 4000000
  }];
  expect(traceSelectors.getTicksForTrace({
    trace: trace
  })).toEqual([{
    timestamp: timestamp,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 1000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 2000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 3000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 4000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }]);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2YWx1ZXMiLCJfdmFsdWVzIiwidHJhY2VHZW5lcmF0b3IiLCJudW1iZXJTb3J0Q29tcGFyYXRvciIsImdldFNwYW5JZCIsImdldFNwYW5OYW1lIiwiZ2V0U3BhblBhcmVudElkIiwiZ2V0U3BhblByb2Nlc3MiLCJnZXRTcGFuUHJvY2Vzc0lkIiwiZ2V0U3BhblNlcnZpY2VOYW1lIiwiZ2V0U3BhblRpbWVzdGFtcCIsInRyYWNlU2VsZWN0b3JzIiwiZm9sbG93c0Zyb21SZWYiLCJnZW5lcmF0ZWRUcmFjZSIsInRyYWNlIiwibnVtYmVyT2ZTcGFucyIsIml0IiwiZXhwZWN0IiwiZ2V0VHJhY2VJZCIsInRvQmUiLCJ0cmFjZUlEIiwiaHlkcmF0ZWRUcmFjZSIsImh5ZHJhdGVTcGFuc1dpdGhQcm9jZXNzZXMiLCJzcGFucyIsImZvckVhY2giLCJzcGFuIiwicHJvY2Vzc2VzIiwic3Bhbk1hcCIsImdldFRyYWNlU3BhbnNBc01hcCIsImNvbmNhdCIsImVudHJpZXMiLCJwYWlyIiwidG9FcXVhbCIsImZpbmQiLCJkZXNjcmliZSIsInRyZWUiLCJnZXRUcmFjZVNwYW5JZHNBc1RyZWUiLCJ3YWxrIiwidmFsdWUiLCJub2RlIiwiZXhwZWN0ZWRQYXJlbnRWYWx1ZSIsIlRSRUVfUk9PVF9JRCIsImNoaWxkcmVuIiwiY2hpbGROb2RlIiwiZ2V0Iiwibm90IiwidG9UaHJvdyIsImdldFBhcmVudFNwYW4iLCJpbml0aWFsVGltZXN0YW1wIiwiRGF0ZSIsImdldFRpbWUiLCJmaXJzdFNwYW4iLCJzdGFydFRpbWUiLCJzcGFuSUQiLCJyZWZlcmVuY2VzIiwicGFyZW50U3BhbiIsImdldFRyYWNlTmFtZSIsImdldFRyYWNlU3BhbkNvdW50IiwibGVuZ3RoIiwiZ2V0VHJhY2VEdXJhdGlvbiIsImR1cmF0aW9uIiwiZ2V0VHJhY2VUaW1lc3RhbXAiLCJnZXRUcmFjZURlcHRoIiwiZGVwdGgiLCJ0ZXN0RGVwdGhDYWxjIiwiY3VycmVudElkIiwiZmluZEN1cnJlbnRTcGFuQnlJZCIsIml0ZW0iLCJnZXRTcGFuRGVwdGhGb3JUcmFjZSIsIk1hdGgiLCJmbG9vciIsInN2Y3MiLCJnZXRUcmFjZVNlcnZpY2VzIiwic29ydCIsInNldCIsIlNldCIsIm1hcCIsInYiLCJzZXJ2aWNlTmFtZSIsInNldFN2Y3MiLCJnZXRUcmFjZVNlcnZpY2VDb3VudCIsIk9iamVjdCIsInJlZHVjZSIsInJlc3VsdHMiLCJwcm9jZXNzIiwiYWRkIiwic2l6ZSIsImZvcm1hdER1cmF0aW9uRm9yVW5pdCIsInVuaXQiLCJmb3JtYXREdXJhdGlvbkZvclRyYWNlIiwiX2V4dGVuZHMiLCJnZXRTb3J0ZWRTcGFucyIsImRpciIsImNvbXBhcmF0b3IiLCJzZWxlY3RvciIsInNwYW5BIiwic3BhbkIiLCJnZXRUcmVlU2l6ZUZvclRyYWNlU3BhbiIsImFic2VudFNwYW4iLCJwcm9jZXNzSUQiLCJvcGVyYXRpb25OYW1lIiwib21pdENvbGxhcHNlZFNwYW5zIiwiY29sbGFwc2VkIiwidGltZXN0YW1wIiwiZ2V0VGlja3NGb3JUcmFjZSIsImludGVydmFsIiwid2lkdGgiLCJmbGFncyIsImxvZ3MiLCJERUZBVUxUX1RJQ0tfV0lEVEgiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGliL3NlbGVjdG9ycy90cmFjZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgMjAxNyBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuLy9cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG5pbXBvcnQgeyB2YWx1ZXMgYXMgX3ZhbHVlcyB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgVHJlZU5vZGUgZnJvbSAnc3JjL3V0aWxzL1RyZWVOb2RlJztcblxuaW1wb3J0IHRyYWNlR2VuZXJhdG9yIGZyb20gJy4uL2RlbW8vdHJhY2UtZ2VuZXJhdG9ycyc7XG5pbXBvcnQgeyBUcmFjZVJlc3BvbnNlLCBUcmFjZVNwYW4sIFRyYWNlU3BhbkRhdGEgfSBmcm9tICcuLi90eXBlcy90cmFjZSc7XG5pbXBvcnQgeyBudW1iZXJTb3J0Q29tcGFyYXRvciB9IGZyb20gJy4uL3V0aWxzL3NvcnQnO1xuXG5pbXBvcnQge1xuICBnZXRTcGFuSWQsXG4gIGdldFNwYW5OYW1lLFxuICBnZXRTcGFuUGFyZW50SWQsXG4gIGdldFNwYW5Qcm9jZXNzLFxuICBnZXRTcGFuUHJvY2Vzc0lkLFxuICBnZXRTcGFuU2VydmljZU5hbWUsXG4gIGdldFNwYW5UaW1lc3RhbXAsXG59IGZyb20gJy4vc3Bhbic7XG5pbXBvcnQgKiBhcyB0cmFjZVNlbGVjdG9ycyBmcm9tICcuL3RyYWNlJztcbmltcG9ydCB7IGZvbGxvd3NGcm9tUmVmIH0gZnJvbSAnLi90cmFjZS5maXh0dXJlJztcblxuY29uc3QgZ2VuZXJhdGVkVHJhY2U6IFRyYWNlUmVzcG9uc2UgPSB0cmFjZUdlbmVyYXRvci50cmFjZSh7IG51bWJlck9mU3BhbnM6IDQ1IH0pO1xuXG5pdCgnZ2V0VHJhY2VJZCgpIHNob3VsZCByZXR1cm4gdGhlIHRyYWNlSUQnLCAoKSA9PiB7XG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZUlkKGdlbmVyYXRlZFRyYWNlKSkudG9CZShnZW5lcmF0ZWRUcmFjZS50cmFjZUlEKTtcbn0pO1xuXG5pdCgnaHlkcmF0ZVNwYW5zV2l0aFByb2Nlc3NlcygpIHNob3VsZCByZXR1cm4gdGhlIHRyYWNlIHdpdGggcHJvY2Vzc2VzIG9uIGVhY2ggc3BhbicsICgpID0+IHtcbiAgY29uc3QgaHlkcmF0ZWRUcmFjZSA9IHRyYWNlU2VsZWN0b3JzLmh5ZHJhdGVTcGFuc1dpdGhQcm9jZXNzZXMoZ2VuZXJhdGVkVHJhY2UpO1xuXG4gIGh5ZHJhdGVkVHJhY2Uuc3BhbnMuZm9yRWFjaCgoc3BhbikgPT5cbiAgICBleHBlY3QoZ2V0U3BhblByb2Nlc3Moc3BhbiBhcyBUcmFjZVNwYW4pKS50b0JlKGdlbmVyYXRlZFRyYWNlLnByb2Nlc3Nlc1tnZXRTcGFuUHJvY2Vzc0lkKHNwYW4pXSlcbiAgKTtcbn0pO1xuXG5pdCgnZ2V0VHJhY2VTcGFuc0FzTWFwKCkgc2hvdWxkIHJldHVybiBhIG1hcCBvZiBhbGwgb2YgdGhlIHNwYW5zJywgKCkgPT4ge1xuICBjb25zdCBzcGFuTWFwID0gdHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VTcGFuc0FzTWFwKGdlbmVyYXRlZFRyYWNlKTtcbiAgWy4uLnNwYW5NYXAuZW50cmllcygpXS5mb3JFYWNoKChwYWlyKSA9PiB7XG4gICAgZXhwZWN0KHBhaXJbMV0pLnRvRXF1YWwoZ2VuZXJhdGVkVHJhY2Uuc3BhbnMuZmluZCgoc3BhbikgPT4gZ2V0U3BhbklkKHNwYW4pID09PSBwYWlyWzBdKSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdnZXRUcmFjZVNwYW5JZHNBc1RyZWUoKScsICgpID0+IHtcbiAgaXQoJ2J1aWxkcyB0aGUgdHJlZSBwcm9wZXJseScsICgpID0+IHtcbiAgICBjb25zdCB0cmVlID0gdHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VTcGFuSWRzQXNUcmVlKGdlbmVyYXRlZFRyYWNlKTtcbiAgICBjb25zdCBzcGFuTWFwID0gdHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VTcGFuc0FzTWFwKGdlbmVyYXRlZFRyYWNlKTtcblxuICAgIHRyZWUud2FsaygodmFsdWU6IHN0cmluZyB8IG51bWJlciB8IHVuZGVmaW5lZCwgbm9kZTogVHJlZU5vZGUpID0+IHtcbiAgICAgIGNvbnN0IGV4cGVjdGVkUGFyZW50VmFsdWUgPSB2YWx1ZSA9PT0gdHJhY2VTZWxlY3RvcnMuVFJFRV9ST09UX0lEID8gbnVsbCA6IHZhbHVlO1xuICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZE5vZGUpID0+IHtcbiAgICAgICAgZXhwZWN0KGdldFNwYW5QYXJlbnRJZChzcGFuTWFwLmdldChjaGlsZE5vZGUudmFsdWUpKSkudG9CZShleHBlY3RlZFBhcmVudFZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBpdCgnIzExNSAtIGhhbmRsZXMgRk9MTE9XX0ZST00gcmVmcycsICgpID0+IHtcbiAgICBleHBlY3QoKCkgPT4gdHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VTcGFuSWRzQXNUcmVlKGZvbGxvd3NGcm9tUmVmKSkubm90LnRvVGhyb3coKTtcbiAgfSk7XG59KTtcblxuaXQoJ2dldFBhcmVudFNwYW4oKSBzaG91bGQgcmV0dXJuIHRoZSBwYXJlbnQgc3BhbiBvZiB0aGUgdHJlZScsICgpID0+IHtcbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFBhcmVudFNwYW4oZ2VuZXJhdGVkVHJhY2UpKS50b0JlKFxuICAgIHRyYWNlU2VsZWN0b3JzXG4gICAgICAuZ2V0VHJhY2VTcGFuc0FzTWFwKGdlbmVyYXRlZFRyYWNlKVxuICAgICAgLmdldCh0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5JZHNBc1RyZWUoZ2VuZXJhdGVkVHJhY2UpLmNoaWxkcmVuWzBdLnZhbHVlKVxuICApO1xufSk7XG5cbml0KCdnZXRQYXJlbnRTcGFuKCkgc2hvdWxkIHJldHVybiB0aGUgZmlyc3Qgc3BhbiBpZiB0aGVyZSBhcmUgbXVsdGlwbGUgcGFyZW50cycsICgpID0+IHtcbiAgY29uc3QgaW5pdGlhbFRpbWVzdGFtcCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpICogMTAwMDtcbiAgY29uc3QgZmlyc3RTcGFuID0ge1xuICAgIHN0YXJ0VGltZTogaW5pdGlhbFRpbWVzdGFtcCxcbiAgICBzcGFuSUQ6ICdteS1zcGFuLTEnLFxuICAgIHJlZmVyZW5jZXM6IFtdLFxuICB9O1xuXG4gIGNvbnN0IHRyYWNlID0ge1xuICAgIHNwYW5zOiBbXG4gICAgICB7XG4gICAgICAgIHN0YXJ0VGltZTogaW5pdGlhbFRpbWVzdGFtcCArIDIwMDAsXG4gICAgICAgIHNwYW5JRDogJ215LXNwYW4tMycsXG4gICAgICAgIHJlZmVyZW5jZXM6IFtdLFxuICAgICAgfSxcbiAgICAgIGZpcnN0U3BhbixcbiAgICAgIHtcbiAgICAgICAgc3RhcnRUaW1lOiBpbml0aWFsVGltZXN0YW1wICsgMTAwMCxcbiAgICAgICAgc3BhbklEOiAnbXktc3Bhbi0yJyxcbiAgICAgICAgcmVmZXJlbmNlczogW10sXG4gICAgICB9LFxuICAgIF0sXG4gIH0gYXMgdW5rbm93biBhcyBUcmFjZVJlc3BvbnNlO1xuXG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5nZXRQYXJlbnRTcGFuKHRyYWNlKSkudG9CZShmaXJzdFNwYW4pO1xufSk7XG5cbml0KCdnZXRUcmFjZU5hbWUoKSBzaG91bGQgcmV0dXJuIGEgZm9ybWF0dGVkIG5hbWUgZm9yIHRoZSBmaXJzdCBzcGFuJywgKCkgPT4ge1xuICBjb25zdCBoeWRyYXRlZFRyYWNlID0gdHJhY2VTZWxlY3RvcnMuaHlkcmF0ZVNwYW5zV2l0aFByb2Nlc3NlcyhnZW5lcmF0ZWRUcmFjZSk7XG4gIGNvbnN0IHBhcmVudFNwYW4gPSB0cmFjZVNlbGVjdG9ycy5nZXRQYXJlbnRTcGFuKGh5ZHJhdGVkVHJhY2UpO1xuXG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZU5hbWUoaHlkcmF0ZWRUcmFjZSkpLnRvQmUoXG4gICAgYCR7Z2V0U3BhblNlcnZpY2VOYW1lKHBhcmVudFNwYW4pfTogJHtnZXRTcGFuTmFtZShwYXJlbnRTcGFuKX1gXG4gICk7XG59KTtcblxuaXQoJ2dldFRyYWNlU3BhbkNvdW50KCkgc2hvdWxkIHJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBzcGFucyBhcnJheScsICgpID0+IHtcbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlU3BhbkNvdW50KGdlbmVyYXRlZFRyYWNlKSkudG9CZShnZW5lcmF0ZWRUcmFjZS5zcGFucy5sZW5ndGgpO1xufSk7XG5cbml0KCdnZXRUcmFjZUR1cmF0aW9uKCkgc2hvdWxkIHJldHVybiB0aGUgZHVyYXRpb24gZm9yIHRoZSBzcGFuJywgKCkgPT4ge1xuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VEdXJhdGlvbihnZW5lcmF0ZWRUcmFjZSkpLnRvQmUoZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMF0uZHVyYXRpb24pO1xufSk7XG5cbml0KCdnZXRUcmFjZVRpbWVzdGFtcCgpIHNob3VsZCByZXR1cm4gdGhlIGZpcnN0IHRpbWVzdGFtcCBmb3IgdGhlIGNvbnZlbnRpb25hbCB0cmFjZScsICgpID0+IHtcbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlVGltZXN0YW1wKGdlbmVyYXRlZFRyYWNlKSkudG9CZShnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXS5zdGFydFRpbWUpO1xufSk7XG5cbml0KCdnZXRUcmFjZURlcHRoKCkgc2hvdWxkIGRldGVybWluZSB0aGUgdG90YWwgZGVwdGggb2YgdGhlIHRyYWNlIHRyZWUnLCAoKSA9PiB7XG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZURlcHRoKGdlbmVyYXRlZFRyYWNlKSkudG9CZShcbiAgICB0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5JZHNBc1RyZWUoZ2VuZXJhdGVkVHJhY2UpLmRlcHRoIC0gMVxuICApO1xufSk7XG5cbml0KCdnZXRTcGFuRGVwdGhGb3JUcmFjZSgpIHNob3VsZCBkZXRlcm1pbmUgdGhlIGRlcHRoIG9mIGEgZ2l2ZW4gc3BhbiBpbiB0aGUgcGFyZW50JywgKCkgPT4ge1xuICBmdW5jdGlvbiB0ZXN0RGVwdGhDYWxjKHNwYW46IFRyYWNlU3BhbkRhdGEpIHtcbiAgICBsZXQgZGVwdGggPSAyO1xuICAgIGxldCBjdXJyZW50SWQgPSBnZXRTcGFuUGFyZW50SWQoc3Bhbik7XG5cbiAgICBjb25zdCBmaW5kQ3VycmVudFNwYW5CeUlkID0gKGl0ZW06IFRyYWNlU3BhbkRhdGEpID0+IGdldFNwYW5JZChpdGVtKSA9PT0gY3VycmVudElkO1xuICAgIHdoaWxlIChjdXJyZW50SWQgIT09IGdldFNwYW5JZChnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXSkpIHtcbiAgICAgIGRlcHRoKys7XG4gICAgICBjdXJyZW50SWQgPSBnZXRTcGFuUGFyZW50SWQoZ2VuZXJhdGVkVHJhY2Uuc3BhbnMuZmluZChmaW5kQ3VycmVudFNwYW5CeUlkKSEpO1xuICAgIH1cblxuICAgIC8vIGNvbnNvbGUubG9nKCdoeXBvdGhldGljYWwgZGVwdGgnLCBkZXB0aCk7XG5cbiAgICBleHBlY3QoXG4gICAgICB0cmFjZVNlbGVjdG9ycy5nZXRTcGFuRGVwdGhGb3JUcmFjZSh7XG4gICAgICAgIHRyYWNlOiBnZW5lcmF0ZWRUcmFjZSxcbiAgICAgICAgc3BhbixcbiAgICAgIH0pXG4gICAgKS50b0JlKGRlcHRoKTtcbiAgfVxuXG4gIC8vIHRlc3QgZGVwdGggY2FsY3VsYXRpb25zIGZvciBhIGZldyByYW5kb20gc3BhbnNcbiAgdGVzdERlcHRoQ2FsYyhnZW5lcmF0ZWRUcmFjZS5zcGFuc1sxXSk7XG4gIHRlc3REZXB0aENhbGMoZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbTWF0aC5mbG9vcihnZW5lcmF0ZWRUcmFjZS5zcGFucy5sZW5ndGggLyAyKV0pO1xuICB0ZXN0RGVwdGhDYWxjKGdlbmVyYXRlZFRyYWNlLnNwYW5zW01hdGguZmxvb3IoZ2VuZXJhdGVkVHJhY2Uuc3BhbnMubGVuZ3RoIC8gNCldKTtcbiAgdGVzdERlcHRoQ2FsYyhnZW5lcmF0ZWRUcmFjZS5zcGFuc1tNYXRoLmZsb29yKGdlbmVyYXRlZFRyYWNlLnNwYW5zLmxlbmd0aCAqIDAuNzUpXSk7XG59KTtcblxuaXQoJ2dldFRyYWNlU2VydmljZXMoKSBzaG91bGQgcmV0dXJuIGFuIHVuaXF1ZSBhcnJheSBvZiBhbGwgc2VydmljZXMgaW4gdGhlIHRyYWNlJywgKCkgPT4ge1xuICBjb25zdCBzdmNzID0gWy4uLnRyYWNlU2VsZWN0b3JzLmdldFRyYWNlU2VydmljZXMoZ2VuZXJhdGVkVHJhY2UpXS5zb3J0KCk7XG4gIGNvbnN0IHNldCA9IG5ldyBTZXQoX3ZhbHVlcyhnZW5lcmF0ZWRUcmFjZS5wcm9jZXNzZXMpLm1hcCgodikgPT4gdi5zZXJ2aWNlTmFtZSkpO1xuICBjb25zdCBzZXRTdmNzID0gWy4uLnNldC52YWx1ZXMoKV0uc29ydCgpO1xuICBleHBlY3Qoc3ZjcykudG9FcXVhbChzZXRTdmNzKTtcbn0pO1xuXG5pdCgnZ2V0VHJhY2VTZXJ2aWNlQ291bnQoKSBzaG91bGQgcmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIHNlcnZpY2UgbGlzdCcsICgpID0+IHtcbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlU2VydmljZUNvdW50KGdlbmVyYXRlZFRyYWNlKSkudG9CZShcbiAgICBPYmplY3QudmFsdWVzKGdlbmVyYXRlZFRyYWNlLnByb2Nlc3NlcykucmVkdWNlKChyZXN1bHRzLCBwcm9jZXNzKSA9PiByZXN1bHRzLmFkZChwcm9jZXNzLnNlcnZpY2VOYW1lKSwgbmV3IFNldCgpKVxuICAgICAgLnNpemVcbiAgKTtcbn0pO1xuXG5pdCgnZm9ybWF0RHVyYXRpb25Gb3JVbml0KCkgc2hvdWxkIHVzZSB0aGUgZm9ybWF0dGVycyB0byByZXR1cm4gdGhlIHByb3BlciB2YWx1ZScsICgpID0+IHtcbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmZvcm1hdER1cmF0aW9uRm9yVW5pdCh7IGR1cmF0aW9uOiAzMDIwMDAsIHVuaXQ6ICdtcycgfSkpLnRvQmUoJzMwMm1zJyk7XG5cbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmZvcm1hdER1cmF0aW9uRm9yVW5pdCh7IGR1cmF0aW9uOiAxMzAyMDAwLCB1bml0OiAnbXMnIH0pKS50b0JlKCcxMzAybXMnKTtcblxuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZm9ybWF0RHVyYXRpb25Gb3JVbml0KHsgZHVyYXRpb246IDEzMDIwMDAsIHVuaXQ6ICdzJyB9KSkudG9CZSgnMS4zMDJzJyk7XG5cbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmZvcm1hdER1cmF0aW9uRm9yVW5pdCh7IGR1cmF0aW9uOiA5MDAwMCwgdW5pdDogJ3MnIH0pKS50b0JlKCcwLjA5cycpO1xufSk7XG5cbml0KCdmb3JtYXREdXJhdGlvbkZvclRyYWNlKCkgc2hvdWxkIHJldHVybiBhIG1zIHZhbHVlIGZvciB0cmFjZXMgc2hvcnRlciB0aGFuIGEgc2Vjb25kJywgKCkgPT4ge1xuICBjb25zdCBmaXJzdFNwYW4gPSBnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXTtcbiAgZmlyc3RTcGFuLmR1cmF0aW9uID0gNjAwMDAwO1xuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZm9ybWF0RHVyYXRpb25Gb3JUcmFjZSh7XG4gICAgICB0cmFjZToge1xuICAgICAgICAuLi5nZW5lcmF0ZWRUcmFjZSxcbiAgICAgICAgc3BhbnM6IFtmaXJzdFNwYW5dLFxuICAgICAgfSxcbiAgICAgIGR1cmF0aW9uOiAzMDIwMDAsXG4gICAgfSlcbiAgKS50b0JlKCczMDJtcycpO1xufSk7XG5cbml0KCdmb3JtYXREdXJhdGlvbkZvclRyYWNlKCkgc2hvdWxkIHJldHVybiBhIHMgdmFsdWUgZm9yIHRyYWNlcyBsb25nZXIgdGhhbiBhIHNlY29uZCcsICgpID0+IHtcbiAgZXhwZWN0KFxuICAgIHRyYWNlU2VsZWN0b3JzLmZvcm1hdER1cmF0aW9uRm9yVHJhY2Uoe1xuICAgICAgdHJhY2U6IHtcbiAgICAgICAgLi4uZ2VuZXJhdGVkVHJhY2UsXG4gICAgICAgIHNwYW5zOiBnZW5lcmF0ZWRUcmFjZS5zcGFucy5jb25jYXQoW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIC4uLmdlbmVyYXRlZFRyYWNlLnNwYW5zWzBdLFxuICAgICAgICAgICAgZHVyYXRpb246IDEwMDAwMDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSksXG4gICAgICB9LFxuICAgICAgZHVyYXRpb246IDMwMjAwMCxcbiAgICB9KVxuICApLnRvQmUoJzAuMzAycycpO1xuXG4gIGV4cGVjdChcbiAgICB0cmFjZVNlbGVjdG9ycy5mb3JtYXREdXJhdGlvbkZvclRyYWNlKHtcbiAgICAgIHRyYWNlOiB7XG4gICAgICAgIC4uLmdlbmVyYXRlZFRyYWNlLFxuICAgICAgICBzcGFuczogZ2VuZXJhdGVkVHJhY2Uuc3BhbnMuY29uY2F0KFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5nZW5lcmF0ZWRUcmFjZS5zcGFuc1swXSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiAxMjAwMDAwLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0pLFxuICAgICAgfSxcbiAgICAgIGR1cmF0aW9uOiAzMDIwMDAsXG4gICAgfSlcbiAgKS50b0JlKCcwLjMwMnMnKTtcbn0pO1xuXG5pdCgnZ2V0U29ydGVkU3BhbnMoKSBzaG91bGQgc29ydCBzcGFucyBnaXZlbiBhIHNvcnQgb2JqZWN0JywgKCkgPT4ge1xuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZ2V0U29ydGVkU3BhbnMoe1xuICAgICAgdHJhY2U6IGdlbmVyYXRlZFRyYWNlLFxuICAgICAgc3BhbnM6IGdlbmVyYXRlZFRyYWNlLnNwYW5zLFxuICAgICAgc29ydDoge1xuICAgICAgICBkaXI6IDEsXG4gICAgICAgIGNvbXBhcmF0b3I6IG51bWJlclNvcnRDb21wYXJhdG9yLFxuICAgICAgICBzZWxlY3RvcjogZ2V0U3BhblRpbWVzdGFtcCxcbiAgICAgIH0sXG4gICAgfSlcbiAgKS50b0VxdWFsKFsuLi5nZW5lcmF0ZWRUcmFjZS5zcGFuc10uc29ydCgoc3BhbkEsIHNwYW5CKSA9PiBzcGFuQS5zdGFydFRpbWUgLSBzcGFuQi5zdGFydFRpbWUpKTtcblxuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZ2V0U29ydGVkU3BhbnMoe1xuICAgICAgdHJhY2U6IGdlbmVyYXRlZFRyYWNlLFxuICAgICAgc3BhbnM6IGdlbmVyYXRlZFRyYWNlLnNwYW5zLFxuICAgICAgc29ydDoge1xuICAgICAgICBkaXI6IC0xLFxuICAgICAgICBjb21wYXJhdG9yOiBudW1iZXJTb3J0Q29tcGFyYXRvcixcbiAgICAgICAgc2VsZWN0b3I6IGdldFNwYW5UaW1lc3RhbXAsXG4gICAgICB9LFxuICAgIH0pXG4gICkudG9FcXVhbChbLi4uZ2VuZXJhdGVkVHJhY2Uuc3BhbnNdLnNvcnQoKHNwYW5BLCBzcGFuQikgPT4gc3BhbkIuc3RhcnRUaW1lIC0gc3BhbkEuc3RhcnRUaW1lKSk7XG59KTtcblxuaXQoJ2dldFRyZWVTaXplRm9yVHJhY2VTcGFuKCkgc2hvdWxkIHJldHVybiB0aGUgc2l6ZSBmb3IgdGhlIHBhcmVudCBzcGFuJywgKCkgPT4ge1xuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZ2V0VHJlZVNpemVGb3JUcmFjZVNwYW4oe1xuICAgICAgdHJhY2U6IGdlbmVyYXRlZFRyYWNlLFxuICAgICAgc3BhbjogZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMF0sXG4gICAgfSlcbiAgKS50b0JlKGdlbmVyYXRlZFRyYWNlLnNwYW5zLmxlbmd0aCAtIDEpO1xufSk7XG5cbml0KCdnZXRUcmVlU2l6ZUZvclRyYWNlU3BhbigpIHNob3VsZCByZXR1cm4gdGhlIHNpemUgZm9yIGEgY2hpbGQgc3BhbicsICgpID0+IHtcbiAgZXhwZWN0KFxuICAgIHRyYWNlU2VsZWN0b3JzLmdldFRyZWVTaXplRm9yVHJhY2VTcGFuKHtcbiAgICAgIHRyYWNlOiBnZW5lcmF0ZWRUcmFjZSxcbiAgICAgIHNwYW46IGdlbmVyYXRlZFRyYWNlLnNwYW5zWzFdLFxuICAgIH0pXG4gICkudG9CZSh0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5JZHNBc1RyZWUoZ2VuZXJhdGVkVHJhY2UpLmZpbmQoZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMV0uc3BhbklEKSEuc2l6ZSAtIDEpO1xufSk7XG5cbml0KCdnZXRUcmVlU2l6ZUZvclRyYWNlU3BhbigpIHNob3VsZCByZXR1cm4gLTEgZm9yIGFuIGFic2VudCBzcGFuJywgKCkgPT4ge1xuICBjb25zdCBhYnNlbnRTcGFuID0gZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMF07XG4gIGFic2VudFNwYW4uc3BhbklEID0gJ3doYXRldmVyJztcblxuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZ2V0VHJlZVNpemVGb3JUcmFjZVNwYW4oe1xuICAgICAgdHJhY2U6IGdlbmVyYXRlZFRyYWNlLFxuICAgICAgc3BhbjogYWJzZW50U3BhbixcbiAgICB9KVxuICApLnRvQmUoLTEpO1xufSk7XG5cbml0KCdnZXRUcmFjZU5hbWUoKSBzaG91bGQgcmV0dXJuIHRoZSB0cmFjZSBuYW1lIGJhc2VkIG9uIHRoZSBwYXJlbnRTcGFuJywgKCkgPT4ge1xuICBjb25zdCBzZXJ2aWNlTmFtZSA9IGdlbmVyYXRlZFRyYWNlLnByb2Nlc3Nlc1tnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXS5wcm9jZXNzSURdLnNlcnZpY2VOYW1lO1xuICBjb25zdCBvcGVyYXRpb25OYW1lID0gZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMF0ub3BlcmF0aW9uTmFtZTtcblxuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VOYW1lKGdlbmVyYXRlZFRyYWNlKSkudG9CZShgJHtzZXJ2aWNlTmFtZX06ICR7b3BlcmF0aW9uTmFtZX1gKTtcbn0pO1xuXG5pdCgnb21pdENvbGxhcHNlZFNwYW5zKCkgc2hvdWxkIGZpbHRlciBvdXQgY29sbGFwc2VkIHNwYW5zJywgKCkgPT4ge1xuICBjb25zdCBzcGFuID0gZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMV07XG4gIGNvbnN0IHNpemUgPSB0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5JZHNBc1RyZWUoZ2VuZXJhdGVkVHJhY2UpLmZpbmQoc3Bhbi5zcGFuSUQpIS5zaXplIC0gMTtcblxuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMub21pdENvbGxhcHNlZFNwYW5zKHtcbiAgICAgIHRyYWNlOiBnZW5lcmF0ZWRUcmFjZSxcbiAgICAgIHNwYW5zOiBnZW5lcmF0ZWRUcmFjZS5zcGFucyxcbiAgICAgIGNvbGxhcHNlZDogW3NwYW4uc3BhbklEXSxcbiAgICB9KS5sZW5ndGhcbiAgKS50b0JlKGdlbmVyYXRlZFRyYWNlLnNwYW5zLmxlbmd0aCAtIHNpemUpO1xufSk7XG5cbml0KCdnZXRUaWNrc0ZvclRyYWNlKCkgc2hvdWxkIHJldHVybiBhIGxpc3Qgb2YgdGlja3MgZ2l2ZW4gaW50ZXJ2YWwgcGFyYW1ldGVycycsICgpID0+IHtcbiAgY29uc3QgdHJhY2UgPSBnZW5lcmF0ZWRUcmFjZTtcbiAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgKiAxMDAwO1xuXG4gIHRyYWNlLnNwYW5zLmZvckVhY2goKHNwYW4pID0+IHtcbiAgICBzcGFuLmR1cmF0aW9uID0gMzAwMDAwMDtcbiAgICBzcGFuLnN0YXJ0VGltZSA9IHRpbWVzdGFtcDtcbiAgfSk7XG5cbiAgZXhwZWN0KFxuICAgIHRyYWNlU2VsZWN0b3JzLmdldFRpY2tzRm9yVHJhY2Uoe1xuICAgICAgdHJhY2UsXG4gICAgICBpbnRlcnZhbDogMyxcbiAgICAgIHdpZHRoOiAxMCxcbiAgICB9KVxuICApLnRvRXF1YWwoW1xuICAgIHsgdGltZXN0YW1wLCB3aWR0aDogMTAgfSxcbiAgICB7IHRpbWVzdGFtcDogdGltZXN0YW1wICsgMTAwMDAwMCwgd2lkdGg6IDEwIH0sXG4gICAgeyB0aW1lc3RhbXA6IHRpbWVzdGFtcCArIDIwMDAwMDAsIHdpZHRoOiAxMCB9LFxuICAgIHsgdGltZXN0YW1wOiB0aW1lc3RhbXAgKyAzMDAwMDAwLCB3aWR0aDogMTAgfSxcbiAgXSk7XG59KTtcblxuaXQoJ2dldFRpY2tzRm9yVHJhY2UoKSBzaG91bGQgdXNlIGRlZmF1bHRzJywgKCkgPT4ge1xuICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAqIDEwMDA7XG4gIGNvbnN0IHRyYWNlID0gdHJhY2VHZW5lcmF0b3IudHJhY2UoeyBudW1iZXJPZlNwYW5zOiAxIH0pO1xuXG4gIHRyYWNlLnNwYW5zID0gW1xuICAgIHtcbiAgICAgIHRyYWNlSUQ6ICc1MDMxMjMzYS1kMGI1LTVkNDEtOWI0Yi00YzA3MmJjZjUwMjAnLFxuICAgICAgcHJvY2Vzc0lEOiAnYjVmNGUwZmYtNzMxOC01MDE3LWEzZjMtOWM3YjQyM2E4MmFhJyxcbiAgICAgIHNwYW5JRDogJ2U4NzE3NzFmLWYxYjQtNTRhZi05ZTlkLTgyNjI1OWMyOTE1ZScsXG4gICAgICBmbGFnczogMCxcbiAgICAgIGxvZ3M6IFtdLFxuICAgICAgb3BlcmF0aW9uTmFtZTogJ1BPU1QnLFxuICAgICAgc3RhcnRUaW1lOiB0aW1lc3RhbXAsXG4gICAgICBkdXJhdGlvbjogNDAwMDAwMCxcbiAgICB9LFxuICBdO1xuXG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5nZXRUaWNrc0ZvclRyYWNlKHsgdHJhY2UgfSkpLnRvRXF1YWwoW1xuICAgIHsgdGltZXN0YW1wLCB3aWR0aDogdHJhY2VTZWxlY3RvcnMuREVGQVVMVF9USUNLX1dJRFRIIH0sXG4gICAge1xuICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAgKyAxMDAwMDAwLFxuICAgICAgd2lkdGg6IHRyYWNlU2VsZWN0b3JzLkRFRkFVTFRfVElDS19XSURUSCxcbiAgICB9LFxuICAgIHtcbiAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wICsgMjAwMDAwMCxcbiAgICAgIHdpZHRoOiB0cmFjZVNlbGVjdG9ycy5ERUZBVUxUX1RJQ0tfV0lEVEgsXG4gICAgfSxcbiAgICB7XG4gICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcCArIDMwMDAwMDAsXG4gICAgICB3aWR0aDogdHJhY2VTZWxlY3RvcnMuREVGQVVMVF9USUNLX1dJRFRILFxuICAgIH0sXG4gICAge1xuICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAgKyA0MDAwMDAwLFxuICAgICAgd2lkdGg6IHRyYWNlU2VsZWN0b3JzLkRFRkFVTFRfVElDS19XSURUSCxcbiAgICB9LFxuICBdKTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EsTUFBTSxJQUFJQyxPQUFPLFFBQVEsUUFBUTtBQUcxQyxPQUFPQyxjQUFjLE1BQU0sMEJBQTBCO0FBRXJELFNBQVNDLG9CQUFvQixRQUFRLGVBQWU7QUFFcEQsU0FDRUMsU0FBUyxFQUNUQyxXQUFXLEVBQ1hDLGVBQWUsRUFDZkMsY0FBYyxFQUNkQyxnQkFBZ0IsRUFDaEJDLGtCQUFrQixFQUNsQkMsZ0JBQWdCLFFBQ1gsUUFBUTtBQUNmLE9BQU8sS0FBS0MsY0FBYyxNQUFNLFNBQVM7QUFDekMsU0FBU0MsY0FBYyxRQUFRLGlCQUFpQjtBQUVoRCxJQUFNQyxjQUE2QixHQUFHWCxjQUFjLENBQUNZLEtBQUssQ0FBQztFQUFFQyxhQUFhLEVBQUU7QUFBRyxDQUFDLENBQUM7QUFFakZDLEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxZQUFNO0VBQ2pEQyxNQUFNLENBQUNOLGNBQWMsQ0FBQ08sVUFBVSxDQUFDTCxjQUFjLENBQUMsQ0FBQyxDQUFDTSxJQUFJLENBQUNOLGNBQWMsQ0FBQ08sT0FBTyxDQUFDO0FBQ2hGLENBQUMsQ0FBQztBQUVGSixFQUFFLENBQUMsaUZBQWlGLEVBQUUsWUFBTTtFQUMxRixJQUFNSyxhQUFhLEdBQUdWLGNBQWMsQ0FBQ1cseUJBQXlCLENBQUNULGNBQWMsQ0FBQztFQUU5RVEsYUFBYSxDQUFDRSxLQUFLLENBQUNDLE9BQU8sQ0FBQyxVQUFDQyxJQUFJO0lBQUEsT0FDL0JSLE1BQU0sQ0FBQ1YsY0FBYyxDQUFDa0IsSUFBaUIsQ0FBQyxDQUFDLENBQUNOLElBQUksQ0FBQ04sY0FBYyxDQUFDYSxTQUFTLENBQUNsQixnQkFBZ0IsQ0FBQ2lCLElBQUksQ0FBQyxDQUFDLENBQUM7RUFBQSxDQUNsRyxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUZULEVBQUUsQ0FBQyw4REFBOEQsRUFBRSxZQUFNO0VBQ3ZFLElBQU1XLE9BQU8sR0FBR2hCLGNBQWMsQ0FBQ2lCLGtCQUFrQixDQUFDZixjQUFjLENBQUM7RUFDakUsR0FBQWdCLE1BQUEsQ0FBSUYsT0FBTyxDQUFDRyxPQUFPLENBQUMsQ0FBQyxFQUFFTixPQUFPLENBQUMsVUFBQ08sSUFBSSxFQUFLO0lBQ3ZDZCxNQUFNLENBQUNjLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDQyxPQUFPLENBQUNuQixjQUFjLENBQUNVLEtBQUssQ0FBQ1UsSUFBSSxDQUFDLFVBQUNSLElBQUk7TUFBQSxPQUFLckIsU0FBUyxDQUFDcUIsSUFBSSxDQUFDLEtBQUtNLElBQUksQ0FBQyxDQUFDLENBQUM7SUFBQSxFQUFDLENBQUM7RUFDM0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUZHLFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxZQUFNO0VBQ3hDbEIsRUFBRSxDQUFDLDBCQUEwQixFQUFFLFlBQU07SUFDbkMsSUFBTW1CLElBQUksR0FBR3hCLGNBQWMsQ0FBQ3lCLHFCQUFxQixDQUFDdkIsY0FBYyxDQUFDO0lBQ2pFLElBQU1jLE9BQU8sR0FBR2hCLGNBQWMsQ0FBQ2lCLGtCQUFrQixDQUFDZixjQUFjLENBQUM7SUFFakVzQixJQUFJLENBQUNFLElBQUksQ0FBQyxVQUFDQyxLQUFrQyxFQUFFQyxJQUFjLEVBQUs7TUFDaEUsSUFBTUMsbUJBQW1CLEdBQUdGLEtBQUssS0FBSzNCLGNBQWMsQ0FBQzhCLFlBQVksR0FBRyxJQUFJLEdBQUdILEtBQUs7TUFDaEZDLElBQUksQ0FBQ0csUUFBUSxDQUFDbEIsT0FBTyxDQUFDLFVBQUNtQixTQUFTLEVBQUs7UUFDbkMxQixNQUFNLENBQUNYLGVBQWUsQ0FBQ3FCLE9BQU8sQ0FBQ2lCLEdBQUcsQ0FBQ0QsU0FBUyxDQUFDTCxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNuQixJQUFJLENBQUNxQixtQkFBbUIsQ0FBQztNQUNqRixDQUFDLENBQUM7SUFDSixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7RUFFRnhCLEVBQUUsQ0FBQyxpQ0FBaUMsRUFBRSxZQUFNO0lBQzFDQyxNQUFNLENBQUM7TUFBQSxPQUFNTixjQUFjLENBQUN5QixxQkFBcUIsQ0FBQ3hCLGNBQWMsQ0FBQztJQUFBLEVBQUMsQ0FBQ2lDLEdBQUcsQ0FBQ0MsT0FBTyxDQUFDLENBQUM7RUFDbEYsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUY5QixFQUFFLENBQUMsMkRBQTJELEVBQUUsWUFBTTtFQUNwRUMsTUFBTSxDQUFDTixjQUFjLENBQUNvQyxhQUFhLENBQUNsQyxjQUFjLENBQUMsQ0FBQyxDQUFDTSxJQUFJLENBQ3ZEUixjQUFjLENBQ1hpQixrQkFBa0IsQ0FBQ2YsY0FBYyxDQUFDLENBQ2xDK0IsR0FBRyxDQUFDakMsY0FBYyxDQUFDeUIscUJBQXFCLENBQUN2QixjQUFjLENBQUMsQ0FBQzZCLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQ0osS0FBSyxDQUMvRSxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUZ0QixFQUFFLENBQUMsNEVBQTRFLEVBQUUsWUFBTTtFQUNyRixJQUFNZ0MsZ0JBQWdCLEdBQUcsSUFBSUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsT0FBTyxDQUFDLENBQUMsR0FBRyxJQUFJO0VBQ3BELElBQU1DLFNBQVMsR0FBRztJQUNoQkMsU0FBUyxFQUFFSixnQkFBZ0I7SUFDM0JLLE1BQU0sRUFBRSxXQUFXO0lBQ25CQyxVQUFVLEVBQUU7RUFDZCxDQUFDO0VBRUQsSUFBTXhDLEtBQUssR0FBRztJQUNaUyxLQUFLLEVBQUUsQ0FDTDtNQUNFNkIsU0FBUyxFQUFFSixnQkFBZ0IsR0FBRyxJQUFJO01BQ2xDSyxNQUFNLEVBQUUsV0FBVztNQUNuQkMsVUFBVSxFQUFFO0lBQ2QsQ0FBQyxFQUNESCxTQUFTLEVBQ1Q7TUFDRUMsU0FBUyxFQUFFSixnQkFBZ0IsR0FBRyxJQUFJO01BQ2xDSyxNQUFNLEVBQUUsV0FBVztNQUNuQkMsVUFBVSxFQUFFO0lBQ2QsQ0FBQztFQUVMLENBQTZCO0VBRTdCckMsTUFBTSxDQUFDTixjQUFjLENBQUNvQyxhQUFhLENBQUNqQyxLQUFLLENBQUMsQ0FBQyxDQUFDSyxJQUFJLENBQUNnQyxTQUFTLENBQUM7QUFDN0QsQ0FBQyxDQUFDO0FBRUZuQyxFQUFFLENBQUMsa0VBQWtFLEVBQUUsWUFBTTtFQUMzRSxJQUFNSyxhQUFhLEdBQUdWLGNBQWMsQ0FBQ1cseUJBQXlCLENBQUNULGNBQWMsQ0FBQztFQUM5RSxJQUFNMEMsVUFBVSxHQUFHNUMsY0FBYyxDQUFDb0MsYUFBYSxDQUFDMUIsYUFBYSxDQUFDO0VBRTlESixNQUFNLENBQUNOLGNBQWMsQ0FBQzZDLFlBQVksQ0FBQ25DLGFBQWEsQ0FBQyxDQUFDLENBQUNGLElBQUksQ0FDbERWLGtCQUFrQixDQUFDOEMsVUFBVSxDQUFDLFVBQUtsRCxXQUFXLENBQUNrRCxVQUFVLENBQzlELENBQUM7QUFDSCxDQUFDLENBQUM7QUFFRnZDLEVBQUUsQ0FBQyxpRUFBaUUsRUFBRSxZQUFNO0VBQzFFQyxNQUFNLENBQUNOLGNBQWMsQ0FBQzhDLGlCQUFpQixDQUFDNUMsY0FBYyxDQUFDLENBQUMsQ0FBQ00sSUFBSSxDQUFDTixjQUFjLENBQUNVLEtBQUssQ0FBQ21DLE1BQU0sQ0FBQztBQUM1RixDQUFDLENBQUM7QUFFRjFDLEVBQUUsQ0FBQyw0REFBNEQsRUFBRSxZQUFNO0VBQ3JFQyxNQUFNLENBQUNOLGNBQWMsQ0FBQ2dELGdCQUFnQixDQUFDOUMsY0FBYyxDQUFDLENBQUMsQ0FBQ00sSUFBSSxDQUFDTixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ3FDLFFBQVEsQ0FBQztBQUNoRyxDQUFDLENBQUM7QUFFRjVDLEVBQUUsQ0FBQyxrRkFBa0YsRUFBRSxZQUFNO0VBQzNGQyxNQUFNLENBQUNOLGNBQWMsQ0FBQ2tELGlCQUFpQixDQUFDaEQsY0FBYyxDQUFDLENBQUMsQ0FBQ00sSUFBSSxDQUFDTixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzZCLFNBQVMsQ0FBQztBQUNsRyxDQUFDLENBQUM7QUFFRnBDLEVBQUUsQ0FBQyxvRUFBb0UsRUFBRSxZQUFNO0VBQzdFQyxNQUFNLENBQUNOLGNBQWMsQ0FBQ21ELGFBQWEsQ0FBQ2pELGNBQWMsQ0FBQyxDQUFDLENBQUNNLElBQUksQ0FDdkRSLGNBQWMsQ0FBQ3lCLHFCQUFxQixDQUFDdkIsY0FBYyxDQUFDLENBQUNrRCxLQUFLLEdBQUcsQ0FDL0QsQ0FBQztBQUNILENBQUMsQ0FBQztBQUVGL0MsRUFBRSxDQUFDLGlGQUFpRixFQUFFLFlBQU07RUFDMUYsU0FBU2dELGFBQWFBLENBQUN2QyxJQUFtQixFQUFFO0lBQzFDLElBQUlzQyxLQUFLLEdBQUcsQ0FBQztJQUNiLElBQUlFLFNBQVMsR0FBRzNELGVBQWUsQ0FBQ21CLElBQUksQ0FBQztJQUVyQyxJQUFNeUMsbUJBQW1CLEdBQUcsU0FBdEJBLG1CQUFtQkEsQ0FBSUMsSUFBbUI7TUFBQSxPQUFLL0QsU0FBUyxDQUFDK0QsSUFBSSxDQUFDLEtBQUtGLFNBQVM7SUFBQTtJQUNsRixPQUFPQSxTQUFTLEtBQUs3RCxTQUFTLENBQUNTLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUU7TUFDdkR3QyxLQUFLLEVBQUU7TUFDUEUsU0FBUyxHQUFHM0QsZUFBZSxDQUFDTyxjQUFjLENBQUNVLEtBQUssQ0FBQ1UsSUFBSSxDQUFDaUMsbUJBQW1CLENBQUUsQ0FBQztJQUM5RTs7SUFFQTs7SUFFQWpELE1BQU0sQ0FDSk4sY0FBYyxDQUFDeUQsb0JBQW9CLENBQUM7TUFDbEN0RCxLQUFLLEVBQUVELGNBQWM7TUFDckJZLElBQUksRUFBSkE7SUFDRixDQUFDLENBQ0gsQ0FBQyxDQUFDTixJQUFJLENBQUM0QyxLQUFLLENBQUM7RUFDZjs7RUFFQTtFQUNBQyxhQUFhLENBQUNuRCxjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUN0Q3lDLGFBQWEsQ0FBQ25ELGNBQWMsQ0FBQ1UsS0FBSyxDQUFDOEMsSUFBSSxDQUFDQyxLQUFLLENBQUN6RCxjQUFjLENBQUNVLEtBQUssQ0FBQ21DLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQ2hGTSxhQUFhLENBQUNuRCxjQUFjLENBQUNVLEtBQUssQ0FBQzhDLElBQUksQ0FBQ0MsS0FBSyxDQUFDekQsY0FBYyxDQUFDVSxLQUFLLENBQUNtQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztFQUNoRk0sYUFBYSxDQUFDbkQsY0FBYyxDQUFDVSxLQUFLLENBQUM4QyxJQUFJLENBQUNDLEtBQUssQ0FBQ3pELGNBQWMsQ0FBQ1UsS0FBSyxDQUFDbUMsTUFBTSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDckYsQ0FBQyxDQUFDO0FBRUYxQyxFQUFFLENBQUMsK0VBQStFLEVBQUUsWUFBTTtFQUN4RixJQUFNdUQsSUFBSSxHQUFHLEdBQUExQyxNQUFBLENBQUlsQixjQUFjLENBQUM2RCxnQkFBZ0IsQ0FBQzNELGNBQWMsQ0FBQyxFQUFFNEQsSUFBSSxDQUFDLENBQUM7RUFDeEUsSUFBTUMsR0FBRyxHQUFHLElBQUlDLEdBQUcsQ0FBQzFFLE9BQU8sQ0FBQ1ksY0FBYyxDQUFDYSxTQUFTLENBQUMsQ0FBQ2tELEdBQUcsQ0FBQyxVQUFDQyxDQUFDO0lBQUEsT0FBS0EsQ0FBQyxDQUFDQyxXQUFXO0VBQUEsRUFBQyxDQUFDO0VBQ2hGLElBQU1DLE9BQU8sR0FBRyxHQUFBbEQsTUFBQSxDQUFJNkMsR0FBRyxDQUFDMUUsTUFBTSxDQUFDLENBQUMsRUFBRXlFLElBQUksQ0FBQyxDQUFDO0VBQ3hDeEQsTUFBTSxDQUFDc0QsSUFBSSxDQUFDLENBQUN2QyxPQUFPLENBQUMrQyxPQUFPLENBQUM7QUFDL0IsQ0FBQyxDQUFDO0FBRUYvRCxFQUFFLENBQUMscUVBQXFFLEVBQUUsWUFBTTtFQUM5RUMsTUFBTSxDQUFDTixjQUFjLENBQUNxRSxvQkFBb0IsQ0FBQ25FLGNBQWMsQ0FBQyxDQUFDLENBQUNNLElBQUksQ0FDOUQ4RCxNQUFNLENBQUNqRixNQUFNLENBQUNhLGNBQWMsQ0FBQ2EsU0FBUyxDQUFDLENBQUN3RCxNQUFNLENBQUMsVUFBQ0MsT0FBTyxFQUFFQyxPQUFPO0lBQUEsT0FBS0QsT0FBTyxDQUFDRSxHQUFHLENBQUNELE9BQU8sQ0FBQ04sV0FBVyxDQUFDO0VBQUEsR0FBRSxJQUFJSCxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQzlHVyxJQUNMLENBQUM7QUFDSCxDQUFDLENBQUM7QUFFRnRFLEVBQUUsQ0FBQyw4RUFBOEUsRUFBRSxZQUFNO0VBQ3ZGQyxNQUFNLENBQUNOLGNBQWMsQ0FBQzRFLHFCQUFxQixDQUFDO0lBQUUzQixRQUFRLEVBQUUsTUFBTTtJQUFFNEIsSUFBSSxFQUFFO0VBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ3JFLElBQUksQ0FBQyxPQUFPLENBQUM7RUFFNUZGLE1BQU0sQ0FBQ04sY0FBYyxDQUFDNEUscUJBQXFCLENBQUM7SUFBRTNCLFFBQVEsRUFBRSxPQUFPO0lBQUU0QixJQUFJLEVBQUU7RUFBSyxDQUFDLENBQUMsQ0FBQyxDQUFDckUsSUFBSSxDQUFDLFFBQVEsQ0FBQztFQUU5RkYsTUFBTSxDQUFDTixjQUFjLENBQUM0RSxxQkFBcUIsQ0FBQztJQUFFM0IsUUFBUSxFQUFFLE9BQU87SUFBRTRCLElBQUksRUFBRTtFQUFJLENBQUMsQ0FBQyxDQUFDLENBQUNyRSxJQUFJLENBQUMsUUFBUSxDQUFDO0VBRTdGRixNQUFNLENBQUNOLGNBQWMsQ0FBQzRFLHFCQUFxQixDQUFDO0lBQUUzQixRQUFRLEVBQUUsS0FBSztJQUFFNEIsSUFBSSxFQUFFO0VBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQ3JFLElBQUksQ0FBQyxPQUFPLENBQUM7QUFDNUYsQ0FBQyxDQUFDO0FBRUZILEVBQUUsQ0FBQyxvRkFBb0YsRUFBRSxZQUFNO0VBQzdGLElBQU1tQyxTQUFTLEdBQUd0QyxjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUM7RUFDekM0QixTQUFTLENBQUNTLFFBQVEsR0FBRyxNQUFNO0VBQzNCM0MsTUFBTSxDQUNKTixjQUFjLENBQUM4RSxzQkFBc0IsQ0FBQztJQUNwQzNFLEtBQUssRUFBQTRFLFFBQUEsS0FDQTdFLGNBQWM7TUFDakJVLEtBQUssRUFBRSxDQUFDNEIsU0FBUztJQUFDLEVBQ25CO0lBQ0RTLFFBQVEsRUFBRTtFQUNaLENBQUMsQ0FDSCxDQUFDLENBQUN6QyxJQUFJLENBQUMsT0FBTyxDQUFDO0FBQ2pCLENBQUMsQ0FBQztBQUVGSCxFQUFFLENBQUMsa0ZBQWtGLEVBQUUsWUFBTTtFQUMzRkMsTUFBTSxDQUNKTixjQUFjLENBQUM4RSxzQkFBc0IsQ0FBQztJQUNwQzNFLEtBQUssRUFBQTRFLFFBQUEsS0FDQTdFLGNBQWM7TUFDakJVLEtBQUssRUFBRVYsY0FBYyxDQUFDVSxLQUFLLENBQUNNLE1BQU0sQ0FBQyxDQUFBNkQsUUFBQSxLQUU1QjdFLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMxQnFDLFFBQVEsRUFBRTtNQUFPLEdBRXBCO0lBQUMsRUFDSDtJQUNEQSxRQUFRLEVBQUU7RUFDWixDQUFDLENBQ0gsQ0FBQyxDQUFDekMsSUFBSSxDQUFDLFFBQVEsQ0FBQztFQUVoQkYsTUFBTSxDQUNKTixjQUFjLENBQUM4RSxzQkFBc0IsQ0FBQztJQUNwQzNFLEtBQUssRUFBQTRFLFFBQUEsS0FDQTdFLGNBQWM7TUFDakJVLEtBQUssRUFBRVYsY0FBYyxDQUFDVSxLQUFLLENBQUNNLE1BQU0sQ0FBQyxDQUFBNkQsUUFBQSxLQUU1QjdFLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUMxQnFDLFFBQVEsRUFBRTtNQUFPLEdBRXBCO0lBQUMsRUFDSDtJQUNEQSxRQUFRLEVBQUU7RUFDWixDQUFDLENBQ0gsQ0FBQyxDQUFDekMsSUFBSSxDQUFDLFFBQVEsQ0FBQztBQUNsQixDQUFDLENBQUM7QUFFRkgsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLFlBQU07RUFDakVDLE1BQU0sQ0FDSk4sY0FBYyxDQUFDZ0YsY0FBYyxDQUFDO0lBQzVCN0UsS0FBSyxFQUFFRCxjQUFjO0lBQ3JCVSxLQUFLLEVBQUVWLGNBQWMsQ0FBQ1UsS0FBSztJQUMzQmtELElBQUksRUFBRTtNQUNKbUIsR0FBRyxFQUFFLENBQUM7TUFDTkMsVUFBVSxFQUFFMUYsb0JBQW9CO01BQ2hDMkYsUUFBUSxFQUFFcEY7SUFDWjtFQUNGLENBQUMsQ0FDSCxDQUFDLENBQUNzQixPQUFPLENBQUMsR0FBQUgsTUFBQSxDQUFJaEIsY0FBYyxDQUFDVSxLQUFLLEVBQUVrRCxJQUFJLENBQUMsVUFBQ3NCLEtBQUssRUFBRUMsS0FBSztJQUFBLE9BQUtELEtBQUssQ0FBQzNDLFNBQVMsR0FBRzRDLEtBQUssQ0FBQzVDLFNBQVM7RUFBQSxFQUFDLENBQUM7RUFFOUZuQyxNQUFNLENBQ0pOLGNBQWMsQ0FBQ2dGLGNBQWMsQ0FBQztJQUM1QjdFLEtBQUssRUFBRUQsY0FBYztJQUNyQlUsS0FBSyxFQUFFVixjQUFjLENBQUNVLEtBQUs7SUFDM0JrRCxJQUFJLEVBQUU7TUFDSm1CLEdBQUcsRUFBRSxDQUFDLENBQUM7TUFDUEMsVUFBVSxFQUFFMUYsb0JBQW9CO01BQ2hDMkYsUUFBUSxFQUFFcEY7SUFDWjtFQUNGLENBQUMsQ0FDSCxDQUFDLENBQUNzQixPQUFPLENBQUMsR0FBQUgsTUFBQSxDQUFJaEIsY0FBYyxDQUFDVSxLQUFLLEVBQUVrRCxJQUFJLENBQUMsVUFBQ3NCLEtBQUssRUFBRUMsS0FBSztJQUFBLE9BQUtBLEtBQUssQ0FBQzVDLFNBQVMsR0FBRzJDLEtBQUssQ0FBQzNDLFNBQVM7RUFBQSxFQUFDLENBQUM7QUFDaEcsQ0FBQyxDQUFDO0FBRUZwQyxFQUFFLENBQUMsc0VBQXNFLEVBQUUsWUFBTTtFQUMvRUMsTUFBTSxDQUNKTixjQUFjLENBQUNzRix1QkFBdUIsQ0FBQztJQUNyQ25GLEtBQUssRUFBRUQsY0FBYztJQUNyQlksSUFBSSxFQUFFWixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDO0VBQzlCLENBQUMsQ0FDSCxDQUFDLENBQUNKLElBQUksQ0FBQ04sY0FBYyxDQUFDVSxLQUFLLENBQUNtQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0FBQ3pDLENBQUMsQ0FBQztBQUVGMUMsRUFBRSxDQUFDLG1FQUFtRSxFQUFFLFlBQU07RUFDNUVDLE1BQU0sQ0FDSk4sY0FBYyxDQUFDc0YsdUJBQXVCLENBQUM7SUFDckNuRixLQUFLLEVBQUVELGNBQWM7SUFDckJZLElBQUksRUFBRVosY0FBYyxDQUFDVSxLQUFLLENBQUMsQ0FBQztFQUM5QixDQUFDLENBQ0gsQ0FBQyxDQUFDSixJQUFJLENBQUNSLGNBQWMsQ0FBQ3lCLHFCQUFxQixDQUFDdkIsY0FBYyxDQUFDLENBQUNvQixJQUFJLENBQUNwQixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzhCLE1BQU0sQ0FBQyxDQUFFaUMsSUFBSSxHQUFHLENBQUMsQ0FBQztBQUM3RyxDQUFDLENBQUM7QUFFRnRFLEVBQUUsQ0FBQywrREFBK0QsRUFBRSxZQUFNO0VBQ3hFLElBQU1rRixVQUFVLEdBQUdyRixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUM7RUFDMUMyRSxVQUFVLENBQUM3QyxNQUFNLEdBQUcsVUFBVTtFQUU5QnBDLE1BQU0sQ0FDSk4sY0FBYyxDQUFDc0YsdUJBQXVCLENBQUM7SUFDckNuRixLQUFLLEVBQUVELGNBQWM7SUFDckJZLElBQUksRUFBRXlFO0VBQ1IsQ0FBQyxDQUNILENBQUMsQ0FBQy9FLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNaLENBQUMsQ0FBQztBQUVGSCxFQUFFLENBQUMscUVBQXFFLEVBQUUsWUFBTTtFQUM5RSxJQUFNOEQsV0FBVyxHQUFHakUsY0FBYyxDQUFDYSxTQUFTLENBQUNiLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDNEUsU0FBUyxDQUFDLENBQUNyQixXQUFXO0VBQzNGLElBQU1zQixhQUFhLEdBQUd2RixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQzZFLGFBQWE7RUFFM0RuRixNQUFNLENBQUNOLGNBQWMsQ0FBQzZDLFlBQVksQ0FBQzNDLGNBQWMsQ0FBQyxDQUFDLENBQUNNLElBQUksQ0FBSTJELFdBQVcsVUFBS3NCLGFBQWUsQ0FBQztBQUM5RixDQUFDLENBQUM7QUFFRnBGLEVBQUUsQ0FBQyx3REFBd0QsRUFBRSxZQUFNO0VBQ2pFLElBQU1TLElBQUksR0FBR1osY0FBYyxDQUFDVSxLQUFLLENBQUMsQ0FBQyxDQUFDO0VBQ3BDLElBQU0rRCxJQUFJLEdBQUczRSxjQUFjLENBQUN5QixxQkFBcUIsQ0FBQ3ZCLGNBQWMsQ0FBQyxDQUFDb0IsSUFBSSxDQUFDUixJQUFJLENBQUM0QixNQUFNLENBQUMsQ0FBRWlDLElBQUksR0FBRyxDQUFDO0VBRTdGckUsTUFBTSxDQUNKTixjQUFjLENBQUMwRixrQkFBa0IsQ0FBQztJQUNoQ3ZGLEtBQUssRUFBRUQsY0FBYztJQUNyQlUsS0FBSyxFQUFFVixjQUFjLENBQUNVLEtBQUs7SUFDM0IrRSxTQUFTLEVBQUUsQ0FBQzdFLElBQUksQ0FBQzRCLE1BQU07RUFDekIsQ0FBQyxDQUFDLENBQUNLLE1BQ0wsQ0FBQyxDQUFDdkMsSUFBSSxDQUFDTixjQUFjLENBQUNVLEtBQUssQ0FBQ21DLE1BQU0sR0FBRzRCLElBQUksQ0FBQztBQUM1QyxDQUFDLENBQUM7QUFFRnRFLEVBQUUsQ0FBQyw0RUFBNEUsRUFBRSxZQUFNO0VBQ3JGLElBQU1GLEtBQUssR0FBR0QsY0FBYztFQUM1QixJQUFNMEYsU0FBUyxHQUFHLElBQUl0RCxJQUFJLENBQUMsQ0FBQyxDQUFDQyxPQUFPLENBQUMsQ0FBQyxHQUFHLElBQUk7RUFFN0NwQyxLQUFLLENBQUNTLEtBQUssQ0FBQ0MsT0FBTyxDQUFDLFVBQUNDLElBQUksRUFBSztJQUM1QkEsSUFBSSxDQUFDbUMsUUFBUSxHQUFHLE9BQU87SUFDdkJuQyxJQUFJLENBQUMyQixTQUFTLEdBQUdtRCxTQUFTO0VBQzVCLENBQUMsQ0FBQztFQUVGdEYsTUFBTSxDQUNKTixjQUFjLENBQUM2RixnQkFBZ0IsQ0FBQztJQUM5QjFGLEtBQUssRUFBTEEsS0FBSztJQUNMMkYsUUFBUSxFQUFFLENBQUM7SUFDWEMsS0FBSyxFQUFFO0VBQ1QsQ0FBQyxDQUNILENBQUMsQ0FBQzFFLE9BQU8sQ0FBQyxDQUNSO0lBQUV1RSxTQUFTLEVBQVRBLFNBQVM7SUFBRUcsS0FBSyxFQUFFO0VBQUcsQ0FBQyxFQUN4QjtJQUFFSCxTQUFTLEVBQUVBLFNBQVMsR0FBRyxPQUFPO0lBQUVHLEtBQUssRUFBRTtFQUFHLENBQUMsRUFDN0M7SUFBRUgsU0FBUyxFQUFFQSxTQUFTLEdBQUcsT0FBTztJQUFFRyxLQUFLLEVBQUU7RUFBRyxDQUFDLEVBQzdDO0lBQUVILFNBQVMsRUFBRUEsU0FBUyxHQUFHLE9BQU87SUFBRUcsS0FBSyxFQUFFO0VBQUcsQ0FBQyxDQUM5QyxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUYxRixFQUFFLENBQUMsd0NBQXdDLEVBQUUsWUFBTTtFQUNqRCxJQUFNdUYsU0FBUyxHQUFHLElBQUl0RCxJQUFJLENBQUMsQ0FBQyxDQUFDQyxPQUFPLENBQUMsQ0FBQyxHQUFHLElBQUk7RUFDN0MsSUFBTXBDLEtBQUssR0FBR1osY0FBYyxDQUFDWSxLQUFLLENBQUM7SUFBRUMsYUFBYSxFQUFFO0VBQUUsQ0FBQyxDQUFDO0VBRXhERCxLQUFLLENBQUNTLEtBQUssR0FBRyxDQUNaO0lBQ0VILE9BQU8sRUFBRSxzQ0FBc0M7SUFDL0MrRSxTQUFTLEVBQUUsc0NBQXNDO0lBQ2pEOUMsTUFBTSxFQUFFLHNDQUFzQztJQUM5Q3NELEtBQUssRUFBRSxDQUFDO0lBQ1JDLElBQUksRUFBRSxFQUFFO0lBQ1JSLGFBQWEsRUFBRSxNQUFNO0lBQ3JCaEQsU0FBUyxFQUFFbUQsU0FBUztJQUNwQjNDLFFBQVEsRUFBRTtFQUNaLENBQUMsQ0FDRjtFQUVEM0MsTUFBTSxDQUFDTixjQUFjLENBQUM2RixnQkFBZ0IsQ0FBQztJQUFFMUYsS0FBSyxFQUFMQTtFQUFNLENBQUMsQ0FBQyxDQUFDLENBQUNrQixPQUFPLENBQUMsQ0FDekQ7SUFBRXVFLFNBQVMsRUFBVEEsU0FBUztJQUFFRyxLQUFLLEVBQUUvRixjQUFjLENBQUNrRztFQUFtQixDQUFDLEVBQ3ZEO0lBQ0VOLFNBQVMsRUFBRUEsU0FBUyxHQUFHLE9BQU87SUFDOUJHLEtBQUssRUFBRS9GLGNBQWMsQ0FBQ2tHO0VBQ3hCLENBQUMsRUFDRDtJQUNFTixTQUFTLEVBQUVBLFNBQVMsR0FBRyxPQUFPO0lBQzlCRyxLQUFLLEVBQUUvRixjQUFjLENBQUNrRztFQUN4QixDQUFDLEVBQ0Q7SUFDRU4sU0FBUyxFQUFFQSxTQUFTLEdBQUcsT0FBTztJQUM5QkcsS0FBSyxFQUFFL0YsY0FBYyxDQUFDa0c7RUFDeEIsQ0FBQyxFQUNEO0lBQ0VOLFNBQVMsRUFBRUEsU0FBUyxHQUFHLE9BQU87SUFDOUJHLEtBQUssRUFBRS9GLGNBQWMsQ0FBQ2tHO0VBQ3hCLENBQUMsQ0FDRixDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119