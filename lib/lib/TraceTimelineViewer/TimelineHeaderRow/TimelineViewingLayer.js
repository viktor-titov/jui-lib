import _inheritsLoose from "@babel/runtime/helpers/inheritsLoose";
import _taggedTemplateLiteralLoose from "@babel/runtime/helpers/taggedTemplateLiteralLoose";
var _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8;
// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { css, cx } from '@emotion/css';
import * as React from 'react';
import { stylesFactory } from '@grafana/ui';
import DraggableManager from '../../utils/DraggableManager';
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
// exported for testing
export var getStyles = stylesFactory(function () {
  return {
    TimelineViewingLayer: css(_templateObject || (_templateObject = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayer;\n      bottom: 0;\n      cursor: vertical-text;\n      left: 0;\n      position: absolute;\n      right: 0;\n      top: 0;\n    "]))),
    TimelineViewingLayerCursorGuide: css(_templateObject2 || (_templateObject2 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerCursorGuide;\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      width: 1px;\n      background-color: red;\n    "]))),
    TimelineViewingLayerDragged: css(_templateObject3 || (_templateObject3 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDragged;\n      position: absolute;\n      top: 0;\n      bottom: 0;\n    "]))),
    TimelineViewingLayerDraggedDraggingLeft: css(_templateObject4 || (_templateObject4 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedDraggingLeft;\n      border-left: 1px solid;\n    "]))),
    TimelineViewingLayerDraggedDraggingRight: css(_templateObject5 || (_templateObject5 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedDraggingRight;\n      border-right: 1px solid;\n    "]))),
    TimelineViewingLayerDraggedShiftDrag: css(_templateObject6 || (_templateObject6 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedShiftDrag;\n      background-color: rgba(68, 68, 255, 0.2);\n      border-color: #44f;\n    "]))),
    TimelineViewingLayerDraggedReframeDrag: css(_templateObject7 || (_templateObject7 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedReframeDrag;\n      background-color: rgba(255, 68, 68, 0.2);\n      border-color: #f44;\n    "]))),
    TimelineViewingLayerFullOverlay: css(_templateObject8 || (_templateObject8 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerFullOverlay;\n      bottom: 0;\n      cursor: col-resize;\n      left: 0;\n      position: fixed;\n      right: 0;\n      top: 0;\n      user-select: none;\n    "])))
  };
});
function isOutOfView(layout) {
  return Reflect.has(layout, 'isOutOfView');
}

/**
 * Map from a sub range to the greater view range, e.g, when the view range is
 * the middle half ([0.25, 0.75]), a value of 0.25 befomes 3/8.
 * @returns {number}
 */
function mapFromViewSubRange(viewStart, viewEnd, value) {
  return viewStart + value * (viewEnd - viewStart);
}

/**
 * Map a value from the view ([0, 1]) to a sub-range, e.g, when the view range is
 * the middle half ([0.25, 0.75]), a value of 3/8 becomes 1/4.
 * @returns {number}
 */
function mapToViewSubRange(viewStart, viewEnd, value) {
  return (value - viewStart) / (viewEnd - viewStart);
}

/**
 * Get the layout for the "next" view range time, e.g. the difference from the
 * drag start and the drag end. This is driven by `shiftStart`, `shiftEnd` or
 * `reframe` on `props.viewRangeTime`, not by the current state of the
 * component. So, it reflects in-progress dragging from the span minimap.
 */
function getNextViewLayout(start, position) {
  var _ref = start < position ? [start, position] : [position, start],
    left = _ref[0],
    right = _ref[1];
  if (left >= 1 || right <= 0) {
    return {
      isOutOfView: true
    };
  }
  if (left < 0) {
    left = 0;
  }
  if (right > 1) {
    right = 1;
  }
  return {
    isDraggingLeft: start > position,
    left: left * 100 + "%",
    width: (right - left) * 100 + "%"
  };
}

/**
 * Render the visual indication of the "next" view range.
 */
function getMarkers(viewStart, viewEnd, from, to, isShift) {
  var _cx;
  var mappedFrom = mapToViewSubRange(viewStart, viewEnd, from);
  var mappedTo = mapToViewSubRange(viewStart, viewEnd, to);
  var layout = getNextViewLayout(mappedFrom, mappedTo);
  if (isOutOfView(layout)) {
    return null;
  }
  var isDraggingLeft = layout.isDraggingLeft,
    left = layout.left,
    width = layout.width;
  var styles = getStyles();
  var cls = cx((_cx = {}, _cx[styles.TimelineViewingLayerDraggedDraggingRight] = !isDraggingLeft, _cx[styles.TimelineViewingLayerDraggedReframeDrag] = !isShift, _cx[styles.TimelineViewingLayerDraggedShiftDrag] = isShift, _cx));
  return /*#__PURE__*/_jsx("div", {
    className: cx(styles.TimelineViewingLayerDragged, styles.TimelineViewingLayerDraggedDraggingLeft, cls),
    style: {
      left: left,
      width: width
    },
    "data-testid": "Dragged"
  });
}

/**
 * `TimelineViewingLayer` is rendered on top of the TimelineHeaderRow time
 * labels; it handles showing the current view range and handles mouse UX for
 * modifying it.
 */
var TimelineViewingLayer = /*#__PURE__*/function (_React$PureComponent) {
  function TimelineViewingLayer(props) {
    var _this;
    _this = _React$PureComponent.call(this, props) || this;
    _this._setRoot = function (elm) {
      _this._root = elm;
    };
    _this._getDraggingBounds = function () {
      if (!_this._root) {
        throw new Error('invalid state');
      }
      var _this$_root$getBoundi = _this._root.getBoundingClientRect(),
        clientXLeft = _this$_root$getBoundi.left,
        width = _this$_root$getBoundi.width;
      return {
        clientXLeft: clientXLeft,
        width: width
      };
    };
    _this._handleReframeMouseMove = function (_ref2) {
      var value = _ref2.value;
      var _this$props$viewRange = _this.props.viewRangeTime.current,
        viewStart = _this$props$viewRange[0],
        viewEnd = _this$props$viewRange[1];
      var cursor = mapFromViewSubRange(viewStart, viewEnd, value);
      _this.props.updateNextViewRangeTime({
        cursor: cursor
      });
    };
    _this._handleReframeMouseLeave = function () {
      _this.props.updateNextViewRangeTime({
        cursor: undefined
      });
    };
    _this._handleReframeDragUpdate = function (_ref3) {
      var value = _ref3.value;
      var _this$props$viewRange2 = _this.props.viewRangeTime,
        current = _this$props$viewRange2.current,
        reframe = _this$props$viewRange2.reframe;
      var viewStart = current[0],
        viewEnd = current[1];
      var shift = mapFromViewSubRange(viewStart, viewEnd, value);
      var anchor = reframe ? reframe.anchor : shift;
      var update = {
        reframe: {
          anchor: anchor,
          shift: shift
        }
      };
      _this.props.updateNextViewRangeTime(update);
    };
    _this._handleReframeDragEnd = function (_ref4) {
      var manager = _ref4.manager,
        value = _ref4.value;
      var _this$props$viewRange3 = _this.props.viewRangeTime,
        current = _this$props$viewRange3.current,
        reframe = _this$props$viewRange3.reframe;
      var viewStart = current[0],
        viewEnd = current[1];
      var shift = mapFromViewSubRange(viewStart, viewEnd, value);
      var anchor = reframe ? reframe.anchor : shift;
      var _ref5 = shift < anchor ? [shift, anchor] : [anchor, shift],
        start = _ref5[0],
        end = _ref5[1];
      manager.resetBounds();
      _this.props.updateViewRangeTime(start, end, 'timeline-header');
    };
    _this._draggerReframe = new DraggableManager({
      getBounds: _this._getDraggingBounds,
      onDragEnd: _this._handleReframeDragEnd,
      onDragMove: _this._handleReframeDragUpdate,
      onDragStart: _this._handleReframeDragUpdate,
      onMouseLeave: _this._handleReframeMouseLeave,
      onMouseMove: _this._handleReframeMouseMove
    });
    _this._root = undefined;
    return _this;
  }
  _inheritsLoose(TimelineViewingLayer, _React$PureComponent);
  var _proto = TimelineViewingLayer.prototype;
  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps(nextProps) {
    var boundsInvalidator = this.props.boundsInvalidator;
    if (boundsInvalidator !== nextProps.boundsInvalidator) {
      this._draggerReframe.resetBounds();
    }
  };
  _proto.componentWillUnmount = function componentWillUnmount() {
    this._draggerReframe.dispose();
  };
  _proto.render = function render() {
    var viewRangeTime = this.props.viewRangeTime;
    var current = viewRangeTime.current,
      cursor = viewRangeTime.cursor,
      reframe = viewRangeTime.reframe,
      shiftEnd = viewRangeTime.shiftEnd,
      shiftStart = viewRangeTime.shiftStart;
    var viewStart = current[0],
      viewEnd = current[1];
    var haveNextTimeRange = reframe != null || shiftEnd != null || shiftStart != null;
    var cusrorPosition;
    if (!haveNextTimeRange && cursor != null && cursor >= viewStart && cursor <= viewEnd) {
      cusrorPosition = mapToViewSubRange(viewStart, viewEnd, cursor) * 100 + "%";
    }
    var styles = getStyles();
    return /*#__PURE__*/_jsxs("div", {
      "aria-hidden": true,
      className: styles.TimelineViewingLayer,
      ref: this._setRoot,
      onMouseDown: this._draggerReframe.handleMouseDown,
      onMouseLeave: this._draggerReframe.handleMouseLeave,
      onMouseMove: this._draggerReframe.handleMouseMove,
      "data-testid": "TimelineViewingLayer",
      children: [cusrorPosition != null && /*#__PURE__*/_jsx("div", {
        className: styles.TimelineViewingLayerCursorGuide,
        style: {
          left: cusrorPosition
        },
        "data-testid": "TimelineViewingLayer--cursorGuide"
      }), reframe != null && getMarkers(viewStart, viewEnd, reframe.anchor, reframe.shift, false), shiftEnd != null && getMarkers(viewStart, viewEnd, viewEnd, shiftEnd, true), shiftStart != null && getMarkers(viewStart, viewEnd, viewStart, shiftStart, true)]
    });
  };
  return TimelineViewingLayer;
}(React.PureComponent);
export { TimelineViewingLayer as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjc3MiLCJjeCIsIlJlYWN0Iiwic3R5bGVzRmFjdG9yeSIsIkRyYWdnYWJsZU1hbmFnZXIiLCJqc3giLCJfanN4IiwianN4cyIsIl9qc3hzIiwiZ2V0U3R5bGVzIiwiVGltZWxpbmVWaWV3aW5nTGF5ZXIiLCJfdGVtcGxhdGVPYmplY3QiLCJfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UiLCJUaW1lbGluZVZpZXdpbmdMYXllckN1cnNvckd1aWRlIiwiX3RlbXBsYXRlT2JqZWN0MiIsIlRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZCIsIl90ZW1wbGF0ZU9iamVjdDMiLCJUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWREcmFnZ2luZ0xlZnQiLCJfdGVtcGxhdGVPYmplY3Q0IiwiVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkRHJhZ2dpbmdSaWdodCIsIl90ZW1wbGF0ZU9iamVjdDUiLCJUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWRTaGlmdERyYWciLCJfdGVtcGxhdGVPYmplY3Q2IiwiVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkUmVmcmFtZURyYWciLCJfdGVtcGxhdGVPYmplY3Q3IiwiVGltZWxpbmVWaWV3aW5nTGF5ZXJGdWxsT3ZlcmxheSIsIl90ZW1wbGF0ZU9iamVjdDgiLCJpc091dE9mVmlldyIsImxheW91dCIsIlJlZmxlY3QiLCJoYXMiLCJtYXBGcm9tVmlld1N1YlJhbmdlIiwidmlld1N0YXJ0Iiwidmlld0VuZCIsInZhbHVlIiwibWFwVG9WaWV3U3ViUmFuZ2UiLCJnZXROZXh0Vmlld0xheW91dCIsInN0YXJ0IiwicG9zaXRpb24iLCJfcmVmIiwibGVmdCIsInJpZ2h0IiwiaXNEcmFnZ2luZ0xlZnQiLCJ3aWR0aCIsImdldE1hcmtlcnMiLCJmcm9tIiwidG8iLCJpc1NoaWZ0IiwiX2N4IiwibWFwcGVkRnJvbSIsIm1hcHBlZFRvIiwic3R5bGVzIiwiY2xzIiwiY2xhc3NOYW1lIiwic3R5bGUiLCJfUmVhY3QkUHVyZUNvbXBvbmVudCIsInByb3BzIiwiX3RoaXMiLCJjYWxsIiwiX3NldFJvb3QiLCJlbG0iLCJfcm9vdCIsIl9nZXREcmFnZ2luZ0JvdW5kcyIsIkVycm9yIiwiX3RoaXMkX3Jvb3QkZ2V0Qm91bmRpIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiY2xpZW50WExlZnQiLCJfaGFuZGxlUmVmcmFtZU1vdXNlTW92ZSIsIl9yZWYyIiwiX3RoaXMkcHJvcHMkdmlld1JhbmdlIiwidmlld1JhbmdlVGltZSIsImN1cnJlbnQiLCJjdXJzb3IiLCJ1cGRhdGVOZXh0Vmlld1JhbmdlVGltZSIsIl9oYW5kbGVSZWZyYW1lTW91c2VMZWF2ZSIsInVuZGVmaW5lZCIsIl9oYW5kbGVSZWZyYW1lRHJhZ1VwZGF0ZSIsIl9yZWYzIiwiX3RoaXMkcHJvcHMkdmlld1JhbmdlMiIsInJlZnJhbWUiLCJzaGlmdCIsImFuY2hvciIsInVwZGF0ZSIsIl9oYW5kbGVSZWZyYW1lRHJhZ0VuZCIsIl9yZWY0IiwibWFuYWdlciIsIl90aGlzJHByb3BzJHZpZXdSYW5nZTMiLCJfcmVmNSIsImVuZCIsInJlc2V0Qm91bmRzIiwidXBkYXRlVmlld1JhbmdlVGltZSIsIl9kcmFnZ2VyUmVmcmFtZSIsImdldEJvdW5kcyIsIm9uRHJhZ0VuZCIsIm9uRHJhZ01vdmUiLCJvbkRyYWdTdGFydCIsIm9uTW91c2VMZWF2ZSIsIm9uTW91c2VNb3ZlIiwiX2luaGVyaXRzTG9vc2UiLCJfcHJvdG8iLCJwcm90b3R5cGUiLCJVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsIm5leHRQcm9wcyIsImJvdW5kc0ludmFsaWRhdG9yIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJkaXNwb3NlIiwicmVuZGVyIiwic2hpZnRFbmQiLCJzaGlmdFN0YXJ0IiwiaGF2ZU5leHRUaW1lUmFuZ2UiLCJjdXNyb3JQb3NpdGlvbiIsInJlZiIsIm9uTW91c2VEb3duIiwiaGFuZGxlTW91c2VEb3duIiwiaGFuZGxlTW91c2VMZWF2ZSIsImhhbmRsZU1vdXNlTW92ZSIsImNoaWxkcmVuIiwiUHVyZUNvbXBvbmVudCIsImRlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvbGliL1RyYWNlVGltZWxpbmVWaWV3ZXIvVGltZWxpbmVIZWFkZXJSb3cvVGltZWxpbmVWaWV3aW5nTGF5ZXIudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgMjAxNyBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuLy9cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG5pbXBvcnQgeyBjc3MsIGN4IH0gZnJvbSAnQGVtb3Rpb24vY3NzJztcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHsgc3R5bGVzRmFjdG9yeSB9IGZyb20gJ0BncmFmYW5hL3VpJztcblxuaW1wb3J0IHsgVE5pbCB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCBEcmFnZ2FibGVNYW5hZ2VyLCB7IERyYWdnYWJsZUJvdW5kcywgRHJhZ2dpbmdVcGRhdGUgfSBmcm9tICcuLi8uLi91dGlscy9EcmFnZ2FibGVNYW5hZ2VyJztcbmltcG9ydCB7IFRVcGRhdGVWaWV3UmFuZ2VUaW1lRnVuY3Rpb24sIFZpZXdSYW5nZVRpbWUsIFZpZXdSYW5nZVRpbWVVcGRhdGUgfSBmcm9tICcuLi90eXBlcyc7XG5cbi8vIGV4cG9ydGVkIGZvciB0ZXN0aW5nXG5leHBvcnQgY29uc3QgZ2V0U3R5bGVzID0gc3R5bGVzRmFjdG9yeSgoKSA9PiB7XG4gIHJldHVybiB7XG4gICAgVGltZWxpbmVWaWV3aW5nTGF5ZXI6IGNzc2BcbiAgICAgIGxhYmVsOiBUaW1lbGluZVZpZXdpbmdMYXllcjtcbiAgICAgIGJvdHRvbTogMDtcbiAgICAgIGN1cnNvcjogdmVydGljYWwtdGV4dDtcbiAgICAgIGxlZnQ6IDA7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICByaWdodDogMDtcbiAgICAgIHRvcDogMDtcbiAgICBgLFxuICAgIFRpbWVsaW5lVmlld2luZ0xheWVyQ3Vyc29yR3VpZGU6IGNzc2BcbiAgICAgIGxhYmVsOiBUaW1lbGluZVZpZXdpbmdMYXllckN1cnNvckd1aWRlO1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgdG9wOiAwO1xuICAgICAgYm90dG9tOiAwO1xuICAgICAgbGVmdDogMDtcbiAgICAgIHdpZHRoOiAxcHg7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7XG4gICAgYCxcbiAgICBUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWQ6IGNzc2BcbiAgICAgIGxhYmVsOiBUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWQ7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICB0b3A6IDA7XG4gICAgICBib3R0b206IDA7XG4gICAgYCxcbiAgICBUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWREcmFnZ2luZ0xlZnQ6IGNzc2BcbiAgICAgIGxhYmVsOiBUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWREcmFnZ2luZ0xlZnQ7XG4gICAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkO1xuICAgIGAsXG4gICAgVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkRHJhZ2dpbmdSaWdodDogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZERyYWdnaW5nUmlnaHQ7XG4gICAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZDtcbiAgICBgLFxuICAgIFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZFNoaWZ0RHJhZzogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZFNoaWZ0RHJhZztcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoNjgsIDY4LCAyNTUsIDAuMik7XG4gICAgICBib3JkZXItY29sb3I6ICM0NGY7XG4gICAgYCxcbiAgICBUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWRSZWZyYW1lRHJhZzogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZFJlZnJhbWVEcmFnO1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDY4LCA2OCwgMC4yKTtcbiAgICAgIGJvcmRlci1jb2xvcjogI2Y0NDtcbiAgICBgLFxuICAgIFRpbWVsaW5lVmlld2luZ0xheWVyRnVsbE92ZXJsYXk6IGNzc2BcbiAgICAgIGxhYmVsOiBUaW1lbGluZVZpZXdpbmdMYXllckZ1bGxPdmVybGF5O1xuICAgICAgYm90dG9tOiAwO1xuICAgICAgY3Vyc29yOiBjb2wtcmVzaXplO1xuICAgICAgbGVmdDogMDtcbiAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgIHJpZ2h0OiAwO1xuICAgICAgdG9wOiAwO1xuICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gICAgYCxcbiAgfTtcbn0pO1xuXG5leHBvcnQgdHlwZSBUaW1lbGluZVZpZXdpbmdMYXllclByb3BzID0ge1xuICAvKipcbiAgICogYGJvdW5kc0ludmFsaWRhdG9yYCBpcyBhbiBhcmJpdHJhcnkgcHJvcCB0aGF0IGxldHMgdGhlIGNvbXBvbmVudCBrbm93IHRoZVxuICAgKiBib3VuZHMgZm9yIGRyYWdnaW5nIG5lZWQgdG8gYmUgcmVjYWxjdWxhdGVkLiBJbiBwcmFjdGljZSwgdGhlIG5hbWUgY29sdW1uXG4gICAqIHdpZHRoIHNlcnZlcyBmaW5lIGZvciB0aGlzLlxuICAgKi9cbiAgYm91bmRzSW52YWxpZGF0b3I6IGFueSB8IG51bGwgfCB1bmRlZmluZWQ7XG4gIHVwZGF0ZU5leHRWaWV3UmFuZ2VUaW1lOiAodXBkYXRlOiBWaWV3UmFuZ2VUaW1lVXBkYXRlKSA9PiB2b2lkO1xuICB1cGRhdGVWaWV3UmFuZ2VUaW1lOiBUVXBkYXRlVmlld1JhbmdlVGltZUZ1bmN0aW9uO1xuICB2aWV3UmFuZ2VUaW1lOiBWaWV3UmFuZ2VUaW1lO1xufTtcblxudHlwZSBURHJhZ2dpbmdMZWZ0TGF5b3V0ID0ge1xuICBpc0RyYWdnaW5nTGVmdDogYm9vbGVhbjtcbiAgbGVmdDogc3RyaW5nO1xuICB3aWR0aDogc3RyaW5nO1xufTtcblxudHlwZSBUT3V0T2ZWaWV3TGF5b3V0ID0ge1xuICBpc091dE9mVmlldzogdHJ1ZTtcbn07XG5cbmZ1bmN0aW9uIGlzT3V0T2ZWaWV3KGxheW91dDogVERyYWdnaW5nTGVmdExheW91dCB8IFRPdXRPZlZpZXdMYXlvdXQpOiBsYXlvdXQgaXMgVE91dE9mVmlld0xheW91dCB7XG4gIHJldHVybiBSZWZsZWN0LmhhcyhsYXlvdXQsICdpc091dE9mVmlldycpO1xufVxuXG4vKipcbiAqIE1hcCBmcm9tIGEgc3ViIHJhbmdlIHRvIHRoZSBncmVhdGVyIHZpZXcgcmFuZ2UsIGUuZywgd2hlbiB0aGUgdmlldyByYW5nZSBpc1xuICogdGhlIG1pZGRsZSBoYWxmIChbMC4yNSwgMC43NV0pLCBhIHZhbHVlIG9mIDAuMjUgYmVmb21lcyAzLzguXG4gKiBAcmV0dXJucyB7bnVtYmVyfVxuICovXG5mdW5jdGlvbiBtYXBGcm9tVmlld1N1YlJhbmdlKHZpZXdTdGFydDogbnVtYmVyLCB2aWV3RW5kOiBudW1iZXIsIHZhbHVlOiBudW1iZXIpIHtcbiAgcmV0dXJuIHZpZXdTdGFydCArIHZhbHVlICogKHZpZXdFbmQgLSB2aWV3U3RhcnQpO1xufVxuXG4vKipcbiAqIE1hcCBhIHZhbHVlIGZyb20gdGhlIHZpZXcgKFswLCAxXSkgdG8gYSBzdWItcmFuZ2UsIGUuZywgd2hlbiB0aGUgdmlldyByYW5nZSBpc1xuICogdGhlIG1pZGRsZSBoYWxmIChbMC4yNSwgMC43NV0pLCBhIHZhbHVlIG9mIDMvOCBiZWNvbWVzIDEvNC5cbiAqIEByZXR1cm5zIHtudW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIG1hcFRvVmlld1N1YlJhbmdlKHZpZXdTdGFydDogbnVtYmVyLCB2aWV3RW5kOiBudW1iZXIsIHZhbHVlOiBudW1iZXIpIHtcbiAgcmV0dXJuICh2YWx1ZSAtIHZpZXdTdGFydCkgLyAodmlld0VuZCAtIHZpZXdTdGFydCk7XG59XG5cbi8qKlxuICogR2V0IHRoZSBsYXlvdXQgZm9yIHRoZSBcIm5leHRcIiB2aWV3IHJhbmdlIHRpbWUsIGUuZy4gdGhlIGRpZmZlcmVuY2UgZnJvbSB0aGVcbiAqIGRyYWcgc3RhcnQgYW5kIHRoZSBkcmFnIGVuZC4gVGhpcyBpcyBkcml2ZW4gYnkgYHNoaWZ0U3RhcnRgLCBgc2hpZnRFbmRgIG9yXG4gKiBgcmVmcmFtZWAgb24gYHByb3BzLnZpZXdSYW5nZVRpbWVgLCBub3QgYnkgdGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlXG4gKiBjb21wb25lbnQuIFNvLCBpdCByZWZsZWN0cyBpbi1wcm9ncmVzcyBkcmFnZ2luZyBmcm9tIHRoZSBzcGFuIG1pbmltYXAuXG4gKi9cbmZ1bmN0aW9uIGdldE5leHRWaWV3TGF5b3V0KHN0YXJ0OiBudW1iZXIsIHBvc2l0aW9uOiBudW1iZXIpOiBURHJhZ2dpbmdMZWZ0TGF5b3V0IHwgVE91dE9mVmlld0xheW91dCB7XG4gIGxldCBbbGVmdCwgcmlnaHRdID0gc3RhcnQgPCBwb3NpdGlvbiA/IFtzdGFydCwgcG9zaXRpb25dIDogW3Bvc2l0aW9uLCBzdGFydF07XG4gIGlmIChsZWZ0ID49IDEgfHwgcmlnaHQgPD0gMCkge1xuICAgIHJldHVybiB7IGlzT3V0T2ZWaWV3OiB0cnVlIH07XG4gIH1cbiAgaWYgKGxlZnQgPCAwKSB7XG4gICAgbGVmdCA9IDA7XG4gIH1cbiAgaWYgKHJpZ2h0ID4gMSkge1xuICAgIHJpZ2h0ID0gMTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGlzRHJhZ2dpbmdMZWZ0OiBzdGFydCA+IHBvc2l0aW9uLFxuICAgIGxlZnQ6IGAke2xlZnQgKiAxMDB9JWAsXG4gICAgd2lkdGg6IGAkeyhyaWdodCAtIGxlZnQpICogMTAwfSVgLFxuICB9O1xufVxuXG4vKipcbiAqIFJlbmRlciB0aGUgdmlzdWFsIGluZGljYXRpb24gb2YgdGhlIFwibmV4dFwiIHZpZXcgcmFuZ2UuXG4gKi9cbmZ1bmN0aW9uIGdldE1hcmtlcnModmlld1N0YXJ0OiBudW1iZXIsIHZpZXdFbmQ6IG51bWJlciwgZnJvbTogbnVtYmVyLCB0bzogbnVtYmVyLCBpc1NoaWZ0OiBib29sZWFuKTogUmVhY3QuUmVhY3ROb2RlIHtcbiAgY29uc3QgbWFwcGVkRnJvbSA9IG1hcFRvVmlld1N1YlJhbmdlKHZpZXdTdGFydCwgdmlld0VuZCwgZnJvbSk7XG4gIGNvbnN0IG1hcHBlZFRvID0gbWFwVG9WaWV3U3ViUmFuZ2Uodmlld1N0YXJ0LCB2aWV3RW5kLCB0byk7XG4gIGNvbnN0IGxheW91dCA9IGdldE5leHRWaWV3TGF5b3V0KG1hcHBlZEZyb20sIG1hcHBlZFRvKTtcbiAgaWYgKGlzT3V0T2ZWaWV3KGxheW91dCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB7IGlzRHJhZ2dpbmdMZWZ0LCBsZWZ0LCB3aWR0aCB9ID0gbGF5b3V0O1xuICBjb25zdCBzdHlsZXMgPSBnZXRTdHlsZXMoKTtcbiAgY29uc3QgY2xzID0gY3goe1xuICAgIFtzdHlsZXMuVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkRHJhZ2dpbmdSaWdodF06ICFpc0RyYWdnaW5nTGVmdCxcbiAgICBbc3R5bGVzLlRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZFJlZnJhbWVEcmFnXTogIWlzU2hpZnQsXG4gICAgW3N0eWxlcy5UaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWRTaGlmdERyYWddOiBpc1NoaWZ0LFxuICB9KTtcbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBjbGFzc05hbWU9e2N4KHN0eWxlcy5UaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWQsIHN0eWxlcy5UaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWREcmFnZ2luZ0xlZnQsIGNscyl9XG4gICAgICBzdHlsZT17eyBsZWZ0LCB3aWR0aCB9fVxuICAgICAgZGF0YS10ZXN0aWQ9XCJEcmFnZ2VkXCJcbiAgICAvPlxuICApO1xufVxuXG4vKipcbiAqIGBUaW1lbGluZVZpZXdpbmdMYXllcmAgaXMgcmVuZGVyZWQgb24gdG9wIG9mIHRoZSBUaW1lbGluZUhlYWRlclJvdyB0aW1lXG4gKiBsYWJlbHM7IGl0IGhhbmRsZXMgc2hvd2luZyB0aGUgY3VycmVudCB2aWV3IHJhbmdlIGFuZCBoYW5kbGVzIG1vdXNlIFVYIGZvclxuICogbW9kaWZ5aW5nIGl0LlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUaW1lbGluZVZpZXdpbmdMYXllciBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8VGltZWxpbmVWaWV3aW5nTGF5ZXJQcm9wcz4ge1xuICBfZHJhZ2dlclJlZnJhbWU6IERyYWdnYWJsZU1hbmFnZXI7XG4gIF9yb290OiBFbGVtZW50IHwgVE5pbDtcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogVGltZWxpbmVWaWV3aW5nTGF5ZXJQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLl9kcmFnZ2VyUmVmcmFtZSA9IG5ldyBEcmFnZ2FibGVNYW5hZ2VyKHtcbiAgICAgIGdldEJvdW5kczogdGhpcy5fZ2V0RHJhZ2dpbmdCb3VuZHMsXG4gICAgICBvbkRyYWdFbmQ6IHRoaXMuX2hhbmRsZVJlZnJhbWVEcmFnRW5kLFxuICAgICAgb25EcmFnTW92ZTogdGhpcy5faGFuZGxlUmVmcmFtZURyYWdVcGRhdGUsXG4gICAgICBvbkRyYWdTdGFydDogdGhpcy5faGFuZGxlUmVmcmFtZURyYWdVcGRhdGUsXG4gICAgICBvbk1vdXNlTGVhdmU6IHRoaXMuX2hhbmRsZVJlZnJhbWVNb3VzZUxlYXZlLFxuICAgICAgb25Nb3VzZU1vdmU6IHRoaXMuX2hhbmRsZVJlZnJhbWVNb3VzZU1vdmUsXG4gICAgfSk7XG4gICAgdGhpcy5fcm9vdCA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wczogVGltZWxpbmVWaWV3aW5nTGF5ZXJQcm9wcykge1xuICAgIGNvbnN0IHsgYm91bmRzSW52YWxpZGF0b3IgfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKGJvdW5kc0ludmFsaWRhdG9yICE9PSBuZXh0UHJvcHMuYm91bmRzSW52YWxpZGF0b3IpIHtcbiAgICAgIHRoaXMuX2RyYWdnZXJSZWZyYW1lLnJlc2V0Qm91bmRzKCk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5fZHJhZ2dlclJlZnJhbWUuZGlzcG9zZSgpO1xuICB9XG5cbiAgX3NldFJvb3QgPSAoZWxtOiBFbGVtZW50IHwgVE5pbCkgPT4ge1xuICAgIHRoaXMuX3Jvb3QgPSBlbG07XG4gIH07XG5cbiAgX2dldERyYWdnaW5nQm91bmRzID0gKCk6IERyYWdnYWJsZUJvdW5kcyA9PiB7XG4gICAgaWYgKCF0aGlzLl9yb290KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2ludmFsaWQgc3RhdGUnKTtcbiAgICB9XG4gICAgY29uc3QgeyBsZWZ0OiBjbGllbnRYTGVmdCwgd2lkdGggfSA9IHRoaXMuX3Jvb3QuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIHsgY2xpZW50WExlZnQsIHdpZHRoIH07XG4gIH07XG5cbiAgX2hhbmRsZVJlZnJhbWVNb3VzZU1vdmUgPSAoeyB2YWx1ZSB9OiBEcmFnZ2luZ1VwZGF0ZSkgPT4ge1xuICAgIGNvbnN0IFt2aWV3U3RhcnQsIHZpZXdFbmRdID0gdGhpcy5wcm9wcy52aWV3UmFuZ2VUaW1lLmN1cnJlbnQ7XG4gICAgY29uc3QgY3Vyc29yID0gbWFwRnJvbVZpZXdTdWJSYW5nZSh2aWV3U3RhcnQsIHZpZXdFbmQsIHZhbHVlKTtcbiAgICB0aGlzLnByb3BzLnVwZGF0ZU5leHRWaWV3UmFuZ2VUaW1lKHsgY3Vyc29yIH0pO1xuICB9O1xuXG4gIF9oYW5kbGVSZWZyYW1lTW91c2VMZWF2ZSA9ICgpID0+IHtcbiAgICB0aGlzLnByb3BzLnVwZGF0ZU5leHRWaWV3UmFuZ2VUaW1lKHsgY3Vyc29yOiB1bmRlZmluZWQgfSk7XG4gIH07XG5cbiAgX2hhbmRsZVJlZnJhbWVEcmFnVXBkYXRlID0gKHsgdmFsdWUgfTogRHJhZ2dpbmdVcGRhdGUpID0+IHtcbiAgICBjb25zdCB7IGN1cnJlbnQsIHJlZnJhbWUgfSA9IHRoaXMucHJvcHMudmlld1JhbmdlVGltZTtcbiAgICBjb25zdCBbdmlld1N0YXJ0LCB2aWV3RW5kXSA9IGN1cnJlbnQ7XG4gICAgY29uc3Qgc2hpZnQgPSBtYXBGcm9tVmlld1N1YlJhbmdlKHZpZXdTdGFydCwgdmlld0VuZCwgdmFsdWUpO1xuICAgIGNvbnN0IGFuY2hvciA9IHJlZnJhbWUgPyByZWZyYW1lLmFuY2hvciA6IHNoaWZ0O1xuICAgIGNvbnN0IHVwZGF0ZSA9IHsgcmVmcmFtZTogeyBhbmNob3IsIHNoaWZ0IH0gfTtcbiAgICB0aGlzLnByb3BzLnVwZGF0ZU5leHRWaWV3UmFuZ2VUaW1lKHVwZGF0ZSk7XG4gIH07XG5cbiAgX2hhbmRsZVJlZnJhbWVEcmFnRW5kID0gKHsgbWFuYWdlciwgdmFsdWUgfTogRHJhZ2dpbmdVcGRhdGUpID0+IHtcbiAgICBjb25zdCB7IGN1cnJlbnQsIHJlZnJhbWUgfSA9IHRoaXMucHJvcHMudmlld1JhbmdlVGltZTtcbiAgICBjb25zdCBbdmlld1N0YXJ0LCB2aWV3RW5kXSA9IGN1cnJlbnQ7XG4gICAgY29uc3Qgc2hpZnQgPSBtYXBGcm9tVmlld1N1YlJhbmdlKHZpZXdTdGFydCwgdmlld0VuZCwgdmFsdWUpO1xuICAgIGNvbnN0IGFuY2hvciA9IHJlZnJhbWUgPyByZWZyYW1lLmFuY2hvciA6IHNoaWZ0O1xuICAgIGNvbnN0IFtzdGFydCwgZW5kXSA9IHNoaWZ0IDwgYW5jaG9yID8gW3NoaWZ0LCBhbmNob3JdIDogW2FuY2hvciwgc2hpZnRdO1xuICAgIG1hbmFnZXIucmVzZXRCb3VuZHMoKTtcbiAgICB0aGlzLnByb3BzLnVwZGF0ZVZpZXdSYW5nZVRpbWUoc3RhcnQsIGVuZCwgJ3RpbWVsaW5lLWhlYWRlcicpO1xuICB9O1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHZpZXdSYW5nZVRpbWUgfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBjdXJyZW50LCBjdXJzb3IsIHJlZnJhbWUsIHNoaWZ0RW5kLCBzaGlmdFN0YXJ0IH0gPSB2aWV3UmFuZ2VUaW1lO1xuICAgIGNvbnN0IFt2aWV3U3RhcnQsIHZpZXdFbmRdID0gY3VycmVudDtcbiAgICBjb25zdCBoYXZlTmV4dFRpbWVSYW5nZSA9IHJlZnJhbWUgIT0gbnVsbCB8fCBzaGlmdEVuZCAhPSBudWxsIHx8IHNoaWZ0U3RhcnQgIT0gbnVsbDtcbiAgICBsZXQgY3Vzcm9yUG9zaXRpb246IHN0cmluZyB8IFROaWw7XG4gICAgaWYgKCFoYXZlTmV4dFRpbWVSYW5nZSAmJiBjdXJzb3IgIT0gbnVsbCAmJiBjdXJzb3IgPj0gdmlld1N0YXJ0ICYmIGN1cnNvciA8PSB2aWV3RW5kKSB7XG4gICAgICBjdXNyb3JQb3NpdGlvbiA9IGAke21hcFRvVmlld1N1YlJhbmdlKHZpZXdTdGFydCwgdmlld0VuZCwgY3Vyc29yKSAqIDEwMH0lYDtcbiAgICB9XG4gICAgY29uc3Qgc3R5bGVzID0gZ2V0U3R5bGVzKCk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXZcbiAgICAgICAgYXJpYS1oaWRkZW5cbiAgICAgICAgY2xhc3NOYW1lPXtzdHlsZXMuVGltZWxpbmVWaWV3aW5nTGF5ZXJ9XG4gICAgICAgIHJlZj17dGhpcy5fc2V0Um9vdH1cbiAgICAgICAgb25Nb3VzZURvd249e3RoaXMuX2RyYWdnZXJSZWZyYW1lLmhhbmRsZU1vdXNlRG93bn1cbiAgICAgICAgb25Nb3VzZUxlYXZlPXt0aGlzLl9kcmFnZ2VyUmVmcmFtZS5oYW5kbGVNb3VzZUxlYXZlfVxuICAgICAgICBvbk1vdXNlTW92ZT17dGhpcy5fZHJhZ2dlclJlZnJhbWUuaGFuZGxlTW91c2VNb3ZlfVxuICAgICAgICBkYXRhLXRlc3RpZD1cIlRpbWVsaW5lVmlld2luZ0xheWVyXCJcbiAgICAgID5cbiAgICAgICAge2N1c3JvclBvc2l0aW9uICE9IG51bGwgJiYgKFxuICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgIGNsYXNzTmFtZT17c3R5bGVzLlRpbWVsaW5lVmlld2luZ0xheWVyQ3Vyc29yR3VpZGV9XG4gICAgICAgICAgICBzdHlsZT17eyBsZWZ0OiBjdXNyb3JQb3NpdGlvbiB9fVxuICAgICAgICAgICAgZGF0YS10ZXN0aWQ9XCJUaW1lbGluZVZpZXdpbmdMYXllci0tY3Vyc29yR3VpZGVcIlxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICAgIHtyZWZyYW1lICE9IG51bGwgJiYgZ2V0TWFya2Vycyh2aWV3U3RhcnQsIHZpZXdFbmQsIHJlZnJhbWUuYW5jaG9yLCByZWZyYW1lLnNoaWZ0LCBmYWxzZSl9XG4gICAgICAgIHtzaGlmdEVuZCAhPSBudWxsICYmIGdldE1hcmtlcnModmlld1N0YXJ0LCB2aWV3RW5kLCB2aWV3RW5kLCBzaGlmdEVuZCwgdHJ1ZSl9XG4gICAgICAgIHtzaGlmdFN0YXJ0ICE9IG51bGwgJiYgZ2V0TWFya2Vycyh2aWV3U3RhcnQsIHZpZXdF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LElBQUk0QixRQUFRLElBQUksSUFBSSxJQUFJQyxVQUFVLElBQUksSUFBSTtJQUNuRixJQUFJRSxjQUE2QjtJQUNqQyxJQUFJLENBQUNELGlCQUFpQixJQUFJckMsTUFBTSxJQUFJLElBQUksSUFBSUEsTUFBTSxJQUFJeEMsU0FBUyxJQUFJd0MsTUFBTSxJQUFJdkMsT0FBTyxFQUFFO01BQ3BGNkUsY0FBYyxHQUFNM0UsaUJBQWlCLENBQUNILFNBQVMsRUFBRUMsT0FBTyxFQUFFdUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxNQUFHO0lBQzVFO0lBQ0EsSUFBTXJCLE1BQU0sR0FBRzFDLFNBQVMsQ0FBQyxDQUFDO0lBQzFCLG9CQUNFRCxLQUFBO01BQ0UsbUJBQVc7TUFDWDZDLFNBQVMsRUFBRUYsTUFBTSxDQUFDekMsb0JBQXFCO01BQ3ZDcUcsR0FBRyxFQUFFLElBQUksQ0FBQ3BELFFBQVM7TUFDbkJxRCxXQUFXLEVBQUUsSUFBSSxDQUFDckIsZUFBZSxDQUFDc0IsZUFBZ0I7TUFDbERqQixZQUFZLEVBQUUsSUFBSSxDQUFDTCxlQUFlLENBQUN1QixnQkFBaUI7TUFDcERqQixXQUFXLEVBQUUsSUFBSSxDQUFDTixlQUFlLENBQUN3QixlQUFnQjtNQUNsRCxlQUFZLHNCQUFzQjtNQUFBQyxRQUFBLEdBRWpDTixjQUFjLElBQUksSUFBSSxpQkFDckJ4RyxJQUFBO1FBQ0UrQyxTQUFTLEVBQUVGLE1BQU0sQ0FBQ3RDLCtCQUFnQztRQUNsRHlDLEtBQUssRUFBRTtVQUFFZCxJQUFJLEVBQUVzRTtRQUFlLENBQUU7UUFDaEMsZUFBWTtNQUFtQyxDQUNoRCxDQUNGLEVBQ0EvQixPQUFPLElBQUksSUFBSSxJQUFJbkMsVUFBVSxDQUFDWixTQUFTLEVBQUVDLE9BQU8sRUFBRThDLE9BQU8sQ0FBQ0UsTUFBTSxFQUFFRixPQUFPLENBQUNDLEtBQUssRUFBRSxLQUFLLENBQUMsRUFDdkYyQixRQUFRLElBQUksSUFBSSxJQUFJL0QsVUFBVSxDQUFDWixTQUFTLEVBQUVDLE9BQU8sRUFBRUEsT0FBTyxFQUFFMEUsUUFBUSxFQUFFLElBQUksQ0FBQyxFQUMzRUMsVUFBVSxJQUFJLElBQUksSUFBSWhFLFVBQVUsQ0FBQ1osU0FBUyxFQUFFQyxPQUFPLEVBQUVELFNBQVMsRUFBRTRFLFVBQVUsRUFBRSxJQUFJLENBQUM7SUFBQSxDQUMvRSxDQUFDO0VBRVYsQ0FBQztFQUFBLE9BQUFsRyxvQkFBQTtBQUFBLEVBckcrQ1IsS0FBSyxDQUFDbUgsYUFBYTtBQUFBLFNBQWhEM0csb0JBQW9CLElBQUE0RyxPQUFBIiwiaWdub3JlTGlzdCI6W119