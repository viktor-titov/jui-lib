// Copyright (c) 2019 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { find as _find, get as _get } from 'lodash';
function getFirstAncestor(span) {
  return _get(_find(span.references, function (_ref) {
    var ref = _ref.span,
      refType = _ref.refType;
    return ref && ref.spanID && (refType === 'CHILD_OF' || refType === 'FOLLOWS_FROM');
  }), 'span');
}
export default function spanAncestorIds(span) {
  var ancestorIDs = [];
  if (!span) {
    return ancestorIDs;
  }
  var ref = getFirstAncestor(span);
  while (ref) {
    ancestorIDs.push(ref.spanID);
    ref = getFirstAncestor(ref);
  }
  return ancestorIDs;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmaW5kIiwiX2ZpbmQiLCJnZXQiLCJfZ2V0IiwiZ2V0Rmlyc3RBbmNlc3RvciIsInNwYW4iLCJyZWZlcmVuY2VzIiwiX3JlZiIsInJlZiIsInJlZlR5cGUiLCJzcGFuSUQiLCJzcGFuQW5jZXN0b3JJZHMiLCJhbmNlc3RvcklEcyIsInB1c2giXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGliL3V0aWxzL3NwYW4tYW5jZXN0b3ItaWRzLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMTkgVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgZmluZCBhcyBfZmluZCwgZ2V0IGFzIF9nZXQgfSBmcm9tICdsb2Rhc2gnO1xuXG5pbXBvcnQgeyBUTmlsIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgVHJhY2VTcGFuIH0gZnJvbSAnLi4vdHlwZXMvdHJhY2UnO1xuXG5mdW5jdGlvbiBnZXRGaXJzdEFuY2VzdG9yKHNwYW46IFRyYWNlU3Bhbik6IFRyYWNlU3BhbiB8IFROaWwge1xuICByZXR1cm4gX2dldChcbiAgICBfZmluZChcbiAgICAgIHNwYW4ucmVmZXJlbmNlcyxcbiAgICAgICh7IHNwYW46IHJlZiwgcmVmVHlwZSB9KSA9PiByZWYgJiYgcmVmLnNwYW5JRCAmJiAocmVmVHlwZSA9PT0gJ0NISUxEX09GJyB8fCByZWZUeXBlID09PSAnRk9MTE9XU19GUk9NJylcbiAgICApLFxuICAgICdzcGFuJ1xuICApO1xufVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBzcGFuQW5jZXN0b3JJZHMoc3BhbjogVHJhY2VTcGFuIHwgVE5pbCk6IHN0cmluZ1tdIHtcbiAgY29uc3QgYW5jZXN0b3JJRHM6IHN0cmluZ1tdID0gW107XG4gIGlmICghc3Bhbikge1xuICAgIHJldHVybiBhbmNlc3RvcklEcztcbiAgfVxuICBsZXQgcmVmID0gZ2V0Rmlyc3RBbmNlc3RvcihzcGFuKTtcbiAgd2hpbGUgKHJlZikge1xuICAgIGFuY2VzdG9ySURzLnB1c2gocmVmLnNwYW5JRCk7XG4gICAgcmVmID0gZ2V0Rmlyc3RBbmNlc3RvcihyZWYpO1xuICB9XG4gIHJldHVybiBhbmNlc3RvcklEcztcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsU0FBU0EsSUFBSSxJQUFJQyxLQUFLLEVBQUVDLEdBQUcsSUFBSUMsSUFBSSxRQUFRLFFBQVE7QUFLbkQsU0FBU0MsZ0JBQWdCQSxDQUFDQyxJQUFlLEVBQW9CO0VBQzNELE9BQU9GLElBQUksQ0FDVEYsS0FBSyxDQUNISSxJQUFJLENBQUNDLFVBQVUsRUFDZixVQUFBQyxJQUFBO0lBQUEsSUFBU0MsR0FBRyxHQUFBRCxJQUFBLENBQVRGLElBQUk7TUFBT0ksT0FBTyxHQUFBRixJQUFBLENBQVBFLE9BQU87SUFBQSxPQUFPRCxHQUFHLElBQUlBLEdBQUcsQ0FBQ0UsTUFBTSxLQUFLRCxPQUFPLEtBQUssVUFBVSxJQUFJQSxPQUFPLEtBQUssY0FBYyxDQUFDO0VBQUEsQ0FDekcsQ0FBQyxFQUNELE1BQ0YsQ0FBQztBQUNIO0FBRUEsZUFBZSxTQUFTRSxlQUFlQSxDQUFDTixJQUFzQixFQUFZO0VBQ3hFLElBQU1PLFdBQXFCLEdBQUcsRUFBRTtFQUNoQyxJQUFJLENBQUNQLElBQUksRUFBRTtJQUNULE9BQU9PLFdBQVc7RUFDcEI7RUFDQSxJQUFJSixHQUFHLEdBQUdKLGdCQUFnQixDQUFDQyxJQUFJLENBQUM7RUFDaEMsT0FBT0csR0FBRyxFQUFFO0lBQ1ZJLFdBQVcsQ0FBQ0MsSUFBSSxDQUFDTCxHQUFHLENBQUNFLE1BQU0sQ0FBQztJQUM1QkYsR0FBRyxHQUFHSixnQkFBZ0IsQ0FBQ0ksR0FBRyxDQUFDO0VBQzdCO0VBQ0EsT0FBT0ksV0FBVztBQUNwQiIsImlnbm9yZUxpc3QiOltdfQ==