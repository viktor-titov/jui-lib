// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import ease from 'tween-functions';
var Tween = /*#__PURE__*/function () {
  function Tween(_ref) {
    var _this = this;
    var duration = _ref.duration,
      from = _ref.from,
      to = _ref.to,
      delay = _ref.delay,
      onUpdate = _ref.onUpdate,
      onComplete = _ref.onComplete;
    this._frameCallback = function () {
      _this.timeoutID = undefined;
      _this.requestID = undefined;
      var current = Object.freeze(_this.getCurrent());
      if (_this.onUpdate) {
        _this.onUpdate(current);
      }
      if (_this.onComplete && current.done) {
        _this.onComplete(current);
      }
      if (current.done) {
        _this.onComplete = undefined;
        _this.onUpdate = undefined;
      } else {
        _this.requestID = window.requestAnimationFrame(_this._frameCallback);
      }
    };
    this.startTime = Date.now() + (delay || 0);
    this.duration = duration;
    this.from = from;
    this.to = to;
    if (!onUpdate && !onComplete) {
      this.onComplete = undefined;
      this.onUpdate = undefined;
      this.timeoutID = undefined;
      this.requestID = undefined;
    } else {
      this.onComplete = onComplete;
      this.onUpdate = onUpdate;
      if (delay) {
        // setTimeout from @types/node returns NodeJS.Timeout, so prefix with `window.`
        this.timeoutID = window.setTimeout(this._frameCallback, delay);
        this.requestID = undefined;
      } else {
        this.requestID = window.requestAnimationFrame(this._frameCallback);
        this.timeoutID = undefined;
      }
    }
  }
  var _proto = Tween.prototype;
  _proto.cancel = function cancel() {
    if (this.timeoutID != null) {
      clearTimeout(this.timeoutID);
      this.timeoutID = undefined;
    }
    if (this.requestID != null) {
      window.cancelAnimationFrame(this.requestID);
      this.requestID = undefined;
    }
    this.onComplete = undefined;
    this.onUpdate = undefined;
  };
  _proto.getCurrent = function getCurrent() {
    var t = Date.now() - this.startTime;
    if (t <= 0) {
      // still in the delay period
      return {
        done: false,
        value: this.from
      };
    }
    if (t >= this.duration) {
      // after the expiration
      return {
        done: true,
        value: this.to
      };
    }
    // mid-tween
    return {
      done: false,
      value: ease.easeOutQuint(t, this.from, this.to, this.duration)
    };
  };
  return Tween;
}();
export { Tween as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJlYXNlIiwiVHdlZW4iLCJfcmVmIiwiX3RoaXMiLCJkdXJhdGlvbiIsImZyb20iLCJ0byIsImRlbGF5Iiwib25VcGRhdGUiLCJvbkNvbXBsZXRlIiwiX2ZyYW1lQ2FsbGJhY2siLCJ0aW1lb3V0SUQiLCJ1bmRlZmluZWQiLCJyZXF1ZXN0SUQiLCJjdXJyZW50IiwiT2JqZWN0IiwiZnJlZXplIiwiZ2V0Q3VycmVudCIsImRvbmUiLCJ3aW5kb3ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93Iiwic2V0VGltZW91dCIsIl9wcm90byIsInByb3RvdHlwZSIsImNhbmNlbCIsImNsZWFyVGltZW91dCIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwidCIsInZhbHVlIiwiZWFzZU91dFF1aW50IiwiZGVmYXVsdCJdLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvVHdlZW4udHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgMjAxNyBVYmVyIFRlY2hub2xvZ2llcywgSW5jLlxuLy9cbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4vLyB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4vLyBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4vLyBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4vLyBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbi8vIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG5pbXBvcnQgZWFzZSBmcm9tICd0d2Vlbi1mdW5jdGlvbnMnO1xuXG5pbXBvcnQgeyBUTmlsIH0gZnJvbSAnLi90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHdlZW5TdGF0ZSB7XG4gIGRvbmU6IGJvb2xlYW47XG4gIHZhbHVlOiBudW1iZXI7XG59XG5cbnR5cGUgVFR3ZWVuQ2FsbGJhY2sgPSAoc3RhdGU6IFR3ZWVuU3RhdGUpID0+IHZvaWQ7XG5cbmV4cG9ydCB0eXBlIFRUd2Vlbk9wdGlvbnMgPSB7XG4gIGRlbGF5PzogbnVtYmVyO1xuICBkdXJhdGlvbjogbnVtYmVyO1xuICBmcm9tOiBudW1iZXI7XG4gIG9uQ29tcGxldGU/OiBUVHdlZW5DYWxsYmFjaztcbiAgb25VcGRhdGU/OiBUVHdlZW5DYWxsYmFjaztcbiAgdG86IG51bWJlcjtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFR3ZWVuIHtcbiAgb25Db21wbGV0ZTogVFR3ZWVuQ2FsbGJhY2sgfCBUTmlsO1xuICBvblVwZGF0ZTogVFR3ZWVuQ2FsbGJhY2sgfCBUTmlsO1xuICBkZWxheTogbnVtYmVyIHwgVE5pbDtcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgZnJvbTogbnVtYmVyO1xuICByZXF1ZXN0SUQ6IG51bWJlciB8IFROaWw7XG4gIHN0YXJ0VGltZTogbnVtYmVyO1xuICB0aW1lb3V0SUQ6IG51bWJlciB8IFROaWw7XG4gIHRvOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoeyBkdXJhdGlvbiwgZnJvbSwgdG8sIGRlbGF5LCBvblVwZGF0ZSwgb25Db21wbGV0ZSB9OiBUVHdlZW5PcHRpb25zKSB7XG4gICAgdGhpcy5zdGFydFRpbWUgPSBEYXRlLm5vdygpICsgKGRlbGF5IHx8IDApO1xuICAgIHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICB0aGlzLmZyb20gPSBmcm9tO1xuICAgIHRoaXMudG8gPSB0bztcbiAgICBpZiAoIW9uVXBkYXRlICYmICFvbkNvbXBsZXRlKSB7XG4gICAgICB0aGlzLm9uQ29tcGxldGUgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLm9uVXBkYXRlID0gdW5kZWZpbmVkO1xuICAgICAgdGhpcy50aW1lb3V0SUQgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLnJlcXVlc3RJRCA9IHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5vbkNvbXBsZXRlID0gb25Db21wbGV0ZTtcbiAgICAgIHRoaXMub25VcGRhdGUgPSBvblVwZGF0ZTtcbiAgICAgIGlmIChkZWxheSkge1xuICAgICAgICAvLyBzZXRUaW1lb3V0IGZyb20gQHR5cGVzL25vZGUgcmV0dXJucyBOb2RlSlMuVGltZW91dCwgc28gcHJlZml4IHdpdGggYHdpbmRvdy5gXG4gICAgICAgIHRoaXMudGltZW91dElEID0gd2luZG93LnNldFRpbWVvdXQodGhpcy5fZnJhbWVDYWxsYmFjaywgZGVsYXkpO1xuICAgICAgICB0aGlzLnJlcXVlc3RJRCA9IHVuZGVmaW5lZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVxdWVzdElEID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9mcmFtZUNhbGxiYWNrKTtcbiAgICAgICAgdGhpcy50aW1lb3V0SUQgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgX2ZyYW1lQ2FsbGJhY2sgPSAoKSA9PiB7XG4gICAgdGhpcy50aW1lb3V0SUQgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5yZXF1ZXN0SUQgPSB1bmRlZmluZWQ7XG4gICAgY29uc3QgY3VycmVudCA9IE9iamVjdC5mcmVlemUodGhpcy5nZXRDdXJyZW50KCkpO1xuICAgIGlmICh0aGlzLm9uVXBkYXRlKSB7XG4gICAgICB0aGlzLm9uVXBkYXRlKGN1cnJlbnQpO1xuICAgIH1cbiAgICBpZiAodGhpcy5vbkNvbXBsZXRlICYmIGN1cnJlbnQuZG9uZSkge1xuICAgICAgdGhpcy5vbkNvbXBsZXRlKGN1cnJlbnQpO1xuICAgIH1cbiAgICBpZiAoY3VycmVudC5kb25lKSB7XG4gICAgICB0aGlzLm9uQ29tcGxldGUgPSB1bmRlZmluZWQ7XG4gICAgICB0aGlzLm9uVXBkYXRlID0gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnJlcXVlc3RJRCA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fZnJhbWVDYWxsYmFjayk7XG4gICAgfVxuICB9O1xuXG4gIGNhbmNlbCgpIHtcbiAgICBpZiAodGhpcy50aW1lb3V0SUQgIT0gbnVsbCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dElEKTtcbiAgICAgIHRoaXMudGltZW91dElEID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodGhpcy5yZXF1ZXN0SUQgIT0gbnVsbCkge1xuICAgICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMucmVxdWVzdElEKTtcbiAgICAgIHRoaXMucmVxdWVzdElEID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICB0aGlzLm9uQ29tcGxldGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5vblVwZGF0ZSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGdldEN1cnJlbnQoKTogVHdlZW5TdGF0ZSB7XG4gICAgY29uc3QgdCA9IERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZTtcbiAgICBpZiAodCA8PSAwKSB7XG4gICAgICAvLyBzdGlsbCBpbiB0aGUgZGVsYXkgcGVyaW9kXG4gICAgICByZXR1cm4geyBkb25lOiBmYWxzZSwgdmFsdWU6IHRoaXMuZnJvbSB9O1xuICAgIH1cbiAgICBpZiAodCA+PSB0aGlzLmR1cmF0aW9uKSB7XG4gICAgICAvLyBhZnRlciB0aGUgZXhwaXJhdGlvblxuICAgICAgcmV0dXJuIHsgZG9uZTogdHJ1ZSwgdmFsdWU6IHRoaXMudG8gfTtcbiAgICB9XG4gICAgLy8gbWlkLXR3ZWVuXG4gICAgcmV0dXJuIHsgZG9uZTogZmFsc2UsIHZhbHVlOiBlYXNlLmVhc2VPdXRRdWludCh0LCB0aGlzLmZyb20sIHRoaXMudG8sIHRoaXMuZHVyYXRpb24pIH07XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBT0EsSUFBSSxNQUFNLGlCQUFpQjtBQUFDLElBb0JkQyxLQUFLO0VBV3hCLFNBQUFBLE1BQUFDLElBQUEsRUFBZ0Y7SUFBQSxJQUFBQyxLQUFBO0lBQUEsSUFBbEVDLFFBQVEsR0FBQUYsSUFBQSxDQUFSRSxRQUFRO01BQUVDLElBQUksR0FBQUgsSUFBQSxDQUFKRyxJQUFJO01BQUVDLEVBQUUsR0FBQUosSUFBQSxDQUFGSSxFQUFFO01BQUVDLEtBQUssR0FBQUwsSUFBQSxDQUFMSyxLQUFLO01BQUVDLFFBQVEsR0FBQU4sSUFBQSxDQUFSTSxRQUFRO01BQUVDLFVBQVUsR0FBQVAsSUFBQSxDQUFWTyxVQUFVO0lBQUEsS0F3QjdEQyxjQUFjLEdBQUcsWUFBTTtNQUNyQlAsS0FBSSxDQUFDUSxTQUFTLEdBQUdDLFNBQVM7TUFDMUJULEtBQUksQ0FBQ1UsU0FBUyxHQUFHRCxTQUFTO01BQzFCLElBQU1FLE9BQU8sR0FBR0MsTUFBTSxDQUFDQyxNQUFNLENBQUNiLEtBQUksQ0FBQ2MsVUFBVSxDQUFDLENBQUMsQ0FBQztNQUNoRCxJQUFJZCxLQUFJLENBQUNLLFFBQVEsRUFBRTtRQUNqQkwsS0FBSSxDQUFDSyxRQUFRLENBQUNNLE9BQU8sQ0FBQztNQUN4QjtNQUNBLElBQUlYLEtBQUksQ0FBQ00sVUFBVSxJQUFJSyxPQUFPLENBQUNJLElBQUksRUFBRTtRQUNuQ2YsS0FBSSxDQUFDTSxVQUFVLENBQUNLLE9BQU8sQ0FBQztN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