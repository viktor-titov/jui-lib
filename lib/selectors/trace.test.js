import _extends from "@babel/runtime/helpers/extends";
// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { values as _values } from 'lodash';
import traceGenerator from '../demo/trace-generators';
import { numberSortComparator } from '../utils/sort';
import { getSpanId, getSpanName, getSpanParentId, getSpanProcess, getSpanProcessId, getSpanServiceName, getSpanTimestamp } from './span';
import * as traceSelectors from './trace';
import { followsFromRef } from './trace.fixture';
var generatedTrace = traceGenerator.trace({
  numberOfSpans: 45
});
it('getTraceId() should return the traceID', function () {
  expect(traceSelectors.getTraceId(generatedTrace)).toBe(generatedTrace.traceID);
});
it('hydrateSpansWithProcesses() should return the trace with processes on each span', function () {
  var hydratedTrace = traceSelectors.hydrateSpansWithProcesses(generatedTrace);
  hydratedTrace.spans.forEach(function (span) {
    return expect(getSpanProcess(span)).toBe(generatedTrace.processes[getSpanProcessId(span)]);
  });
});
it('getTraceSpansAsMap() should return a map of all of the spans', function () {
  var spanMap = traceSelectors.getTraceSpansAsMap(generatedTrace);
  [].concat(spanMap.entries()).forEach(function (pair) {
    expect(pair[1]).toEqual(generatedTrace.spans.find(function (span) {
      return getSpanId(span) === pair[0];
    }));
  });
});
describe('getTraceSpanIdsAsTree()', function () {
  it('builds the tree properly', function () {
    var tree = traceSelectors.getTraceSpanIdsAsTree(generatedTrace);
    var spanMap = traceSelectors.getTraceSpansAsMap(generatedTrace);
    tree.walk(function (value, node) {
      var expectedParentValue = value === traceSelectors.TREE_ROOT_ID ? null : value;
      node.children.forEach(function (childNode) {
        expect(getSpanParentId(spanMap.get(childNode.value))).toBe(expectedParentValue);
      });
    });
  });
  it('#115 - handles FOLLOW_FROM refs', function () {
    expect(function () {
      return traceSelectors.getTraceSpanIdsAsTree(followsFromRef);
    }).not.toThrow();
  });
});
it('getParentSpan() should return the parent span of the tree', function () {
  expect(traceSelectors.getParentSpan(generatedTrace)).toBe(traceSelectors.getTraceSpansAsMap(generatedTrace).get(traceSelectors.getTraceSpanIdsAsTree(generatedTrace).children[0].value));
});
it('getParentSpan() should return the first span if there are multiple parents', function () {
  var initialTimestamp = new Date().getTime() * 1000;
  var firstSpan = {
    startTime: initialTimestamp,
    spanID: 'my-span-1',
    references: []
  };
  var trace = {
    spans: [{
      startTime: initialTimestamp + 2000,
      spanID: 'my-span-3',
      references: []
    }, firstSpan, {
      startTime: initialTimestamp + 1000,
      spanID: 'my-span-2',
      references: []
    }]
  };
  expect(traceSelectors.getParentSpan(trace)).toBe(firstSpan);
});
it('getTraceName() should return a formatted name for the first span', function () {
  var hydratedTrace = traceSelectors.hydrateSpansWithProcesses(generatedTrace);
  var parentSpan = traceSelectors.getParentSpan(hydratedTrace);
  expect(traceSelectors.getTraceName(hydratedTrace)).toBe(getSpanServiceName(parentSpan) + ": " + getSpanName(parentSpan));
});
it('getTraceSpanCount() should return the length of the spans array', function () {
  expect(traceSelectors.getTraceSpanCount(generatedTrace)).toBe(generatedTrace.spans.length);
});
it('getTraceDuration() should return the duration for the span', function () {
  expect(traceSelectors.getTraceDuration(generatedTrace)).toBe(generatedTrace.spans[0].duration);
});
it('getTraceTimestamp() should return the first timestamp for the conventional trace', function () {
  expect(traceSelectors.getTraceTimestamp(generatedTrace)).toBe(generatedTrace.spans[0].startTime);
});
it('getTraceDepth() should determine the total depth of the trace tree', function () {
  expect(traceSelectors.getTraceDepth(generatedTrace)).toBe(traceSelectors.getTraceSpanIdsAsTree(generatedTrace).depth - 1);
});
it('getSpanDepthForTrace() should determine the depth of a given span in the parent', function () {
  function testDepthCalc(span) {
    var depth = 2;
    var currentId = getSpanParentId(span);
    var findCurrentSpanById = function findCurrentSpanById(item) {
      return getSpanId(item) === currentId;
    };
    while (currentId !== getSpanId(generatedTrace.spans[0])) {
      depth++;
      currentId = getSpanParentId(generatedTrace.spans.find(findCurrentSpanById));
    }

    // console.log('hypothetical depth', depth);

    expect(traceSelectors.getSpanDepthForTrace({
      trace: generatedTrace,
      span: span
    })).toBe(depth);
  }

  // test depth calculations for a few random spans
  testDepthCalc(generatedTrace.spans[1]);
  testDepthCalc(generatedTrace.spans[Math.floor(generatedTrace.spans.length / 2)]);
  testDepthCalc(generatedTrace.spans[Math.floor(generatedTrace.spans.length / 4)]);
  testDepthCalc(generatedTrace.spans[Math.floor(generatedTrace.spans.length * 0.75)]);
});
it('getTraceServices() should return an unique array of all services in the trace', function () {
  var svcs = [].concat(traceSelectors.getTraceServices(generatedTrace)).sort();
  var set = new Set(_values(generatedTrace.processes).map(function (v) {
    return v.serviceName;
  }));
  var setSvcs = [].concat(set.values()).sort();
  expect(svcs).toEqual(setSvcs);
});
it('getTraceServiceCount() should return the length of the service list', function () {
  expect(traceSelectors.getTraceServiceCount(generatedTrace)).toBe(Object.values(generatedTrace.processes).reduce(function (results, process) {
    return results.add(process.serviceName);
  }, new Set()).size);
});
it('formatDurationForUnit() should use the formatters to return the proper value', function () {
  expect(traceSelectors.formatDurationForUnit({
    duration: 302000,
    unit: 'ms'
  })).toBe('302ms');
  expect(traceSelectors.formatDurationForUnit({
    duration: 1302000,
    unit: 'ms'
  })).toBe('1302ms');
  expect(traceSelectors.formatDurationForUnit({
    duration: 1302000,
    unit: 's'
  })).toBe('1.302s');
  expect(traceSelectors.formatDurationForUnit({
    duration: 90000,
    unit: 's'
  })).toBe('0.09s');
});
it('formatDurationForTrace() should return a ms value for traces shorter than a second', function () {
  var firstSpan = generatedTrace.spans[0];
  firstSpan.duration = 600000;
  expect(traceSelectors.formatDurationForTrace({
    trace: _extends({}, generatedTrace, {
      spans: [firstSpan]
    }),
    duration: 302000
  })).toBe('302ms');
});
it('formatDurationForTrace() should return a s value for traces longer than a second', function () {
  expect(traceSelectors.formatDurationForTrace({
    trace: _extends({}, generatedTrace, {
      spans: generatedTrace.spans.concat([_extends({}, generatedTrace.spans[0], {
        duration: 1000000
      })])
    }),
    duration: 302000
  })).toBe('0.302s');
  expect(traceSelectors.formatDurationForTrace({
    trace: _extends({}, generatedTrace, {
      spans: generatedTrace.spans.concat([_extends({}, generatedTrace.spans[0], {
        duration: 1200000
      })])
    }),
    duration: 302000
  })).toBe('0.302s');
});
it('getSortedSpans() should sort spans given a sort object', function () {
  expect(traceSelectors.getSortedSpans({
    trace: generatedTrace,
    spans: generatedTrace.spans,
    sort: {
      dir: 1,
      comparator: numberSortComparator,
      selector: getSpanTimestamp
    }
  })).toEqual([].concat(generatedTrace.spans).sort(function (spanA, spanB) {
    return spanA.startTime - spanB.startTime;
  }));
  expect(traceSelectors.getSortedSpans({
    trace: generatedTrace,
    spans: generatedTrace.spans,
    sort: {
      dir: -1,
      comparator: numberSortComparator,
      selector: getSpanTimestamp
    }
  })).toEqual([].concat(generatedTrace.spans).sort(function (spanA, spanB) {
    return spanB.startTime - spanA.startTime;
  }));
});
it('getTreeSizeForTraceSpan() should return the size for the parent span', function () {
  expect(traceSelectors.getTreeSizeForTraceSpan({
    trace: generatedTrace,
    span: generatedTrace.spans[0]
  })).toBe(generatedTrace.spans.length - 1);
});
it('getTreeSizeForTraceSpan() should return the size for a child span', function () {
  expect(traceSelectors.getTreeSizeForTraceSpan({
    trace: generatedTrace,
    span: generatedTrace.spans[1]
  })).toBe(traceSelectors.getTraceSpanIdsAsTree(generatedTrace).find(generatedTrace.spans[1].spanID).size - 1);
});
it('getTreeSizeForTraceSpan() should return -1 for an absent span', function () {
  var absentSpan = generatedTrace.spans[0];
  absentSpan.spanID = 'whatever';
  expect(traceSelectors.getTreeSizeForTraceSpan({
    trace: generatedTrace,
    span: absentSpan
  })).toBe(-1);
});
it('getTraceName() should return the trace name based on the parentSpan', function () {
  var serviceName = generatedTrace.processes[generatedTrace.spans[0].processID].serviceName;
  var operationName = generatedTrace.spans[0].operationName;
  expect(traceSelectors.getTraceName(generatedTrace)).toBe(serviceName + ": " + operationName);
});
it('omitCollapsedSpans() should filter out collapsed spans', function () {
  var span = generatedTrace.spans[1];
  var size = traceSelectors.getTraceSpanIdsAsTree(generatedTrace).find(span.spanID).size - 1;
  expect(traceSelectors.omitCollapsedSpans({
    trace: generatedTrace,
    spans: generatedTrace.spans,
    collapsed: [span.spanID]
  }).length).toBe(generatedTrace.spans.length - size);
});
it('getTicksForTrace() should return a list of ticks given interval parameters', function () {
  var trace = generatedTrace;
  var timestamp = new Date().getTime() * 1000;
  trace.spans.forEach(function (span) {
    span.duration = 3000000;
    span.startTime = timestamp;
  });
  expect(traceSelectors.getTicksForTrace({
    trace: trace,
    interval: 3,
    width: 10
  })).toEqual([{
    timestamp: timestamp,
    width: 10
  }, {
    timestamp: timestamp + 1000000,
    width: 10
  }, {
    timestamp: timestamp + 2000000,
    width: 10
  }, {
    timestamp: timestamp + 3000000,
    width: 10
  }]);
});
it('getTicksForTrace() should use defaults', function () {
  var timestamp = new Date().getTime() * 1000;
  var trace = traceGenerator.trace({
    numberOfSpans: 1
  });
  trace.spans = [{
    traceID: '5031233a-d0b5-5d41-9b4b-4c072bcf5020',
    processID: 'b5f4e0ff-7318-5017-a3f3-9c7b423a82aa',
    spanID: 'e871771f-f1b4-54af-9e9d-826259c2915e',
    flags: 0,
    logs: [],
    operationName: 'POST',
    startTime: timestamp,
    duration: 4000000
  }];
  expect(traceSelectors.getTicksForTrace({
    trace: trace
  })).toEqual([{
    timestamp: timestamp,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 1000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 2000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 3000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }, {
    timestamp: timestamp + 4000000,
    width: traceSelectors.DEFAULT_TICK_WIDTH
  }]);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2YWx1ZXMiLCJfdmFsdWVzIiwidHJhY2VHZW5lcmF0b3IiLCJudW1iZXJTb3J0Q29tcGFyYXRvciIsImdldFNwYW5JZCIsImdldFNwYW5OYW1lIiwiZ2V0U3BhblBhcmVudElkIiwiZ2V0U3BhblByb2Nlc3MiLCJnZXRTcGFuUHJvY2Vzc0lkIiwiZ2V0U3BhblNlcnZpY2VOYW1lIiwiZ2V0U3BhblRpbWVzdGFtcCIsInRyYWNlU2VsZWN0b3JzIiwiZm9sbG93c0Zyb21SZWYiLCJnZW5lcmF0ZWRUcmFjZSIsInRyYWNlIiwibnVtYmVyT2ZTcGFucyIsIml0IiwiZXhwZWN0IiwiZ2V0VHJhY2VJZCIsInRvQmUiLCJ0cmFjZUlEIiwiaHlkcmF0ZWRUcmFjZSIsImh5ZHJhdGVTcGFuc1dpdGhQcm9jZXNzZXMiLCJzcGFucyIsImZvckVhY2giLCJzcGFuIiwicHJvY2Vzc2VzIiwic3Bhbk1hcCIsImdldFRyYWNlU3BhbnNBc01hcCIsImNvbmNhdCIsImVudHJpZXMiLCJwYWlyIiwidG9FcXVhbCIsImZpbmQiLCJkZXNjcmliZSIsInRyZWUiLCJnZXRUcmFjZVNwYW5JZHNBc1RyZWUiLCJ3YWxrIiwidmFsdWUiLCJub2RlIiwiZXhwZWN0ZWRQYXJlbnRWYWx1ZSIsIlRSRUVfUk9PVF9JRCIsImNoaWxkcmVuIiwiY2hpbGROb2RlIiwiZ2V0Iiwibm90IiwidG9UaHJvdyIsImdldFBhcmVudFNwYW4iLCJpbml0aWFsVGltZXN0YW1wIiwiRGF0ZSIsImdldFRpbWUiLCJmaXJzdFNwYW4iLCJzdGFydFRpbWUiLCJzcGFuSUQiLCJyZWZlcmVuY2VzIiwicGFyZW50U3BhbiIsImdldFRyYWNlTmFtZSIsImdldFRyYWNlU3BhbkNvdW50IiwibGVuZ3RoIiwiZ2V0VHJhY2VEdXJhdGlvbiIsImR1cmF0aW9uIiwiZ2V0VHJhY2VUaW1lc3RhbXAiLCJnZXRUcmFjZURlcHRoIiwiZGVwdGgiLCJ0ZXN0RGVwdGhDYWxjIiwiY3VycmVudElkIiwiZmluZEN1cnJlbnRTcGFuQnlJZCIsIml0ZW0iLCJnZXRTcGFuRGVwdGhGb3JUcmFjZSIsIk1hdGgiLCJmbG9vciIsInN2Y3MiLCJnZXRUcmFjZVNlcnZpY2VzIiwic29ydCIsInNldCIsIlNldCIsIm1hcCIsInYiLCJzZXJ2aWNlTmFtZSIsInNldFN2Y3MiLCJnZXRUcmFjZVNlcnZpY2VDb3VudCIsIk9iamVjdCIsInJlZHVjZSIsInJlc3VsdHMiLCJwcm9jZXNzIiwiYWRkIiwic2l6ZSIsImZvcm1hdER1cmF0aW9uRm9yVW5pdCIsInVuaXQiLCJmb3JtYXREdXJhdGlvbkZvclRyYWNlIiwiX2V4dGVuZHMiLCJnZXRTb3J0ZWRTcGFucyIsImRpciIsImNvbXBhcmF0b3IiLCJzZWxlY3RvciIsInNwYW5BIiwic3BhbkIiLCJnZXRUcmVlU2l6ZUZvclRyYWNlU3BhbiIsImFic2VudFNwYW4iLCJwcm9jZXNzSUQiLCJvcGVyYXRpb25OYW1lIiwib21pdENvbGxhcHNlZFNwYW5zIiwiY29sbGFwc2VkIiwidGltZXN0YW1wIiwiZ2V0VGlja3NGb3JUcmFjZSIsImludGVydmFsIiwid2lkdGgiLCJmbGFncyIsImxvZ3MiLCJERUZBVUxUX1RJQ0tfV0lEVEgiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvc2VsZWN0b3JzL3RyYWNlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE3IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy9cbi8vIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCB7IHZhbHVlcyBhcyBfdmFsdWVzIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBUcmVlTm9kZSBmcm9tICdzcmMvdXRpbHMvVHJlZU5vZGUnO1xuXG5pbXBvcnQgdHJhY2VHZW5lcmF0b3IgZnJvbSAnLi4vZGVtby90cmFjZS1nZW5lcmF0b3JzJztcbmltcG9ydCB7IFRyYWNlUmVzcG9uc2UsIFRyYWNlU3BhbiwgVHJhY2VTcGFuRGF0YSB9IGZyb20gJy4uL3R5cGVzL3RyYWNlJztcbmltcG9ydCB7IG51bWJlclNvcnRDb21wYXJhdG9yIH0gZnJvbSAnLi4vdXRpbHMvc29ydCc7XG5cbmltcG9ydCB7XG4gIGdldFNwYW5JZCxcbiAgZ2V0U3Bhbk5hbWUsXG4gIGdldFNwYW5QYXJlbnRJZCxcbiAgZ2V0U3BhblByb2Nlc3MsXG4gIGdldFNwYW5Qcm9jZXNzSWQsXG4gIGdldFNwYW5TZXJ2aWNlTmFtZSxcbiAgZ2V0U3BhblRpbWVzdGFtcCxcbn0gZnJvbSAnLi9zcGFuJztcbmltcG9ydCAqIGFzIHRyYWNlU2VsZWN0b3JzIGZyb20gJy4vdHJhY2UnO1xuaW1wb3J0IHsgZm9sbG93c0Zyb21SZWYgfSBmcm9tICcuL3RyYWNlLmZpeHR1cmUnO1xuXG5jb25zdCBnZW5lcmF0ZWRUcmFjZTogVHJhY2VSZXNwb25zZSA9IHRyYWNlR2VuZXJhdG9yLnRyYWNlKHsgbnVtYmVyT2ZTcGFuczogNDUgfSk7XG5cbml0KCdnZXRUcmFjZUlkKCkgc2hvdWxkIHJldHVybiB0aGUgdHJhY2VJRCcsICgpID0+IHtcbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlSWQoZ2VuZXJhdGVkVHJhY2UpKS50b0JlKGdlbmVyYXRlZFRyYWNlLnRyYWNlSUQpO1xufSk7XG5cbml0KCdoeWRyYXRlU3BhbnNXaXRoUHJvY2Vzc2VzKCkgc2hvdWxkIHJldHVybiB0aGUgdHJhY2Ugd2l0aCBwcm9jZXNzZXMgb24gZWFjaCBzcGFuJywgKCkgPT4ge1xuICBjb25zdCBoeWRyYXRlZFRyYWNlID0gdHJhY2VTZWxlY3RvcnMuaHlkcmF0ZVNwYW5zV2l0aFByb2Nlc3NlcyhnZW5lcmF0ZWRUcmFjZSk7XG5cbiAgaHlkcmF0ZWRUcmFjZS5zcGFucy5mb3JFYWNoKChzcGFuKSA9PlxuICAgIGV4cGVjdChnZXRTcGFuUHJvY2VzcyhzcGFuIGFzIFRyYWNlU3BhbikpLnRvQmUoZ2VuZXJhdGVkVHJhY2UucHJvY2Vzc2VzW2dldFNwYW5Qcm9jZXNzSWQoc3BhbildKVxuICApO1xufSk7XG5cbml0KCdnZXRUcmFjZVNwYW5zQXNNYXAoKSBzaG91bGQgcmV0dXJuIGEgbWFwIG9mIGFsbCBvZiB0aGUgc3BhbnMnLCAoKSA9PiB7XG4gIGNvbnN0IHNwYW5NYXAgPSB0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5zQXNNYXAoZ2VuZXJhdGVkVHJhY2UpO1xuICBbLi4uc3Bhbk1hcC5lbnRyaWVzKCldLmZvckVhY2goKHBhaXIpID0+IHtcbiAgICBleHBlY3QocGFpclsxXSkudG9FcXVhbChnZW5lcmF0ZWRUcmFjZS5zcGFucy5maW5kKChzcGFuKSA9PiBnZXRTcGFuSWQoc3BhbikgPT09IHBhaXJbMF0pKTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ2dldFRyYWNlU3Bhbklkc0FzVHJlZSgpJywgKCkgPT4ge1xuICBpdCgnYnVpbGRzIHRoZSB0cmVlIHByb3Blcmx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHRyZWUgPSB0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5JZHNBc1RyZWUoZ2VuZXJhdGVkVHJhY2UpO1xuICAgIGNvbnN0IHNwYW5NYXAgPSB0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5zQXNNYXAoZ2VuZXJhdGVkVHJhY2UpO1xuXG4gICAgdHJlZS53YWxrKCh2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgdW5kZWZpbmVkLCBub2RlOiBUcmVlTm9kZSkgPT4ge1xuICAgICAgY29uc3QgZXhwZWN0ZWRQYXJlbnRWYWx1ZSA9IHZhbHVlID09PSB0cmFjZVNlbGVjdG9ycy5UUkVFX1JPT1RfSUQgPyBudWxsIDogdmFsdWU7XG4gICAgICBub2RlLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkTm9kZSkgPT4ge1xuICAgICAgICBleHBlY3QoZ2V0U3BhblBhcmVudElkKHNwYW5NYXAuZ2V0KGNoaWxkTm9kZS52YWx1ZSkpKS50b0JlKGV4cGVjdGVkUGFyZW50VmFsdWUpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGl0KCcjMTE1IC0gaGFuZGxlcyBGT0xMT1dfRlJPTSByZWZzJywgKCkgPT4ge1xuICAgIGV4cGVjdCgoKSA9PiB0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZVNwYW5JZHNBc1RyZWUoZm9sbG93c0Zyb21SZWYpKS5ub3QudG9UaHJvdygpO1xuICB9KTtcbn0pO1xuXG5pdCgnZ2V0UGFyZW50U3BhbigpIHNob3VsZCByZXR1cm4gdGhlIHBhcmVudCBzcGFuIG9mIHRoZSB0cmVlJywgKCkgPT4ge1xuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZ2V0UGFyZW50U3BhbihnZW5lcmF0ZWRUcmFjZSkpLnRvQmUoXG4gICAgdHJhY2VTZWxlY3RvcnNcbiAgICAgIC5nZXRUcmFjZVNwYW5zQXNNYXAoZ2VuZXJhdGVkVHJhY2UpXG4gICAgICAuZ2V0KHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlU3Bhbklkc0FzVHJlZShnZW5lcmF0ZWRUcmFjZSkuY2hpbGRyZW5bMF0udmFsdWUpXG4gICk7XG59KTtcblxuaXQoJ2dldFBhcmVudFNwYW4oKSBzaG91bGQgcmV0dXJuIHRoZSBmaXJzdCBzcGFuIGlmIHRoZXJlIGFyZSBtdWx0aXBsZSBwYXJlbnRzJywgKCkgPT4ge1xuICBjb25zdCBpbml0aWFsVGltZXN0YW1wID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgKiAxMDAwO1xuICBjb25zdCBmaXJzdFNwYW4gPSB7XG4gICAgc3RhcnRUaW1lOiBpbml0aWFsVGltZXN0YW1wLFxuICAgIHNwYW5JRDogJ215LXNwYW4tMScsXG4gICAgcmVmZXJlbmNlczogW10sXG4gIH07XG5cbiAgY29uc3QgdHJhY2UgPSB7XG4gICAgc3BhbnM6IFtcbiAgICAgIHtcbiAgICAgICAgc3RhcnRUaW1lOiBpbml0aWFsVGltZXN0YW1wICsgMjAwMCxcbiAgICAgICAgc3BhbklEOiAnbXktc3Bhbi0zJyxcbiAgICAgICAgcmVmZXJlbmNlczogW10sXG4gICAgICB9LFxuICAgICAgZmlyc3RTcGFuLFxuICAgICAge1xuICAgICAgICBzdGFydFRpbWU6IGluaXRpYWxUaW1lc3RhbXAgKyAxMDAwLFxuICAgICAgICBzcGFuSUQ6ICdteS1zcGFuLTInLFxuICAgICAgICByZWZlcmVuY2VzOiBbXSxcbiAgICAgIH0sXG4gICAgXSxcbiAgfSBhcyB1bmtub3duIGFzIFRyYWNlUmVzcG9uc2U7XG5cbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFBhcmVudFNwYW4odHJhY2UpKS50b0JlKGZpcnN0U3Bhbik7XG59KTtcblxuaXQoJ2dldFRyYWNlTmFtZSgpIHNob3VsZCByZXR1cm4gYSBmb3JtYXR0ZWQgbmFtZSBmb3IgdGhlIGZpcnN0IHNwYW4nLCAoKSA9PiB7XG4gIGNvbnN0IGh5ZHJhdGVkVHJhY2UgPSB0cmFjZVNlbGVjdG9ycy5oeWRyYXRlU3BhbnNXaXRoUHJvY2Vzc2VzKGdlbmVyYXRlZFRyYWNlKTtcbiAgY29uc3QgcGFyZW50U3BhbiA9IHRyYWNlU2VsZWN0b3JzLmdldFBhcmVudFNwYW4oaHlkcmF0ZWRUcmFjZSk7XG5cbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlTmFtZShoeWRyYXRlZFRyYWNlKSkudG9CZShcbiAgICBgJHtnZXRTcGFuU2VydmljZU5hbWUocGFyZW50U3Bhbil9OiAke2dldFNwYW5OYW1lKHBhcmVudFNwYW4pfWBcbiAgKTtcbn0pO1xuXG5pdCgnZ2V0VHJhY2VTcGFuQ291bnQoKSBzaG91bGQgcmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIHNwYW5zIGFycmF5JywgKCkgPT4ge1xuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VTcGFuQ291bnQoZ2VuZXJhdGVkVHJhY2UpKS50b0JlKGdlbmVyYXRlZFRyYWNlLnNwYW5zLmxlbmd0aCk7XG59KTtcblxuaXQoJ2dldFRyYWNlRHVyYXRpb24oKSBzaG91bGQgcmV0dXJuIHRoZSBkdXJhdGlvbiBmb3IgdGhlIHNwYW4nLCAoKSA9PiB7XG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZUR1cmF0aW9uKGdlbmVyYXRlZFRyYWNlKSkudG9CZShnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXS5kdXJhdGlvbik7XG59KTtcblxuaXQoJ2dldFRyYWNlVGltZXN0YW1wKCkgc2hvdWxkIHJldHVybiB0aGUgZmlyc3QgdGltZXN0YW1wIGZvciB0aGUgY29udmVudGlvbmFsIHRyYWNlJywgKCkgPT4ge1xuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VUaW1lc3RhbXAoZ2VuZXJhdGVkVHJhY2UpKS50b0JlKGdlbmVyYXRlZFRyYWNlLnNwYW5zWzBdLnN0YXJ0VGltZSk7XG59KTtcblxuaXQoJ2dldFRyYWNlRGVwdGgoKSBzaG91bGQgZGV0ZXJtaW5lIHRoZSB0b3RhbCBkZXB0aCBvZiB0aGUgdHJhY2UgdHJlZScsICgpID0+IHtcbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlRGVwdGgoZ2VuZXJhdGVkVHJhY2UpKS50b0JlKFxuICAgIHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlU3Bhbklkc0FzVHJlZShnZW5lcmF0ZWRUcmFjZSkuZGVwdGggLSAxXG4gICk7XG59KTtcblxuaXQoJ2dldFNwYW5EZXB0aEZvclRyYWNlKCkgc2hvdWxkIGRldGVybWluZSB0aGUgZGVwdGggb2YgYSBnaXZlbiBzcGFuIGluIHRoZSBwYXJlbnQnLCAoKSA9PiB7XG4gIGZ1bmN0aW9uIHRlc3REZXB0aENhbGMoc3BhbjogVHJhY2VTcGFuRGF0YSkge1xuICAgIGxldCBkZXB0aCA9IDI7XG4gICAgbGV0IGN1cnJlbnRJZCA9IGdldFNwYW5QYXJlbnRJZChzcGFuKTtcblxuICAgIGNvbnN0IGZpbmRDdXJyZW50U3BhbkJ5SWQgPSAoaXRlbTogVHJhY2VTcGFuRGF0YSkgPT4gZ2V0U3BhbklkKGl0ZW0pID09PSBjdXJyZW50SWQ7XG4gICAgd2hpbGUgKGN1cnJlbnRJZCAhPT0gZ2V0U3BhbklkKGdlbmVyYXRlZFRyYWNlLnNwYW5zWzBdKSkge1xuICAgICAgZGVwdGgrKztcbiAgICAgIGN1cnJlbnRJZCA9IGdldFNwYW5QYXJlbnRJZChnZW5lcmF0ZWRUcmFjZS5zcGFucy5maW5kKGZpbmRDdXJyZW50U3BhbkJ5SWQpISk7XG4gICAgfVxuXG4gICAgLy8gY29uc29sZS5sb2coJ2h5cG90aGV0aWNhbCBkZXB0aCcsIGRlcHRoKTtcblxuICAgIGV4cGVjdChcbiAgICAgIHRyYWNlU2VsZWN0b3JzLmdldFNwYW5EZXB0aEZvclRyYWNlKHtcbiAgICAgICAgdHJhY2U6IGdlbmVyYXRlZFRyYWNlLFxuICAgICAgICBzcGFuLFxuICAgICAgfSlcbiAgICApLnRvQmUoZGVwdGgpO1xuICB9XG5cbiAgLy8gdGVzdCBkZXB0aCBjYWxjdWxhdGlvbnMgZm9yIGEgZmV3IHJhbmRvbSBzcGFuc1xuICB0ZXN0RGVwdGhDYWxjKGdlbmVyYXRlZFRyYWNlLnNwYW5zWzFdKTtcbiAgdGVzdERlcHRoQ2FsYyhnZW5lcmF0ZWRUcmFjZS5zcGFuc1tNYXRoLmZsb29yKGdlbmVyYXRlZFRyYWNlLnNwYW5zLmxlbmd0aCAvIDIpXSk7XG4gIHRlc3REZXB0aENhbGMoZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbTWF0aC5mbG9vcihnZW5lcmF0ZWRUcmFjZS5zcGFucy5sZW5ndGggLyA0KV0pO1xuICB0ZXN0RGVwdGhDYWxjKGdlbmVyYXRlZFRyYWNlLnNwYW5zW01hdGguZmxvb3IoZ2VuZXJhdGVkVHJhY2Uuc3BhbnMubGVuZ3RoICogMC43NSldKTtcbn0pO1xuXG5pdCgnZ2V0VHJhY2VTZXJ2aWNlcygpIHNob3VsZCByZXR1cm4gYW4gdW5pcXVlIGFycmF5IG9mIGFsbCBzZXJ2aWNlcyBpbiB0aGUgdHJhY2UnLCAoKSA9PiB7XG4gIGNvbnN0IHN2Y3MgPSBbLi4udHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VTZXJ2aWNlcyhnZW5lcmF0ZWRUcmFjZSldLnNvcnQoKTtcbiAgY29uc3Qgc2V0ID0gbmV3IFNldChfdmFsdWVzKGdlbmVyYXRlZFRyYWNlLnByb2Nlc3NlcykubWFwKCh2KSA9PiB2LnNlcnZpY2VOYW1lKSk7XG4gIGNvbnN0IHNldFN2Y3MgPSBbLi4uc2V0LnZhbHVlcygpXS5zb3J0KCk7XG4gIGV4cGVjdChzdmNzKS50b0VxdWFsKHNldFN2Y3MpO1xufSk7XG5cbml0KCdnZXRUcmFjZVNlcnZpY2VDb3VudCgpIHNob3VsZCByZXR1cm4gdGhlIGxlbmd0aCBvZiB0aGUgc2VydmljZSBsaXN0JywgKCkgPT4ge1xuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZ2V0VHJhY2VTZXJ2aWNlQ291bnQoZ2VuZXJhdGVkVHJhY2UpKS50b0JlKFxuICAgIE9iamVjdC52YWx1ZXMoZ2VuZXJhdGVkVHJhY2UucHJvY2Vzc2VzKS5yZWR1Y2UoKHJlc3VsdHMsIHByb2Nlc3MpID0+IHJlc3VsdHMuYWRkKHByb2Nlc3Muc2VydmljZU5hbWUpLCBuZXcgU2V0KCkpXG4gICAgICAuc2l6ZVxuICApO1xufSk7XG5cbml0KCdmb3JtYXREdXJhdGlvbkZvclVuaXQoKSBzaG91bGQgdXNlIHRoZSBmb3JtYXR0ZXJzIHRvIHJldHVybiB0aGUgcHJvcGVyIHZhbHVlJywgKCkgPT4ge1xuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZm9ybWF0RHVyYXRpb25Gb3JVbml0KHsgZHVyYXRpb246IDMwMjAwMCwgdW5pdDogJ21zJyB9KSkudG9CZSgnMzAybXMnKTtcblxuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZm9ybWF0RHVyYXRpb25Gb3JVbml0KHsgZHVyYXRpb246IDEzMDIwMDAsIHVuaXQ6ICdtcycgfSkpLnRvQmUoJzEzMDJtcycpO1xuXG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5mb3JtYXREdXJhdGlvbkZvclVuaXQoeyBkdXJhdGlvbjogMTMwMjAwMCwgdW5pdDogJ3MnIH0pKS50b0JlKCcxLjMwMnMnKTtcblxuICBleHBlY3QodHJhY2VTZWxlY3RvcnMuZm9ybWF0RHVyYXRpb25Gb3JVbml0KHsgZHVyYXRpb246IDkwMDAwLCB1bml0OiAncycgfSkpLnRvQmUoJzAuMDlzJyk7XG59KTtcblxuaXQoJ2Zvcm1hdER1cmF0aW9uRm9yVHJhY2UoKSBzaG91bGQgcmV0dXJuIGEgbXMgdmFsdWUgZm9yIHRyYWNlcyBzaG9ydGVyIHRoYW4gYSBzZWNvbmQnLCAoKSA9PiB7XG4gIGNvbnN0IGZpcnN0U3BhbiA9IGdlbmVyYXRlZFRyYWNlLnNwYW5zWzBdO1xuICBmaXJzdFNwYW4uZHVyYXRpb24gPSA2MDAwMDA7XG4gIGV4cGVjdChcbiAgICB0cmFjZVNlbGVjdG9ycy5mb3JtYXREdXJhdGlvbkZvclRyYWNlKHtcbiAgICAgIHRyYWNlOiB7XG4gICAgICAgIC4uLmdlbmVyYXRlZFRyYWNlLFxuICAgICAgICBzcGFuczogW2ZpcnN0U3Bhbl0sXG4gICAgICB9LFxuICAgICAgZHVyYXRpb246IDMwMjAwMCxcbiAgICB9KVxuICApLnRvQmUoJzMwMm1zJyk7XG59KTtcblxuaXQoJ2Zvcm1hdER1cmF0aW9uRm9yVHJhY2UoKSBzaG91bGQgcmV0dXJuIGEgcyB2YWx1ZSBmb3IgdHJhY2VzIGxvbmdlciB0aGFuIGEgc2Vjb25kJywgKCkgPT4ge1xuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZm9ybWF0RHVyYXRpb25Gb3JUcmFjZSh7XG4gICAgICB0cmFjZToge1xuICAgICAgICAuLi5nZW5lcmF0ZWRUcmFjZSxcbiAgICAgICAgc3BhbnM6IGdlbmVyYXRlZFRyYWNlLnNwYW5zLmNvbmNhdChbXG4gICAgICAgICAge1xuICAgICAgICAgICAgLi4uZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMF0sXG4gICAgICAgICAgICBkdXJhdGlvbjogMTAwMDAwMCxcbiAgICAgICAgICB9LFxuICAgICAgICBdKSxcbiAgICAgIH0sXG4gICAgICBkdXJhdGlvbjogMzAyMDAwLFxuICAgIH0pXG4gICkudG9CZSgnMC4zMDJzJyk7XG5cbiAgZXhwZWN0KFxuICAgIHRyYWNlU2VsZWN0b3JzLmZvcm1hdER1cmF0aW9uRm9yVHJhY2Uoe1xuICAgICAgdHJhY2U6IHtcbiAgICAgICAgLi4uZ2VuZXJhdGVkVHJhY2UsXG4gICAgICAgIHNwYW5zOiBnZW5lcmF0ZWRUcmFjZS5zcGFucy5jb25jYXQoW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIC4uLmdlbmVyYXRlZFRyYWNlLnNwYW5zWzBdLFxuICAgICAgICAgICAgZHVyYXRpb246IDEyMDAwMDAsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSksXG4gICAgICB9LFxuICAgICAgZHVyYXRpb246IDMwMjAwMCxcbiAgICB9KVxuICApLnRvQmUoJzAuMzAycycpO1xufSk7XG5cbml0KCdnZXRTb3J0ZWRTcGFucygpIHNob3VsZCBzb3J0IHNwYW5zIGdpdmVuIGEgc29ydCBvYmplY3QnLCAoKSA9PiB7XG4gIGV4cGVjdChcbiAgICB0cmFjZVNlbGVjdG9ycy5nZXRTb3J0ZWRTcGFucyh7XG4gICAgICB0cmFjZTogZ2VuZXJhdGVkVHJhY2UsXG4gICAgICBzcGFuczogZ2VuZXJhdGVkVHJhY2Uuc3BhbnMsXG4gICAgICBzb3J0OiB7XG4gICAgICAgIGRpcjogMSxcbiAgICAgICAgY29tcGFyYXRvcjogbnVtYmVyU29ydENvbXBhcmF0b3IsXG4gICAgICAgIHNlbGVjdG9yOiBnZXRTcGFuVGltZXN0YW1wLFxuICAgICAgfSxcbiAgICB9KVxuICApLnRvRXF1YWwoWy4uLmdlbmVyYXRlZFRyYWNlLnNwYW5zXS5zb3J0KChzcGFuQSwgc3BhbkIpID0+IHNwYW5BLnN0YXJ0VGltZSAtIHNwYW5CLnN0YXJ0VGltZSkpO1xuXG4gIGV4cGVjdChcbiAgICB0cmFjZVNlbGVjdG9ycy5nZXRTb3J0ZWRTcGFucyh7XG4gICAgICB0cmFjZTogZ2VuZXJhdGVkVHJhY2UsXG4gICAgICBzcGFuczogZ2VuZXJhdGVkVHJhY2Uuc3BhbnMsXG4gICAgICBzb3J0OiB7XG4gICAgICAgIGRpcjogLTEsXG4gICAgICAgIGNvbXBhcmF0b3I6IG51bWJlclNvcnRDb21wYXJhdG9yLFxuICAgICAgICBzZWxlY3RvcjogZ2V0U3BhblRpbWVzdGFtcCxcbiAgICAgIH0sXG4gICAgfSlcbiAgKS50b0VxdWFsKFsuLi5nZW5lcmF0ZWRUcmFjZS5zcGFuc10uc29ydCgoc3BhbkEsIHNwYW5CKSA9PiBzcGFuQi5zdGFydFRpbWUgLSBzcGFuQS5zdGFydFRpbWUpKTtcbn0pO1xuXG5pdCgnZ2V0VHJlZVNpemVGb3JUcmFjZVNwYW4oKSBzaG91bGQgcmV0dXJuIHRoZSBzaXplIGZvciB0aGUgcGFyZW50IHNwYW4nLCAoKSA9PiB7XG4gIGV4cGVjdChcbiAgICB0cmFjZVNlbGVjdG9ycy5nZXRUcmVlU2l6ZUZvclRyYWNlU3Bhbih7XG4gICAgICB0cmFjZTogZ2VuZXJhdGVkVHJhY2UsXG4gICAgICBzcGFuOiBnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXSxcbiAgICB9KVxuICApLnRvQmUoZ2VuZXJhdGVkVHJhY2Uuc3BhbnMubGVuZ3RoIC0gMSk7XG59KTtcblxuaXQoJ2dldFRyZWVTaXplRm9yVHJhY2VTcGFuKCkgc2hvdWxkIHJldHVybiB0aGUgc2l6ZSBmb3IgYSBjaGlsZCBzcGFuJywgKCkgPT4ge1xuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZ2V0VHJlZVNpemVGb3JUcmFjZVNwYW4oe1xuICAgICAgdHJhY2U6IGdlbmVyYXRlZFRyYWNlLFxuICAgICAgc3BhbjogZ2VuZXJhdGVkVHJhY2Uuc3BhbnNbMV0sXG4gICAgfSlcbiAgKS50b0JlKHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlU3Bhbklkc0FzVHJlZShnZW5lcmF0ZWRUcmFjZSkuZmluZChnZW5lcmF0ZWRUcmFjZS5zcGFuc1sxXS5zcGFuSUQpIS5zaXplIC0gMSk7XG59KTtcblxuaXQoJ2dldFRyZWVTaXplRm9yVHJhY2VTcGFuKCkgc2hvdWxkIHJldHVybiAtMSBmb3IgYW4gYWJzZW50IHNwYW4nLCAoKSA9PiB7XG4gIGNvbnN0IGFic2VudFNwYW4gPSBnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXTtcbiAgYWJzZW50U3Bhbi5zcGFuSUQgPSAnd2hhdGV2ZXInO1xuXG4gIGV4cGVjdChcbiAgICB0cmFjZVNlbGVjdG9ycy5nZXRUcmVlU2l6ZUZvclRyYWNlU3Bhbih7XG4gICAgICB0cmFjZTogZ2VuZXJhdGVkVHJhY2UsXG4gICAgICBzcGFuOiBhYnNlbnRTcGFuLFxuICAgIH0pXG4gICkudG9CZSgtMSk7XG59KTtcblxuaXQoJ2dldFRyYWNlTmFtZSgpIHNob3VsZCByZXR1cm4gdGhlIHRyYWNlIG5hbWUgYmFzZWQgb24gdGhlIHBhcmVudFNwYW4nLCAoKSA9PiB7XG4gIGNvbnN0IHNlcnZpY2VOYW1lID0gZ2VuZXJhdGVkVHJhY2UucHJvY2Vzc2VzW2dlbmVyYXRlZFRyYWNlLnNwYW5zWzBdLnByb2Nlc3NJRF0uc2VydmljZU5hbWU7XG4gIGNvbnN0IG9wZXJhdGlvbk5hbWUgPSBnZW5lcmF0ZWRUcmFjZS5zcGFuc1swXS5vcGVyYXRpb25OYW1lO1xuXG4gIGV4cGVjdCh0cmFjZVNlbGVjdG9ycy5nZXRUcmFjZU5hbWUoZ2VuZXJhdGVkVHJhY2UpKS50b0JlKGAke3NlcnZpY2VOYW1lfTogJHtvcGVyYXRpb25OYW1lfWApO1xufSk7XG5cbml0KCdvbWl0Q29sbGFwc2VkU3BhbnMoKSBzaG91bGQgZmlsdGVyIG91dCBjb2xsYXBzZWQgc3BhbnMnLCAoKSA9PiB7XG4gIGNvbnN0IHNwYW4gPSBnZW5lcmF0ZWRUcmFjZS5zcGFuc1sxXTtcbiAgY29uc3Qgc2l6ZSA9IHRyYWNlU2VsZWN0b3JzLmdldFRyYWNlU3Bhbklkc0FzVHJlZShnZW5lcmF0ZWRUcmFjZSkuZmluZChzcGFuLnNwYW5JRCkhLnNpemUgLSAxO1xuXG4gIGV4cGVjdChcbiAgICB0cmFjZVNlbGVjdG9ycy5vbWl0Q29sbGFwc2VkU3BhbnMoe1xuICAgICAgdHJhY2U6IGdlbmVyYXRlZFRyYWNlLFxuICAgICAgc3BhbnM6IGdlbmVyYXRlZFRyYWNlLnNwYW5zLFxuICAgICAgY29sbGFwc2VkOiBbc3Bhbi5zcGFuSURdLFxuICAgIH0pLmxlbmd0aFxuICApLnRvQmUoZ2VuZXJhdGVkVHJhY2Uuc3BhbnMubGVuZ3RoIC0gc2l6ZSk7XG59KTtcblxuaXQoJ2dldFRpY2tzRm9yVHJhY2UoKSBzaG91bGQgcmV0dXJuIGEgbGlzdCBvZiB0aWNrcyBnaXZlbiBpbnRlcnZhbCBwYXJhbWV0ZXJzJywgKCkgPT4ge1xuICBjb25zdCB0cmFjZSA9IGdlbmVyYXRlZFRyYWNlO1xuICBjb25zdCB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAqIDEwMDA7XG5cbiAgdHJhY2Uuc3BhbnMuZm9yRWFjaCgoc3BhbikgPT4ge1xuICAgIHNwYW4uZHVyYXRpb24gPSAzMDAwMDAwO1xuICAgIHNwYW4uc3RhcnRUaW1lID0gdGltZXN0YW1wO1xuICB9KTtcblxuICBleHBlY3QoXG4gICAgdHJhY2VTZWxlY3RvcnMuZ2V0VGlja3NGb3JUcmFjZSh7XG4gICAgICB0cmFjZSxcbiAgICAgIGludGVydmFsOiAzLFxuICAgICAgd2lkdGg6IDEwLFxuICAgIH0pXG4gICkudG9FcXVhbChbXG4gICAgeyB0aW1lc3RhbXAsIHdpZHRoOiAxMCB9LFxuICAgIHsgdGltZXN0YW1wOiB0aW1lc3RhbXAgKyAxMDAwMDAwLCB3aWR0aDogMTAgfSxcbiAgICB7IHRpbWVzdGFtcDogdGltZXN0YW1wICsgMjAwMDAwMCwgd2lkdGg6IDEwIH0sXG4gICAgeyB0aW1lc3RhbXA6IHRpbWVzdGFtcCArIDMwMDAwMDAsIHdpZHRoOiAxMCB9LFxuICBdKTtcbn0pO1xuXG5pdCgnZ2V0VGlja3NGb3JUcmFjZSgpIHNob3VsZCB1c2UgZGVmYXVsdHMnLCAoKSA9PiB7XG4gIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpICogMTAwMDtcbiAgY29uc3QgdHJhY2UgPSB0cmFjZUdlbmVyYXRvci50cmFjZSh7IG51bWJlck9mU3BhbnM6IDEgfSk7XG5cbiAgdHJhY2Uuc3BhbnMgPSBbXG4gICAge1xuICAgICAgdHJhY2VJRDogJzUwMzEyMzNhLWQwYjUtNWQ0MS05YjRiLTRjMDcyYmNmNTAyMCcsXG4gICAgICBwcm9jZXNzSUQ6ICdiNWY0ZTBmZi03MzE4LTUwMTctYTNmMy05YzdiNDIzYTgyYWEnLFxuICAgICAgc3BhbklEOiAnZTg3MTc3MWYtZjFiNC01NGFmLTllOWQtODI2MjU5YzI5MTVlJyxcbiAgICAgIGZsYWdzOiAwLFxuICAgICAgbG9nczogW10sXG4gICAgICBvcGVyYXRpb25OYW1lOiAnUE9TVCcsXG4gICAgICBzdGFydFRpbWU6IHRpbWVzdGFtcCxcbiAgICAgIGR1cmF0aW9uOiA0MDAwMDAwLFxuICAgIH0sXG4gIF07XG5cbiAgZXhwZWN0KHRyYWNlU2VsZWN0b3JzLmdldFRpY2tzRm9yVHJhY2UoeyB0cmFjZSB9KSkudG9FcXVhbChbXG4gICAgeyB0aW1lc3RhbXAsIHdpZHRoOiB0cmFjZVNlbGVjdG9ycy5ERUZBVUxUX1RJQ0tfV0lEVEggfSxcbiAgICB7XG4gICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcCArIDEwMDAwMDAsXG4gICAgICB3aWR0aDogdHJhY2VTZWxlY3RvcnMuREVGQVVMVF9USUNLX1dJRFRILFxuICAgIH0sXG4gICAge1xuICAgICAgdGltZXN0YW1wOiB0aW1lc3RhbXAgKyAyMDAwMDAwLFxuICAgICAgd2lkdGg6IHRyYWNlU2VsZWN0b3JzLkRFRkFVTFRfVElDS19XSURUSCxcbiAgICB9LFxuICAgIHtcbiAgICAgIHRpbWVzdGFtcDogdGltZXN0YW1wICsgMzAwMDAwMCxcbiAgICAgIHdpZHRoOiB0cmFjZVNlbGVjdG9ycy5ERUZBVUxUX1RJQ0tfV0lEVEgsXG4gICAgfSxcbiAgICB7XG4gICAgICB0aW1lc3RhbXA6IHRpbWVzdGFtcCArIDQwMDAwMDAsXG4gICAgICB3aWR0aDogdHJhY2VTZWxlY3RvcnMuREVGQVVMVF9USUNLX1dJRFRILFxuICAgIH0sXG4gIF0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTQSxNQUFNLElBQUlDLE9BQU8sUUFBUSxRQUFRO0FBRzFDLE9BQU9DLGNBQWMsTUFBTSwwQkFBMEI7QUFFckQsU0FBU0Msb0JBQW9CLFFBQVEsZUFBZTtBQUVwRCxTQUNFQyxTQUFTLEVBQ1RDLFdBQVcsRUFDWEMsZUFBZSxFQUNmQyxjQUFjLEVBQ2RDLGdCQUFnQixFQUNoQkMsa0JBQWtCLEVBQ2xCQyxnQkFBZ0IsUUFDWCxRQUFRO0FBQ2YsT0FBTyxLQUFLQyxjQUFjLE1BQU0sU0FBUztBQUN6QyxTQUFTQyxjQUFjLFFBQVEsaUJBQWlCO0FBRWhELElBQU1DLGNBQTZCLEdBQUdYLGNBQWMsQ0FBQ1ksS0FBSyxDQUFDO0VBQUVDLGFBQWEsRUFBRTtBQUFHLENBQUMsQ0FBQztBQUVqRkMsRUFBRSxDQUFDLHdDQUF3QyxFQUFFLFlBQU07RUFDakRDLE1BQU0sQ0FBQ04sY0FBYyxDQUFDTyxVQUFVLENBQUNMLGNBQWMsQ0FBQyxDQUFDLENBQUNNLElBQUksQ0FBQ04sY0FBYyxDQUFDTyxPQUFPLENBQUM7QUFDaEYsQ0FBQyxDQUFDO0FBRUZKLEVBQUUsQ0FBQyxpRkFBaUYsRUFBRSxZQUFNO0VBQzFGLElBQU1LLGFBQWEsR0FBR1YsY0FBYyxDQUFDVyx5QkFBeUIsQ0FBQ1QsY0FBYyxDQUFDO0VBRTlFUSxhQUFhLENBQUNFLEtBQUssQ0FBQ0MsT0FBTyxDQUFDLFVBQUNDLElBQUk7SUFBQSxPQUMvQlIsTUFBTSxDQUFDVixjQUFjLENBQUNrQixJQUFpQixDQUFDLENBQUMsQ0FBQ04sSUFBSSxDQUFDTixjQUFjLENBQUNhLFNBQVMsQ0FBQ2xCLGdCQUFnQixDQUFDaUIsSUFBSSxDQUFDLENBQUMsQ0FBQztFQUFBLENBQ2xHLENBQUM7QUFDSCxDQUFDLENBQUM7QUFFRlQsRUFBRSxDQUFDLDhEQUE4RCxFQUFFLFlBQU07RUFDdkUsSUFBTVcsT0FBTyxHQUFHaEIsY0FBYyxDQUFDaUIsa0JBQWtCLENBQUNmLGNBQWMsQ0FBQztFQUNqRSxHQUFBZ0IsTUFBQSxDQUFJRixPQUFPLENBQUNHLE9BQU8sQ0FBQyxDQUFDLEVBQUVOLE9BQU8sQ0FBQyxVQUFDTyxJQUFJLEVBQUs7SUFDdkNkLE1BQU0sQ0FBQ2MsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQ25CLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDVSxJQUFJLENBQUMsVUFBQ1IsSUFBSTtNQUFBLE9BQUtyQixTQUFTLENBQUNxQixJQUFJLENBQUMsS0FBS00sSUFBSSxDQUFDLENBQUMsQ0FBQztJQUFBLEVBQUMsQ0FBQztFQUMzRixDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRkcsUUFBUSxDQUFDLHlCQUF5QixFQUFFLFlBQU07RUFDeENsQixFQUFFLENBQUMsMEJBQTBCLEVBQUUsWUFBTTtJQUNuQyxJQUFNbUIsSUFBSSxHQUFHeEIsY0FBYyxDQUFDeUIscUJBQXFCLENBQUN2QixjQUFjLENBQUM7SUFDakUsSUFBTWMsT0FBTyxHQUFHaEIsY0FBYyxDQUFDaUIsa0JBQWtCLENBQUNmLGNBQWMsQ0FBQztJQUVqRXNCLElBQUksQ0FBQ0UsSUFBSSxDQUFDLFVBQUNDLEtBQWtDLEVBQUVDLElBQWMsRUFBSztNQUNoRSxJQUFNQyxtQkFBbUIsR0FBR0YsS0FBSyxLQUFLM0IsY0FBYyxDQUFDOEIsWUFBWSxHQUFHLElBQUksR0FBR0gsS0FBSztNQUNoRkMsSUFBSSxDQUFDRyxRQUFRLENBQUNsQixPQUFPLENBQUMsVUFBQ21CLFNBQVMsRUFBSztRQUNuQzFCLE1BQU0sQ0FBQ1gsZUFBZSxDQUFDcUIsT0FBTyxDQUFDaUIsR0FBRyxDQUFDRCxTQUFTLENBQUNMLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQ25CLElBQUksQ0FBQ3FCLG1CQUFtQixDQUFDO01BQ2pGLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztFQUVGeEIsRUFBRSxDQUFDLGlDQUFpQyxFQUFFLFlBQU07SUFDMUNDLE1BQU0sQ0FBQztNQUFBLE9BQU1OLGNBQWMsQ0FBQ3lCLHFCQUFxQixDQUFDeEIsY0FBYyxDQUFDO0lBQUEsRUFBQyxDQUFDaUMsR0FBRyxDQUFDQyxPQUFPLENBQUMsQ0FBQztFQUNsRixDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRjlCLEVBQUUsQ0FBQywyREFBMkQsRUFBRSxZQUFNO0VBQ3BFQyxNQUFNLENBQUNOLGNBQWMsQ0FBQ29DLGFBQWEsQ0FBQ2xDLGNBQWMsQ0FBQyxDQUFDLENBQUNNLElBQUksQ0FDdkRSLGNBQWMsQ0FDWGlCLGtCQUFrQixDQUFDZixjQUFjLENBQUMsQ0FDbEMrQixHQUFHLENBQUNqQyxjQUFjLENBQUN5QixxQkFBcUIsQ0FBQ3ZCLGNBQWMsQ0FBQyxDQUFDNkIsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDSixLQUFLLENBQy9FLENBQUM7QUFDSCxDQUFDLENBQUM7QUFFRnRCLEVBQUUsQ0FBQyw0RUFBNEUsRUFBRSxZQUFNO0VBQ3JGLElBQU1nQyxnQkFBZ0IsR0FBRyxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxPQUFPLENBQUMsQ0FBQyxHQUFHLElBQUk7RUFDcEQsSUFBTUMsU0FBUyxHQUFHO0lBQ2hCQyxTQUFTLEVBQUVKLGdCQUFnQjtJQUMzQkssTUFBTSxFQUFFLFdBQVc7SUFDbkJDLFVBQVUsRUFBRTtFQUNkLENBQUM7RUFFRCxJQUFNeEMsS0FBSyxHQUFHO0lBQ1pTLEtBQUssRUFBRSxDQUNMO01BQ0U2QixTQUFTLEVBQUVKLGdCQUFnQixHQUFHLElBQUk7TUFDbENLLE1BQU0sRUFBRSxXQUFXO01BQ25CQyxVQUFVLEVBQUU7SUFDZCxDQUFDLEVBQ0RILFNBQVMsRUFDVDtNQUNFQyxTQUFTLEVBQUVKLGdCQUFnQixHQUFHLElBQUk7TUFDbENLLE1BQU0sRUFBRSxXQUFXO01BQ25CQyxVQUFVLEVBQUU7SUFDZCxDQUFDO0VBRUwsQ0FBNkI7RUFFN0JyQyxNQUFNLENBQUNOLGNBQWMsQ0FBQ29DLGFBQWEsQ0FBQ2pDLEtBQUssQ0FBQyxDQUFDLENBQUNLLElBQUksQ0FBQ2dDLFNBQVMsQ0FBQztBQUM3RCxDQUFDLENBQUM7QUFFRm5DLEVBQUUsQ0FBQyxrRUFBa0UsRUFBRSxZQUFNO0VBQzNFLElBQU1LLGFBQWEsR0FBR1YsY0FBYyxDQUFDVyx5QkFBeUIsQ0FBQ1QsY0FBYyxDQUFDO0VBQzlFLElBQU0wQyxVQUFVLEdBQUc1QyxjQUFjLENBQUNvQyxhQUFhLENBQUMxQixhQUFhLENBQUM7RUFFOURKLE1BQU0sQ0FBQ04sY0FBYyxDQUFDNkMsWUFBWSxDQUFDbkMsYUFBYSxDQUFDLENBQUMsQ0FBQ0YsSUFBSSxDQUNsRFYsa0JBQWtCLENBQUM4QyxVQUFVLENBQUMsVUFBS2xELFdBQVcsQ0FBQ2tELFVBQVUsQ0FDOUQsQ0FBQztBQUNILENBQUMsQ0FBQztBQUVGdkMsRUFBRSxDQUFDLGlFQUFpRSxFQUFFLFlBQU07RUFDMUVDLE1BQU0sQ0FBQ04sY0FBYyxDQUFDOEMsaUJBQWlCLENBQUM1QyxjQUFjLENBQUMsQ0FBQyxDQUFDTSxJQUFJLENBQUNOLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDbUMsTUFBTSxDQUFDO0FBQzVGLENBQUMsQ0FBQztBQUVGMUMsRUFBRSxDQUFDLDREQUE0RCxFQUFFLFlBQU07RUFDckVDLE1BQU0sQ0FBQ04sY0FBYyxDQUFDZ0QsZ0JBQWdCLENBQUM5QyxjQUFjLENBQUMsQ0FBQyxDQUFDTSxJQUFJLENBQUNOLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDcUMsUUFBUSxDQUFDO0FBQ2hHLENBQUMsQ0FBQztBQUVGNUMsRUFBRSxDQUFDLGtGQUFrRixFQUFFLFlBQU07RUFDM0ZDLE1BQU0sQ0FBQ04sY0FBYyxDQUFDa0QsaUJBQWlCLENBQUNoRCxjQUFjLENBQUMsQ0FBQyxDQUFDTSxJQUFJLENBQUNOLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDNkIsU0FBUyxDQUFDO0FBQ2xHLENBQUMsQ0FBQztBQUVGcEMsRUFBRSxDQUFDLG9FQUFvRSxFQUFFLFlBQU07RUFDN0VDLE1BQU0sQ0FBQ04sY0FBYyxDQUFDbUQsYUFBYSxDQUFDakQsY0FBYyxDQUFDLENBQUMsQ0FBQ00sSUFBSSxDQUN2RFIsY0FBYyxDQUFDeUIscUJBQXFCLENBQUN2QixjQUFjLENBQUMsQ0FBQ2tELEtBQUssR0FBRyxDQUMvRCxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUYvQyxFQUFFLENBQUMsaUZBQWlGLEVBQUUsWUFBTTtFQUMxRixTQUFTZ0QsYUFBYUEsQ0FBQ3ZDLElBQW1CLEVBQUU7SUFDMUMsSUFBSXNDLEtBQUssR0FBRyxDQUFDO0lBQ2IsSUFBSUUsU0FBUyxHQUFHM0QsZUFBZSxDQUFDbUIsSUFBSSxDQUFDO0lBRXJDLElBQU15QyxtQkFBbUIsR0FBRyxTQUF0QkEsbUJBQW1CQSxDQUFJQyxJQUFtQjtNQUFBLE9BQUsvRCxTQUFTLENBQUMrRCxJQUFJLENBQUMsS0FBS0YsU0FBUztJQUFBO0lBQ2xGLE9BQU9BLFNBQVMsS0FBSzdELFNBQVMsQ0FBQ1MsY0FBYyxDQUFDVSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtNQUN2RHdDLEtBQUssRUFBRTtNQUNQRSxTQUFTLEdBQUczRCxlQUFlLENBQUNPLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDVSxJQUFJLENBQUNpQyxtQkFBbUIsQ0FBRSxDQUFDO0lBQzlFOztJQUVBOztJQUVBakQsTUFBTSxDQUNKTixjQUFjLENBQUN5RCxvQkFBb0IsQ0FBQztNQUNsQ3RELEtBQUssRUFBRUQsY0FBYztNQUNyQlksSUFBSSxFQUFKQTtJQUNGLENBQUMsQ0FDSCxDQUFDLENBQUNOLElBQUksQ0FBQzRDLEtBQUssQ0FBQztFQUNmOztFQUVBO0VBQ0FDLGFBQWEsQ0FBQ25ELGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQ3RDeUMsYUFBYSxDQUFDbkQsY0FBYyxDQUFDVSxLQUFLLENBQUM4QyxJQUFJLENBQUNDLEtBQUssQ0FBQ3pELGNBQWMsQ0FBQ1UsS0FBSyxDQUFDbUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7RUFDaEZNLGFBQWEsQ0FBQ25ELGNBQWMsQ0FBQ1UsS0FBSyxDQUFDOEMsSUFBSSxDQUFDQyxLQUFLLENBQUN6RCxjQUFjLENBQUNVLEtBQUssQ0FBQ21DLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0VBQ2hGTSxhQUFhLENBQUNuRCxjQUFjLENBQUNVLEtBQUssQ0FBQzhDLElBQUksQ0FBQ0MsS0FBSyxDQUFDekQsY0FBYyxDQUFDVSxLQUFLLENBQUNtQyxNQUFNLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUNyRixDQUFDLENBQUM7QUFFRjFDLEVBQUUsQ0FBQywrRUFBK0UsRUFBRSxZQUFNO0VBQ3hGLElBQU11RCxJQUFJLEdBQUcsR0FBQTFDLE1BQUEsQ0FBSWxCLGNBQWMsQ0FBQzZELGdCQUFnQixDQUFDM0QsY0FBYyxDQUFDLEVBQUU0RCxJQUFJLENBQUMsQ0FBQztFQUN4RSxJQUFNQyxHQUFHLEdBQUcsSUFBSUMsR0FBRyxDQUFDMUUsT0FBTyxDQUFDWSxjQUFjLENBQUNhLFNBQVMsQ0FBQyxDQUFDa0QsR0FBRyxDQUFDLFVBQUNDLENBQUM7SUFBQSxPQUFLQSxDQUFDLENBQUNDLFdBQVc7RUFBQSxFQUFDLENBQUM7RUFDaEYsSUFBTUMsT0FBTyxHQUFHLEdBQUFsRCxNQUFBLENBQUk2QyxHQUFHLENBQUMxRSxNQUFNLENBQUMsQ0FBQyxFQUFFeUUsSUFBSSxDQUFDLENBQUM7RUFDeEN4RCxNQUFNLENBQUNzRCxJQUFJLENBQUMsQ0FBQ3ZDLE9BQU8sQ0FBQytDLE9BQU8sQ0FBQztBQUMvQixDQUFDLENBQUM7QUFFRi9ELEVBQUUsQ0FBQyxxRUFBcUUsRUFBRSxZQUFNO0VBQzlFQyxNQUFNLENBQUNOLGNBQWMsQ0FBQ3FFLG9CQUFvQixDQUFDbkUsY0FBYyxDQUFDLENBQUMsQ0FBQ00sSUFBSSxDQUM5RDhELE1BQU0sQ0FBQ2pGLE1BQU0sQ0FBQ2EsY0FBYyxDQUFDYSxTQUFTLENBQUMsQ0FBQ3dELE1BQU0sQ0FBQyxVQUFDQyxPQUFPLEVBQUVDLE9BQU87SUFBQSxPQUFLRCxPQUFPLENBQUNFLEdBQUcsQ0FBQ0QsT0FBTyxDQUFDTixXQUFXLENBQUM7RUFBQSxHQUFFLElBQUlILEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FDOUdXLElBQ0wsQ0FBQztBQUNILENBQUMsQ0FBQztBQUVGdEUsRUFBRSxDQUFDLDhFQUE4RSxFQUFFLFlBQU07RUFDdkZDLE1BQU0sQ0FBQ04sY0FBYyxDQUFDNEUscUJBQXFCLENBQUM7SUFBRTNCLFFBQVEsRUFBRSxNQUFNO0lBQUU0QixJQUFJLEVBQUU7RUFBSyxDQUFDLENBQUMsQ0FBQyxDQUFDckUsSUFBSSxDQUFDLE9BQU8sQ0FBQztFQUU1RkYsTUFBTSxDQUFDTixjQUFjLENBQUM0RSxxQkFBcUIsQ0FBQztJQUFFM0IsUUFBUSxFQUFFLE9BQU87SUFBRTRCLElBQUksRUFBRTtFQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNyRSxJQUFJLENBQUMsUUFBUSxDQUFDO0VBRTlGRixNQUFNLENBQUNOLGNBQWMsQ0FBQzRFLHFCQUFxQixDQUFDO0lBQUUzQixRQUFRLEVBQUUsT0FBTztJQUFFNEIsSUFBSSxFQUFFO0VBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQ3JFLElBQUksQ0FBQyxRQUFRLENBQUM7RUFFN0ZGLE1BQU0sQ0FBQ04sY0FBYyxDQUFDNEUscUJBQXFCLENBQUM7SUFBRTNCLFFBQVEsRUFBRSxLQUFLO0lBQUU0QixJQUFJLEVBQUU7RUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDckUsSUFBSSxDQUFDLE9BQU8sQ0FBQztBQUM1RixDQUFDLENBQUM7QUFFRkgsRUFBRSxDQUFDLG9GQUFvRixFQUFFLFlBQU07RUFDN0YsSUFBTW1DLFNBQVMsR0FBR3RDLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQztFQUN6QzRCLFNBQVMsQ0FBQ1MsUUFBUSxHQUFHLE1BQU07RUFDM0IzQyxNQUFNLENBQ0pOLGNBQWMsQ0FBQzhFLHNCQUFzQixDQUFDO0lBQ3BDM0UsS0FBSyxFQUFBNEUsUUFBQSxLQUNBN0UsY0FBYztNQUNqQlUsS0FBSyxFQUFFLENBQUM0QixTQUFTO0lBQUMsRUFDbkI7SUFDRFMsUUFBUSxFQUFFO0VBQ1osQ0FBQyxDQUNILENBQUMsQ0FBQ3pDLElBQUksQ0FBQyxPQUFPLENBQUM7QUFDakIsQ0FBQyxDQUFDO0FBRUZILEVBQUUsQ0FBQyxrRkFBa0YsRUFBRSxZQUFNO0VBQzNGQyxNQUFNLENBQ0pOLGNBQWMsQ0FBQzhFLHNCQUFzQixDQUFDO0lBQ3BDM0UsS0FBSyxFQUFBNEUsUUFBQSxLQUNBN0UsY0FBYztNQUNqQlUsS0FBSyxFQUFFVixjQUFjLENBQUNVLEtBQUssQ0FBQ00sTUFBTSxDQUFDLENBQUE2RCxRQUFBLEtBRTVCN0UsY0FBYyxDQUFDVSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzFCcUMsUUFBUSxFQUFFO01BQU8sR0FFcEI7SUFBQyxFQUNIO0lBQ0RBLFFBQVEsRUFBRTtFQUNaLENBQUMsQ0FDSCxDQUFDLENBQUN6QyxJQUFJLENBQUMsUUFBUSxDQUFDO0VBRWhCRixNQUFNLENBQ0pOLGNBQWMsQ0FBQzhFLHNCQUFzQixDQUFDO0lBQ3BDM0UsS0FBSyxFQUFBNEUsUUFBQSxLQUNBN0UsY0FBYztNQUNqQlUsS0FBSyxFQUFFVixjQUFjLENBQUNVLEtBQUssQ0FBQ00sTUFBTSxDQUFDLENBQUE2RCxRQUFBLEtBRTVCN0UsY0FBYyxDQUFDVSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzFCcUMsUUFBUSxFQUFFO01BQU8sR0FFcEI7SUFBQyxFQUNIO0lBQ0RBLFFBQVEsRUFBRTtFQUNaLENBQUMsQ0FDSCxDQUFDLENBQUN6QyxJQUFJLENBQUMsUUFBUSxDQUFDO0FBQ2xCLENBQUMsQ0FBQztBQUVGSCxFQUFFLENBQUMsd0RBQXdELEVBQUUsWUFBTTtFQUNqRUMsTUFBTSxDQUNKTixjQUFjLENBQUNnRixjQUFjLENBQUM7SUFDNUI3RSxLQUFLLEVBQUVELGNBQWM7SUFDckJVLEtBQUssRUFBRVYsY0FBYyxDQUFDVSxLQUFLO0lBQzNCa0QsSUFBSSxFQUFFO01BQ0ptQixHQUFHLEVBQUUsQ0FBQztNQUNOQyxVQUFVLEVBQUUxRixvQkFBb0I7TUFDaEMyRixRQUFRLEVBQUVwRjtJQUNaO0VBQ0YsQ0FBQyxDQUNILENBQUMsQ0FBQ3NCLE9BQU8sQ0FBQyxHQUFBSCxNQUFBLENBQUloQixjQUFjLENBQUNVLEtBQUssRUFBRWtELElBQUksQ0FBQyxVQUFDc0IsS0FBSyxFQUFFQyxLQUFLO0lBQUEsT0FBS0QsS0FBSyxDQUFDM0MsU0FBUyxHQUFHNEMsS0FBSyxDQUFDNUMsU0FBUztFQUFBLEVBQUMsQ0FBQztFQUU5Rm5DLE1BQU0sQ0FDSk4sY0FBYyxDQUFDZ0YsY0FBYyxDQUFDO0lBQzVCN0UsS0FBSyxFQUFFRCxjQUFjO0lBQ3JCVSxLQUFLLEVBQUVWLGNBQWMsQ0FBQ1UsS0FBSztJQUMzQmtELElBQUksRUFBRTtNQUNKbUIsR0FBRyxFQUFFLENBQUMsQ0FBQztNQUNQQyxVQUFVLEVBQUUxRixvQkFBb0I7TUFDaEMyRixRQUFRLEVBQUVwRjtJQUNaO0VBQ0YsQ0FBQyxDQUNILENBQUMsQ0FBQ3NCLE9BQU8sQ0FBQyxHQUFBSCxNQUFBLENBQUloQixjQUFjLENBQUNVLEtBQUssRUFBRWtELElBQUksQ0FBQyxVQUFDc0IsS0FBSyxFQUFFQyxLQUFLO0lBQUEsT0FBS0EsS0FBSyxDQUFDNUMsU0FBUyxHQUFHMkMsS0FBSyxDQUFDM0MsU0FBUztFQUFBLEVBQUMsQ0FBQztBQUNoRyxDQUFDLENBQUM7QUFFRnBDLEVBQUUsQ0FBQyxzRUFBc0UsRUFBRSxZQUFNO0VBQy9FQyxNQUFNLENBQ0pOLGNBQWMsQ0FBQ3NGLHVCQUF1QixDQUFDO0lBQ3JDbkYsS0FBSyxFQUFFRCxjQUFjO0lBQ3JCWSxJQUFJLEVBQUVaLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUM7RUFDOUIsQ0FBQyxDQUNILENBQUMsQ0FBQ0osSUFBSSxDQUFDTixjQUFjLENBQUNVLEtBQUssQ0FBQ21DLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFDekMsQ0FBQyxDQUFDO0FBRUYxQyxFQUFFLENBQUMsbUVBQW1FLEVBQUUsWUFBTTtFQUM1RUMsTUFBTSxDQUNKTixjQUFjLENBQUNzRix1QkFBdUIsQ0FBQztJQUNyQ25GLEtBQUssRUFBRUQsY0FBYztJQUNyQlksSUFBSSxFQUFFWixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDO0VBQzlCLENBQUMsQ0FDSCxDQUFDLENBQUNKLElBQUksQ0FBQ1IsY0FBYyxDQUFDeUIscUJBQXFCLENBQUN2QixjQUFjLENBQUMsQ0FBQ29CLElBQUksQ0FBQ3BCLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDOEIsTUFBTSxDQUFDLENBQUVpQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO0FBQzdHLENBQUMsQ0FBQztBQUVGdEUsRUFBRSxDQUFDLCtEQUErRCxFQUFFLFlBQU07RUFDeEUsSUFBTWtGLFVBQVUsR0FBR3JGLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQztFQUMxQzJFLFVBQVUsQ0FBQzdDLE1BQU0sR0FBRyxVQUFVO0VBRTlCcEMsTUFBTSxDQUNKTixjQUFjLENBQUNzRix1QkFBdUIsQ0FBQztJQUNyQ25GLEtBQUssRUFBRUQsY0FBYztJQUNyQlksSUFBSSxFQUFFeUU7RUFDUixDQUFDLENBQ0gsQ0FBQyxDQUFDL0UsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ1osQ0FBQyxDQUFDO0FBRUZILEVBQUUsQ0FBQyxxRUFBcUUsRUFBRSxZQUFNO0VBQzlFLElBQU04RCxXQUFXLEdBQUdqRSxjQUFjLENBQUNhLFNBQVMsQ0FBQ2IsY0FBYyxDQUFDVSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM0RSxTQUFTLENBQUMsQ0FBQ3JCLFdBQVc7RUFDM0YsSUFBTXNCLGFBQWEsR0FBR3ZGLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDNkUsYUFBYTtFQUUzRG5GLE1BQU0sQ0FBQ04sY0FBYyxDQUFDNkMsWUFBWSxDQUFDM0MsY0FBYyxDQUFDLENBQUMsQ0FBQ00sSUFBSSxDQUFJMkQsV0FBVyxVQUFLc0IsYUFBZSxDQUFDO0FBQzlGLENBQUMsQ0FBQztBQUVGcEYsRUFBRSxDQUFDLHdEQUF3RCxFQUFFLFlBQU07RUFDakUsSUFBTVMsSUFBSSxHQUFHWixjQUFjLENBQUNVLEtBQUssQ0FBQyxDQUFDLENBQUM7RUFDcEMsSUFBTStELElBQUksR0FBRzNFLGNBQWMsQ0FBQ3lCLHFCQUFxQixDQUFDdkIsY0FBYyxDQUFDLENBQUNvQixJQUFJLENBQUNSLElBQUksQ0FBQzRCLE1BQU0sQ0FBQyxDQUFFaUMsSUFBSSxHQUFHLENBQUM7RUFFN0ZyRSxNQUFNLENBQ0pOLGNBQWMsQ0FBQzBGLGtCQUFrQixDQUFDO0lBQ2hDdkYsS0FBSyxFQUFFRCxjQUFjO0lBQ3JCVSxLQUFLLEVBQUVWLGNBQWMsQ0FBQ1UsS0FBSztJQUMzQitFLFNBQVMsRUFBRSxDQUFDN0UsSUFBSSxDQUFDNEIsTUFBTTtFQUN6QixDQUFDLENBQUMsQ0FBQ0ssTUFDTCxDQUFDLENBQUN2QyxJQUFJLENBQUNOLGNBQWMsQ0FBQ1UsS0FBSyxDQUFDbUMsTUFBTSxHQUFHNEIsSUFBSSxDQUFDO0FBQzVDLENBQUMsQ0FBQztBQUVGdEUsRUFBRSxDQUFDLDRFQUE0RSxFQUFFLFlBQU07RUFDckYsSUFBTUYsS0FBSyxHQUFHRCxjQUFjO0VBQzVCLElBQU0wRixTQUFTLEdBQUcsSUFBSXRELElBQUksQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsSUFBSTtFQUU3Q3BDLEtBQUssQ0FBQ1MsS0FBSyxDQUFDQyxPQUFPLENBQUMsVUFBQ0MsSUFBSSxFQUFLO0lBQzVCQSxJQUFJLENBQUNtQyxRQUFRLEdBQUcsT0FBTztJQUN2Qm5DLElBQUksQ0FBQzJCLFNBQVMsR0FBR21ELFNBQVM7RUFDNUIsQ0FBQyxDQUFDO0VBRUZ0RixNQUFNLENBQ0pOLGNBQWMsQ0FBQzZGLGdCQUFnQixDQUFDO0lBQzlCMUYsS0FBSyxFQUFMQSxLQUFLO0lBQ0wyRixRQUFRLEVBQUUsQ0FBQztJQUNYQyxLQUFLLEVBQUU7RUFDVCxDQUFDLENBQ0gsQ0FBQyxDQUFDMUUsT0FBTyxDQUFDLENBQ1I7SUFBRXVFLFNBQVMsRUFBVEEsU0FBUztJQUFFRyxLQUFLLEVBQUU7RUFBRyxDQUFDLEVBQ3hCO0lBQUVILFNBQVMsRUFBRUEsU0FBUyxHQUFHLE9BQU87SUFBRUcsS0FBSyxFQUFFO0VBQUcsQ0FBQyxFQUM3QztJQUFFSCxTQUFTLEVBQUVBLFNBQVMsR0FBRyxPQUFPO0lBQUVHLEtBQUssRUFBRTtFQUFHLENBQUMsRUFDN0M7SUFBRUgsU0FBUyxFQUFFQSxTQUFTLEdBQUcsT0FBTztJQUFFRyxLQUFLLEVBQUU7RUFBRyxDQUFDLENBQzlDLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRjFGLEVBQUUsQ0FBQyx3Q0FBd0MsRUFBRSxZQUFNO0VBQ2pELElBQU11RixTQUFTLEdBQUcsSUFBSXRELElBQUksQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsSUFBSTtFQUM3QyxJQUFNcEMsS0FBSyxHQUFHWixjQUFjLENBQUNZLEtBQUssQ0FBQztJQUFFQyxhQUFhLEVBQUU7RUFBRSxDQUFDLENBQUM7RUFFeERELEtBQUssQ0FBQ1MsS0FBSyxHQUFHLENBQ1o7SUFDRUgsT0FBTyxFQUFFLHNDQUFzQztJQUMvQytFLFNBQVMsRUFBRSxzQ0FBc0M7SUFDakQ5QyxNQUFNLEVBQUUsc0NBQXNDO0lBQzlDc0QsS0FBSyxFQUFFLENBQUM7SUFDUkMsSUFBSSxFQUFFLEVBQUU7SUFDUlIsYUFBYSxFQUFFLE1BQU07SUFDckJoRCxTQUFTLEVBQUVtRCxTQUFTO0lBQ3BCM0MsUUFBUSxFQUFFO0VBQ1osQ0FBQyxDQUNGO0VBRUQzQyxNQUFNLENBQUNOLGNBQWMsQ0FBQzZGLGdCQUFnQixDQUFDO0lBQUUxRixLQUFLLEVBQUxBO0VBQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQ2tCLE9BQU8sQ0FBQyxDQUN6RDtJQUFFdUUsU0FBUyxFQUFUQSxTQUFTO0lBQUVHLEtBQUssRUFBRS9GLGNBQWMsQ0FBQ2tHO0VBQW1CLENBQUMsRUFDdkQ7SUFDRU4sU0FBUyxFQUFFQSxTQUFTLEdBQUcsT0FBTztJQUM5QkcsS0FBSyxFQUFFL0YsY0FBYyxDQUFDa0c7RUFDeEIsQ0FBQyxFQUNEO0lBQ0VOLFNBQVMsRUFBRUEsU0FBUyxHQUFHLE9BQU87SUFDOUJHLEtBQUssRUFBRS9GLGNBQWMsQ0FBQ2tHO0VBQ3hCLENBQUMsRUFDRDtJQUNFTixTQUFTLEVBQUVBLFNBQVMsR0FBRyxPQUFPO0lBQzlCRyxLQUFLLEVBQUUvRixjQUFjLENBQUNrRztFQUN4QixDQUFDLEVBQ0Q7SUFDRU4sU0FBUyxFQUFFQSxTQUFTLEdBQUcsT0FBTztJQUM5QkcsS0FBSyxFQUFFL0YsY0FBYyxDQUFDa0c7RUFDeEIsQ0FBQyxDQUNGLENBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=