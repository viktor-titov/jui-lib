// Copyright (c) 2020 The Jaeger Authors
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { _getTraceNameImpl as getTraceName } from './trace-viewer';
describe('getTraceName', function () {
  var firstSpanId = 'firstSpanId';
  var secondSpanId = 'secondSpanId';
  var thirdSpanId = 'thirdSpanId';
  var missingSpanId = 'missingSpanId';
  var currentTraceId = 'currentTraceId';
  var serviceName = 'serviceName';
  var operationName = 'operationName';
  var t = 1583758670000;

  // Note: this trace has a loop S1 <- S2 <- S3 <- S1, which is the only way
  // to make the algorithm return an empty string as trace name.
  var spansWithNoRoots = [{
    spanID: firstSpanId,
    traceID: currentTraceId,
    startTime: t + 200,
    process: {},
    references: [{
      spanID: secondSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: secondSpanId,
    traceID: currentTraceId,
    startTime: t + 100,
    process: {},
    references: [{
      spanID: thirdSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: thirdSpanId,
    traceID: currentTraceId,
    startTime: t,
    process: {},
    references: [{
      spanID: firstSpanId,
      traceID: currentTraceId
    }]
  }];
  var spansWithMultipleRootsDifferentByStartTime = [{
    spanID: firstSpanId,
    traceID: currentTraceId,
    startTime: t + 200,
    process: {},
    references: [{
      spanID: thirdSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: secondSpanId,
    // may be a root span
    traceID: currentTraceId,
    startTime: t + 100,
    process: {},
    references: [{
      spanID: missingSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: thirdSpanId,
    // root span (as the earliest)
    traceID: currentTraceId,
    startTime: t,
    operationName: operationName,
    process: {
      serviceName: serviceName
    },
    references: [{
      spanID: missingSpanId,
      traceID: currentTraceId
    }]
  }];
  var spansWithMultipleRootsWithOneWithoutRefs = [{
    spanID: firstSpanId,
    traceID: currentTraceId,
    startTime: t + 200,
    process: {},
    references: [{
      spanID: thirdSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: secondSpanId,
    // root span (as a span without any refs)
    traceID: currentTraceId,
    startTime: t + 100,
    operationName: operationName,
    process: {
      serviceName: serviceName
    }
  }, {
    spanID: thirdSpanId,
    // may be a root span
    traceID: currentTraceId,
    startTime: t,
    process: {},
    references: [{
      spanID: missingSpanId,
      traceID: currentTraceId
    }]
  }];
  var spansWithOneRootWithRemoteRef = [{
    spanID: firstSpanId,
    traceID: currentTraceId,
    startTime: t + 200,
    process: {},
    references: [{
      spanID: secondSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: secondSpanId,
    traceID: currentTraceId,
    startTime: t + 100,
    process: {},
    references: [{
      spanID: thirdSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: thirdSpanId,
    // effective root span, since its parent is missing
    traceID: currentTraceId,
    startTime: t,
    operationName: operationName,
    process: {
      serviceName: serviceName
    },
    references: [{
      spanID: missingSpanId,
      traceID: currentTraceId
    }]
  }];
  var spansWithOneRootWithNoRefs = [{
    spanID: firstSpanId,
    traceID: currentTraceId,
    startTime: t + 200,
    process: {},
    references: [{
      spanID: thirdSpanId,
      traceID: currentTraceId
    }]
  }, {
    spanID: secondSpanId,
    // root span
    traceID: currentTraceId,
    startTime: t + 100,
    operationName: operationName,
    process: {
      serviceName: serviceName
    }
  }, {
    spanID: thirdSpanId,
    traceID: currentTraceId,
    startTime: t,
    process: {},
    references: [{
      spanID: secondSpanId,
      traceID: currentTraceId
    }]
  }];
  var fullTraceName = serviceName + ": " + operationName;
  it('returns an empty string if given spans with no root among them', function () {
    expect(getTraceName(spansWithNoRoots)).toEqual('');
  });
  it('returns an id of root span with the earliest startTime', function () {
    expect(getTraceName(spansWithMultipleRootsDifferentByStartTime)).toEqual(fullTraceName);
  });
  it('returns an id of root span without any refs', function () {
    expect(getTraceName(spansWithMultipleRootsWithOneWithoutRefs)).toEqual(fullTraceName);
  });
  it('returns an id of root span with remote ref', function () {
    expect(getTraceName(spansWithOneRootWithRemoteRef)).toEqual(fullTraceName);
  });
  it('returns an id of root span with no refs', function () {
    expect(getTraceName(spansWithOneRootWithNoRefs)).toEqual(fullTraceName);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0VHJhY2VOYW1lSW1wbCIsImdldFRyYWNlTmFtZSIsImRlc2NyaWJlIiwiZmlyc3RTcGFuSWQiLCJzZWNvbmRTcGFuSWQiLCJ0aGlyZFNwYW5JZCIsIm1pc3NpbmdTcGFuSWQiLCJjdXJyZW50VHJhY2VJZCIsInNlcnZpY2VOYW1lIiwib3BlcmF0aW9uTmFtZSIsInQiLCJzcGFuc1dpdGhOb1Jvb3RzIiwic3BhbklEIiwidHJhY2VJRCIsInN0YXJ0VGltZSIsInByb2Nlc3MiLCJyZWZlcmVuY2VzIiwic3BhbnNXaXRoTXVsdGlwbGVSb290c0RpZmZlcmVudEJ5U3RhcnRUaW1lIiwic3BhbnNXaXRoTXVsdGlwbGVSb290c1dpdGhPbmVXaXRob3V0UmVmcyIsInNwYW5zV2l0aE9uZVJvb3RXaXRoUmVtb3RlUmVmIiwic3BhbnNXaXRoT25lUm9vdFdpdGhOb1JlZnMiLCJmdWxsVHJhY2VOYW1lIiwiaXQiLCJleHBlY3QiLCJ0b0VxdWFsIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL21vZGVsL2ZpbmQtdHJhY2UtbmFtZS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgMjAyMCBUaGUgSmFlZ2VyIEF1dGhvcnNcbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgVHJhY2VTcGFuIH0gZnJvbSAnLi4vdHlwZXMvdHJhY2UnO1xuXG5pbXBvcnQgeyBfZ2V0VHJhY2VOYW1lSW1wbCBhcyBnZXRUcmFjZU5hbWUgfSBmcm9tICcuL3RyYWNlLXZpZXdlcic7XG5cbmRlc2NyaWJlKCdnZXRUcmFjZU5hbWUnLCAoKSA9PiB7XG4gIGNvbnN0IGZpcnN0U3BhbklkID0gJ2ZpcnN0U3BhbklkJztcbiAgY29uc3Qgc2Vjb25kU3BhbklkID0gJ3NlY29uZFNwYW5JZCc7XG4gIGNvbnN0IHRoaXJkU3BhbklkID0gJ3RoaXJkU3BhbklkJztcbiAgY29uc3QgbWlzc2luZ1NwYW5JZCA9ICdtaXNzaW5nU3BhbklkJztcblxuICBjb25zdCBjdXJyZW50VHJhY2VJZCA9ICdjdXJyZW50VHJhY2VJZCc7XG5cbiAgY29uc3Qgc2VydmljZU5hbWUgPSAnc2VydmljZU5hbWUnO1xuICBjb25zdCBvcGVyYXRpb25OYW1lID0gJ29wZXJhdGlvbk5hbWUnO1xuXG4gIGNvbnN0IHQgPSAxNTgzNzU4NjcwMDAwO1xuXG4gIC8vIE5vdGU6IHRoaXMgdHJhY2UgaGFzIGEgbG9vcCBTMSA8LSBTMiA8LSBTMyA8LSBTMSwgd2hpY2ggaXMgdGhlIG9ubHkgd2F5XG4gIC8vIHRvIG1ha2UgdGhlIGFsZ29yaXRobSByZXR1cm4gYW4gZW1wdHkgc3RyaW5nIGFzIHRyYWNlIG5hbWUuXG4gIGNvbnN0IHNwYW5zV2l0aE5vUm9vdHMgPSBbXG4gICAge1xuICAgICAgc3BhbklEOiBmaXJzdFNwYW5JZCxcbiAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgc3RhcnRUaW1lOiB0ICsgMjAwLFxuICAgICAgcHJvY2Vzczoge30sXG4gICAgICByZWZlcmVuY2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBzcGFuSUQ6IHNlY29uZFNwYW5JZCxcbiAgICAgICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgICB7XG4gICAgICBzcGFuSUQ6IHNlY29uZFNwYW5JZCxcbiAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgc3RhcnRUaW1lOiB0ICsgMTAwLFxuICAgICAgcHJvY2Vzczoge30sXG4gICAgICByZWZlcmVuY2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBzcGFuSUQ6IHRoaXJkU3BhbklkLFxuICAgICAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIHNwYW5JRDogdGhpcmRTcGFuSWQsXG4gICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgIHN0YXJ0VGltZTogdCxcbiAgICAgIHByb2Nlc3M6IHt9LFxuICAgICAgcmVmZXJlbmNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgc3BhbklEOiBmaXJzdFNwYW5JZCxcbiAgICAgICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgXTtcbiAgY29uc3Qgc3BhbnNXaXRoTXVsdGlwbGVSb290c0RpZmZlcmVudEJ5U3RhcnRUaW1lID0gW1xuICAgIHtcbiAgICAgIHNwYW5JRDogZmlyc3RTcGFuSWQsXG4gICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgIHN0YXJ0VGltZTogdCArIDIwMCxcbiAgICAgIHByb2Nlc3M6IHt9LFxuICAgICAgcmVmZXJlbmNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgc3BhbklEOiB0aGlyZFNwYW5JZCxcbiAgICAgICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgICB7XG4gICAgICBzcGFuSUQ6IHNlY29uZFNwYW5JZCwgLy8gbWF5IGJlIGEgcm9vdCBzcGFuXG4gICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgIHN0YXJ0VGltZTogdCArIDEwMCxcbiAgICAgIHByb2Nlc3M6IHt9LFxuICAgICAgcmVmZXJlbmNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgc3BhbklEOiBtaXNzaW5nU3BhbklkLFxuICAgICAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIHNwYW5JRDogdGhpcmRTcGFuSWQsIC8vIHJvb3Qgc3BhbiAoYXMgdGhlIGVhcmxpZXN0KVxuICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICBzdGFydFRpbWU6IHQsXG4gICAgICBvcGVyYXRpb25OYW1lLFxuICAgICAgcHJvY2Vzczoge1xuICAgICAgICBzZXJ2aWNlTmFtZSxcbiAgICAgIH0sXG4gICAgICByZWZlcmVuY2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBzcGFuSUQ6IG1pc3NpbmdTcGFuSWQsXG4gICAgICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gIF07XG4gIGNvbnN0IHNwYW5zV2l0aE11bHRpcGxlUm9vdHNXaXRoT25lV2l0aG91dFJlZnMgPSBbXG4gICAge1xuICAgICAgc3BhbklEOiBmaXJzdFNwYW5JZCxcbiAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgc3RhcnRUaW1lOiB0ICsgMjAwLFxuICAgICAgcHJvY2Vzczoge30sXG4gICAgICByZWZlcmVuY2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBzcGFuSUQ6IHRoaXJkU3BhbklkLFxuICAgICAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIHNwYW5JRDogc2Vjb25kU3BhbklkLCAvLyByb290IHNwYW4gKGFzIGEgc3BhbiB3aXRob3V0IGFueSByZWZzKVxuICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICBzdGFydFRpbWU6IHQgKyAxMDAsXG4gICAgICBvcGVyYXRpb25OYW1lLFxuICAgICAgcHJvY2Vzczoge1xuICAgICAgICBzZXJ2aWNlTmFtZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICBzcGFuSUQ6IHRoaXJkU3BhbklkLCAvLyBtYXkgYmUgYSByb290IHNwYW5cbiAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgc3RhcnRUaW1lOiB0LFxuICAgICAgcHJvY2Vzczoge30sXG4gICAgICByZWZlcmVuY2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBzcGFuSUQ6IG1pc3NpbmdTcGFuSWQsXG4gICAgICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gIF07XG4gIGNvbnN0IHNwYW5zV2l0aE9uZVJvb3RXaXRoUmVtb3RlUmVmID0gW1xuICAgIHtcbiAgICAgIHNwYW5JRDogZmlyc3RTcGFuSWQsXG4gICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgIHN0YXJ0VGltZTogdCArIDIwMCxcbiAgICAgIHByb2Nlc3M6IHt9LFxuICAgICAgcmVmZXJlbmNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgc3BhbklEOiBzZWNvbmRTcGFuSWQsXG4gICAgICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgc3BhbklEOiBzZWNvbmRTcGFuSWQsXG4gICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgIHN0YXJ0VGltZTogdCArIDEwMCxcbiAgICAgIHByb2Nlc3M6IHt9LFxuICAgICAgcmVmZXJlbmNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgc3BhbklEOiB0aGlyZFNwYW5JZCxcbiAgICAgICAgICB0cmFjZUlEOiBjdXJyZW50VHJhY2VJZCxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSxcbiAgICB7XG4gICAgICBzcGFuSUQ6IHRoaXJkU3BhbklkLCAvLyBlZmZlY3RpdmUgcm9vdCBzcGFuLCBzaW5jZSBpdHMgcGFyZW50IGlzIG1pc3NpbmdcbiAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgc3RhcnRUaW1lOiB0LFxuICAgICAgb3BlcmF0aW9uTmFtZSxcbiAgICAgIHByb2Nlc3M6IHtcbiAgICAgICAgc2VydmljZU5hbWUsXG4gICAgICB9LFxuICAgICAgcmVmZXJlbmNlczogW1xuICAgICAgICB7XG4gICAgICAgICAgc3BhbklEOiBtaXNzaW5nU3BhbklkLFxuICAgICAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICBdO1xuICBjb25zdCBzcGFuc1dpdGhPbmVSb290V2l0aE5vUmVmcyA9IFtcbiAgICB7XG4gICAgICBzcGFuSUQ6IGZpcnN0U3BhbklkLFxuICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICBzdGFydFRpbWU6IHQgKyAyMDAsXG4gICAgICBwcm9jZXNzOiB7fSxcbiAgICAgIHJlZmVyZW5jZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHNwYW5JRDogdGhpcmRTcGFuSWQsXG4gICAgICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAge1xuICAgICAgc3BhbklEOiBzZWNvbmRTcGFuSWQsIC8vIHJvb3Qgc3BhblxuICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICBzdGFydFRpbWU6IHQgKyAxMDAsXG4gICAgICBvcGVyYXRpb25OYW1lLFxuICAgICAgcHJvY2Vzczoge1xuICAgICAgICBzZXJ2aWNlTmFtZSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICBzcGFuSUQ6IHRoaXJkU3BhbklkLFxuICAgICAgdHJhY2VJRDogY3VycmVudFRyYWNlSWQsXG4gICAgICBzdGFydFRpbWU6IHQsXG4gICAgICBwcm9jZXNzOiB7fSxcbiAgICAgIHJlZmVyZW5jZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHNwYW5JRDogc2Vjb25kU3BhbklkLFxuICAgICAgICAgIHRyYWNlSUQ6IGN1cnJlbnRUcmFjZUlkLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICB9LFxuICBdO1xuXG4gIGNvbnN0IGZ1bGxUcmFjZU5hbWUgPSBgJHtzZXJ2aWNlTmFtZX06ICR7b3BlcmF0aW9uTmFtZX1gO1xuXG4gIGl0KCdyZXR1cm5zIGFuIGVtcHR5IHN0cmluZyBpZiBnaXZlbiBzcGFucyB3aXRoIG5vIHJvb3QgYW1vbmcgdGhlbScsICgpID0+IHtcbiAgICBleHBlY3QoZ2V0VHJhY2VOYW1lKHNwYW5zV2l0aE5vUm9vdHMgYXMgVHJhY2VTcGFuW10pKS50b0VxdWFsKCcnKTtcbiAgfSk7XG5cbiAgaXQoJ3JldHVybnMgYW4gaWQgb2Ygcm9vdCBzcGFuIHdpdGggdGhlIGVhcmxpZXN0IHN0YXJ0VGltZScsICgpID0+IHtcbiAgICBleHBlY3QoZ2V0VHJhY2VOYW1lKHNwYW5zV2l0aE11bHRpcGxlUm9vdHNEaWZmZXJlbnRCeVN0YXJ0VGltZSBhcyBUcmFjZVNwYW5bXSkpLnRvRXF1YWwoZnVsbFRyYWNlTmFtZSk7XG4gIH0pO1xuXG4gIGl0KCdyZXR1cm5zIGFuIGlkIG9mIHJvb3Qgc3BhbiB3aXRob3V0IGFueSByZWZzJywgKCkgPT4ge1xuICAgIGV4cGVjdChnZXRUcmFjZU5hbWUoc3BhbnNXaXRoTXVsdGlwbGVSb290c1dpdGhPbmVXaXRob3V0UmVmcyBhcyB1bmtub3duIGFzIFRyYWNlU3BhbltdKSkudG9FcXVhbChmdWxsVHJhY2VOYW1lKTtcbiAgfSk7XG5cbiAgaXQoJ3JldHVybnMgYW4gaWQgb2Ygcm9vdCBzcGFuIHdpdGggcmVtb3RlIHJlZicsICgpID0+IHtcbiAgICBleHBlY3QoZ2V0VHJhY2VOYW1lKHNwYW5zV2l0aE9uZVJvb3RXaXRoUmVtb3RlUmVmIGFzIFRyYWNlU3BhbltdKSkudG9FcXVhbChmdWxsVHJhY2VOYW1lKTtcbiAgfSk7XG5cbiAgaXQoJ3JldHVybnMgYW4gaWQgb2Ygcm9vdCBzcGFuIHdpdGggbm8gcmVmcycsICgpID0+IHtcbiAgICBleHBlY3QoZ2V0VHJhY2VOYW1lKHNwYW5zV2l0aE9uZVJvb3RXaXRoTm9SZWZzIGFzIHVua25vd24gYXMgVHJhY2VTcGFuW10pKS50b0VxdWFsKGZ1bGxUcmFjZU5hbWUpO1xuICB9KTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFJQSxTQUFTQSxpQkFBaUIsSUFBSUMsWUFBWSxRQUFRLGdCQUFnQjtBQUVsRUMsUUFBUSxDQUFDLGNBQWMsRUFBRSxZQUFNO0VBQzdCLElBQU1DLFdBQVcsR0FBRyxhQUFhO0VBQ2pDLElBQU1DLFlBQVksR0FBRyxjQUFjO0VBQ25DLElBQU1DLFdBQVcsR0FBRyxhQUFhO0VBQ2pDLElBQU1DLGFBQWEsR0FBRyxlQUFlO0VBRXJDLElBQU1DLGNBQWMsR0FBRyxnQkFBZ0I7RUFFdkMsSUFBTUMsV0FBVyxHQUFHLGFBQWE7RUFDakMsSUFBTUMsYUFBYSxHQUFHLGVBQWU7RUFFckMsSUFBTUMsQ0FBQyxHQUFHLGFBQWE7O0VBRXZCO0VBQ0E7RUFDQSxJQUFNQyxnQkFBZ0IsR0FBRyxDQUN2QjtJQUNFQyxNQUFNLEVBQUVULFdBQVc7SUFDbkJVLE9BQU8sRUFBRU4sY0FBYztJQUN2Qk8sU0FBUyxF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