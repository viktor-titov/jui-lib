import _extends from "@babel/runtime/helpers/extends";
// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { isEqual as _isEqual } from 'lodash';

// @ts-ignore
import { getTraceSpanIdsAsTree } from '../selectors/trace';

// @ts-ignore

import { getConfigValue } from '../utils/config/get-config';
import { getTraceName } from './trace-viewer';

// exported for tests
export function deduplicateTags(spanTags) {
  var warningsHash = new Map();
  var tags = spanTags.reduce(function (uniqueTags, tag) {
    if (!uniqueTags.some(function (t) {
      return t.key === tag.key && t.value === tag.value;
    })) {
      uniqueTags.push(tag);
    } else {
      warningsHash.set(tag.key + ":" + tag.value, "Duplicate tag \"" + tag.key + ":" + tag.value + "\"");
    }
    return uniqueTags;
  }, []);
  var warnings = Array.from(warningsHash.values());
  return {
    tags: tags,
    warnings: warnings
  };
}

// exported for tests
export function orderTags(spanTags, topPrefixes) {
  var _spanTags$slice;
  var orderedTags = (_spanTags$slice = spanTags == null ? void 0 : spanTags.slice()) != null ? _spanTags$slice : [];
  var tp = (topPrefixes || []).map(function (p) {
    return p.toLowerCase();
  });
  orderedTags.sort(function (a, b) {
    var aKey = a.key.toLowerCase();
    var bKey = b.key.toLowerCase();
    for (var i = 0; i < tp.length; i++) {
      var p = tp[i];
      if (aKey.startsWith(p) && !bKey.startsWith(p)) {
        return -1;
      }
      if (!aKey.startsWith(p) && bKey.startsWith(p)) {
        return 1;
      }
    }
    if (aKey > bKey) {
      return 1;
    }
    if (aKey < bKey) {
      return -1;
    }
    return 0;
  });
  return orderedTags;
}

/**
 * NOTE: Mutates `data` - Transform the HTTP response data into the form the app
 * generally requires.
 */
export default function transformTraceData(data) {
  if (!(data != null && data.traceID)) {
    return null;
  }
  var traceID = data.traceID.toLowerCase();
  var traceEndTime = 0;
  var traceStartTime = Number.MAX_SAFE_INTEGER;
  var spanIdCounts = new Map();
  var spanMap = new Map();
  // filter out spans with empty start times
  // eslint-disable-next-line no-param-reassign
  data.spans = data.spans.filter(function (span) {
    return Boolean(span.startTime);
  });

  // Sort process tags
  data.processes = Object.entries(data.processes).reduce(function (processes, _ref) {
    var id = _ref[0],
      process = _ref[1];
    processes[id] = _extends({}, process, {
      tags: orderTags(process.tags)
    });
    return processes;
  }, {});
  var max = data.spans.length;
  for (var i = 0; i < max; i++) {
    var span = data.spans[i];
    var startTime = span.startTime,
      duration = span.duration,
      processID = span.processID;
    var spanID = span.spanID;
    // check for start / end time for the trace
    if (startTime < traceStartTime) {
      traceStartTime = startTime;
    }
    if (startTime + duration > traceEndTime) {
      traceEndTime = startTime + duration;
    }
    // make sure span IDs are unique
    var idCount = spanIdCounts.get(spanID);
    if (idCount != null) {
      // eslint-disable-next-line no-console
      console.warn("Dupe spanID, " + (idCount + 1) + " x " + spanID, span, spanMap.get(spanID));
      if (_isEqual(span, spanMap.get(spanID))) {
        // eslint-disable-next-line no-console
        console.warn('\t two spans with same ID have `isEqual(...) === true`');
      }
      spanIdCounts.set(spanID, idCount + 1);
      spanID = spanID + "_" + idCount;
      span.spanID = spanID;
    } else {
      spanIdCounts.set(spanID, 1);
    }
    span.process = data.processes[processID];
    spanMap.set(spanID, span);
  }
  // tree is necessary to sort the spans, so children follow parents, and
  // siblings are sorted by start time
  var tree = getTraceSpanIdsAsTree(data);
  var spans = [];
  var svcCounts = {};

  // Eslint complains about number type not needed but then TS complains it is implicitly any.
  // eslint-disable-next-line @typescript-eslint/no-inferrable-types
  tree.walk(function (spanID, node, depth) {
    if (depth === void 0) {
      depth = 0;
    }
    if (spanID === '__root__') {
      return;
    }
    if (typeof spanID !== 'string') {
      return;
    }
    var span = spanMap.get(spanID);
    if (!span) {
      return;
    }
    var serviceName = span.process.serviceName;
    svcCounts[serviceName] = (svcCounts[serviceName] || 0) + 1;
    span.relativeStartTime = span.startTime - traceStartTime;
    span.depth = depth - 1;
    span.hasChildren = node.children.length > 0;
    span.childSpanCount = node.children.length;
    span.warnings = span.warnings || [];
    span.tags = span.tags || [];
    span.references = span.references || [];
    var tagsInfo = deduplicateTags(span.tags);
    span.tags = orderTags(tagsInfo.tags, getConfigValue('topTagPrefixes'));
    span.warnings = span.warnings.concat(tagsInfo.warnings);
    span.references.forEach(function (ref, index) {
      var refSpan = spanMap.get(ref.spanID);
      if (refSpan) {
        // eslint-disable-next-line no-param-reassign
        ref.span = refSpan;
        if (index > 0) {
          // Don't take into account the parent, just other references.
          refSpan.subsidiarilyReferencedBy = refSpan.subsidiarilyReferencedBy || [];
          refSpan.subsidiarilyReferencedBy.push({
            spanID: spanID,
            traceID: traceID,
            span: span,
            refType: ref.refType
          });
        }
      }
    });
    spans.push(span);
  });
  var traceName = getTraceName(spans);
  var services = Object.keys(svcCounts).map(function (name) {
    return {
      name: name,
      numberOfSpans: svcCounts[name]
    };
  });
  return {
    services: services,
    spans: spans,
    traceID: traceID,
    traceName: traceName,
    // can't use spread operator for intersection types
    // repl: https://goo.gl/4Z23MJ
    // issue: https://github.com/facebook/flow/issues/1511
    processes: data.processes,
    duration: traceEndTime - traceStartTime,
    startTime: traceStartTime,
    endTime: traceEndTime
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpc0VxdWFsIiwiX2lzRXF1YWwiLCJnZXRUcmFjZVNwYW5JZHNBc1RyZWUiLCJnZXRDb25maWdWYWx1ZSIsImdldFRyYWNlTmFtZSIsImRlZHVwbGljYXRlVGFncyIsInNwYW5UYWdzIiwid2FybmluZ3NIYXNoIiwiTWFwIiwidGFncyIsInJlZHVjZSIsInVuaXF1ZVRhZ3MiLCJ0YWciLCJzb21lIiwidCIsImtleSIsInZhbHVlIiwicHVzaCIsInNldCIsIndhcm5pbmdzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwib3JkZXJUYWdzIiwidG9wUHJlZml4ZXMiLCJfc3BhblRhZ3Mkc2xpY2UiLCJvcmRlcmVkVGFncyIsInNsaWNlIiwidHAiLCJtYXAiLCJwIiwidG9Mb3dlckNhc2UiLCJzb3J0IiwiYSIsImIiLCJhS2V5IiwiYktleSIsImkiLCJsZW5ndGgiLCJzdGFydHNXaXRoIiwidHJhbnNmb3JtVHJhY2VEYXRhIiwiZGF0YSIsInRyYWNlSUQiLCJ0cmFjZUVuZFRpbWUiLCJ0cmFjZVN0YXJ0VGltZSIsIk51bWJlciIsIk1BWF9TQUZFX0lOVEVHRVIiLCJzcGFuSWRDb3VudHMiLCJzcGFuTWFwIiwic3BhbnMiLCJmaWx0ZXIiLCJzcGFuIiwiQm9vbGVhbiIsInN0YXJ0VGltZSIsInByb2Nlc3NlcyIsIk9iamVjdCIsImVudHJpZXMiLCJfcmVmIiwiaWQiLCJwcm9jZXNzIiwiX2V4dGVuZHMiLCJtYXgiLCJkdXJhdGlvbiIsInByb2Nlc3NJRCIsInNwYW5JRCIsImlkQ291bnQiLCJnZXQiLCJjb25zb2xlIiwid2FybiIsInRyZWUiLCJzdmNDb3VudHMiLCJ3YWxrIiwibm9kZSIsImRlcHRoIiwic2VydmljZU5hbWUiLCJyZWxhdGl2ZVN0YXJ0VGltZSIsImhhc0NoaWxkcmVuIiwiY2hpbGRyZW4iLCJjaGlsZFNwYW5Db3VudCIsInJlZmVyZW5jZXMiLCJ0YWdzSW5mbyIsImNvbmNhdCIsImZvckVhY2giLCJyZWYiLCJpbmRleCIsInJlZlNwYW4iLCJzdWJzaWRpYXJpbHlSZWZlcmVuY2VkQnkiLCJyZWZUeXBlIiwidHJhY2VOYW1lIiwic2VydmljZXMiLCJrZXlzIiwibmFtZSIsIm51bWJlck9mU3BhbnMiLCJlbmRUaW1lIl0sInNvdXJjZXMiOlsiLi4vLi4vc3JjL21vZGVsL3RyYW5zZm9ybS10cmFjZS1kYXRhLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIDIwMTcgVWJlciBUZWNobm9sb2dpZXMsIEluYy5cbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IHsgaXNFcXVhbCBhcyBfaXNFcXVhbCB9IGZyb20gJ2xvZGFzaCc7XG5cbi8vIEB0cy1pZ25vcmVcbmltcG9ydCB7IGdldFRyYWNlU3Bhbklkc0FzVHJlZSB9IGZyb20gJy4uL3NlbGVjdG9ycy90cmFjZSc7XG5pbXBvcnQgeyBUcmFjZUtleVZhbHVlUGFpciwgVHJhY2VTcGFuLCBUcmFjZSwgVHJhY2VSZXNwb25zZSwgVHJhY2VQcm9jZXNzIH0gZnJvbSAnLi4vdHlwZXMvdHJhY2UnO1xuLy8gQHRzLWlnbm9yZVxuaW1wb3J0IFRyZWVOb2RlIGZyb20gJy4uL3V0aWxzL1RyZWVOb2RlJztcbmltcG9ydCB7IGdldENvbmZpZ1ZhbHVlIH0gZnJvbSAnLi4vdXRpbHMvY29uZmlnL2dldC1jb25maWcnO1xuXG5pbXBvcnQgeyBnZXRUcmFjZU5hbWUgfSBmcm9tICcuL3RyYWNlLXZpZXdlcic7XG5cbi8vIGV4cG9ydGVkIGZvciB0ZXN0c1xuZXhwb3J0IGZ1bmN0aW9uIGRlZHVwbGljYXRlVGFncyhzcGFuVGFnczogVHJhY2VLZXlWYWx1ZVBhaXJbXSkge1xuICBjb25zdCB3YXJuaW5nc0hhc2g6IE1hcDxzdHJpbmcsIHN0cmluZz4gPSBuZXcgTWFwPHN0cmluZywgc3RyaW5nPigpO1xuICBjb25zdCB0YWdzOiBUcmFjZUtleVZhbHVlUGFpcltdID0gc3BhblRhZ3MucmVkdWNlPFRyYWNlS2V5VmFsdWVQYWlyW10+KCh1bmlxdWVUYWdzLCB0YWcpID0+IHtcbiAgICBpZiAoIXVuaXF1ZVRhZ3Muc29tZSgodCkgPT4gdC5rZXkgPT09IHRhZy5rZXkgJiYgdC52YWx1ZSA9PT0gdGFnLnZhbHVlKSkge1xuICAgICAgdW5pcXVlVGFncy5wdXNoKHRhZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdhcm5pbmdzSGFzaC5zZXQoYCR7dGFnLmtleX06JHt0YWcudmFsdWV9YCwgYER1cGxpY2F0ZSB0YWcgXCIke3RhZy5rZXl9OiR7dGFnLnZhbHVlfVwiYCk7XG4gICAgfVxuICAgIHJldHVybiB1bmlxdWVUYWdzO1xuICB9LCBbXSk7XG4gIGNvbnN0IHdhcm5pbmdzID0gQXJyYXkuZnJvbSh3YXJuaW5nc0hhc2gudmFsdWVzKCkpO1xuICByZXR1cm4geyB0YWdzLCB3YXJuaW5ncyB9O1xufVxuXG4vLyBleHBvcnRlZCBmb3IgdGVzdHNcbmV4cG9ydCBmdW5jdGlvbiBvcmRlclRhZ3Moc3BhblRhZ3M6IFRyYWNlS2V5VmFsdWVQYWlyW10sIHRvcFByZWZpeGVzPzogc3RyaW5nW10pIHtcbiAgY29uc3Qgb3JkZXJlZFRhZ3M6IFRyYWNlS2V5VmFsdWVQYWlyW10gPSBzcGFuVGFncz8uc2xpY2UoKSA/PyBbXTtcbiAgY29uc3QgdHAgPSAodG9wUHJlZml4ZXMgfHwgW10pLm1hcCgocDogc3RyaW5nKSA9PiBwLnRvTG93ZXJDYXNlKCkpO1xuXG4gIG9yZGVyZWRUYWdzLnNvcnQoKGEsIGIpID0+IHtcbiAgICBjb25zdCBhS2V5ID0gYS5rZXkudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBiS2V5ID0gYi5rZXkudG9Mb3dlckNhc2UoKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHAubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHAgPSB0cFtpXTtcbiAgICAgIGlmIChhS2V5LnN0YXJ0c1dpdGgocCkgJiYgIWJLZXkuc3RhcnRzV2l0aChwKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9XG4gICAgICBpZiAoIWFLZXkuc3RhcnRzV2l0aChwKSAmJiBiS2V5LnN0YXJ0c1dpdGgocCkpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGFLZXkgPiBiS2V5KSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgaWYgKGFLZXkgPCBiS2V5KSB7XG4gICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIHJldHVybiAwO1xuICB9KTtcblxuICByZXR1cm4gb3JkZXJlZFRhZ3M7XG59XG5cbi8qKlxuICogTk9URTogTXV0YXRlcyBgZGF0YWAgLSBUcmFuc2Zvcm0gdGhlIEhUVFAgcmVzcG9uc2UgZGF0YSBpbnRvIHRoZSBmb3JtIHRoZSBhcHBcbiAqIGdlbmVyYWxseSByZXF1aXJlcy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdHJhbnNmb3JtVHJhY2VEYXRhKGRhdGE6IFRyYWNlUmVzcG9uc2UgfCB1bmRlZmluZWQpOiBUcmFjZSB8IG51bGwge1xuICBpZiAoIWRhdGE/LnRyYWNlSUQpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB0cmFjZUlEID0gZGF0YS50cmFjZUlELnRvTG93ZXJDYXNlKCk7XG5cbiAgbGV0IHRyYWNlRW5kVGltZSA9IDA7XG4gIGxldCB0cmFjZVN0YXJ0VGltZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSO1xuICBjb25zdCBzcGFuSWRDb3VudHMgPSBuZXcgTWFwKCk7XG4gIGNvbnN0IHNwYW5NYXAgPSBuZXcgTWFwPHN0cmluZywgVHJhY2VTcGFuPigpO1xuICAvLyBmaWx0ZXIgb3V0IHNwYW5zIHdpdGggZW1wdHkgc3RhcnQgdGltZXNcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXBhcmFtLXJlYXNzaWduXG4gIGRhdGEuc3BhbnMgPSBkYXRhLnNwYW5zLmZpbHRlcigoc3BhbikgPT4gQm9vbGVhbihzcGFuLnN0YXJ0VGltZSkpO1xuXG4gIC8vIFNvcnQgcHJvY2VzcyB0YWdzXG4gIGRhdGEucHJvY2Vzc2VzID0gT2JqZWN0LmVudHJpZXMoZGF0YS5wcm9jZXNzZXMpLnJlZHVjZTxSZWNvcmQ8c3RyaW5nLCBUcmFjZVByb2Nlc3M+PigocHJvY2Vzc2VzLCBbaWQsIHByb2Nlc3NdKSA9PiB7XG4gICAgcHJvY2Vzc2VzW2lkXSA9IHtcbiAgICAgIC4uLnByb2Nlc3MsXG4gICAgICB0YWdzOiBvcmRlclRhZ3MocHJvY2Vzcy50YWdzKSxcbiAgICB9O1xuICAgIHJldHVybiBwcm9jZXNzZXM7XG4gIH0sIHt9KTtcblxuICBjb25zdCBtYXggPSBkYXRhLnNwYW5zLmxlbmd0aDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXg7IGkrKykge1xuICAgIGNvbnN0IHNwYW46IFRyYWNlU3BhbiA9IGRhdGEuc3BhbnNbaV0gYXMgVHJhY2VTcGFuO1xuICAgIGNvbnN0IHsgc3RhcnRUaW1lLCBkdXJhdGlvbiwgcHJvY2Vzc0lEIH0gPSBzcGFuO1xuXG4gICAgbGV0IHNwYW5JRCA9IHNwYW4uc3BhbklEO1xuICAgIC8vIGNoZWNrIGZvciBzdGFydCAvIGVuZCB0aW1lIGZvciB0aGUgdHJhY2VcbiAgICBpZiAoc3RhcnRUaW1lIDwgdHJhY2VTdGFydFRpbWUpIHtcbiAgICAgIHRyYWNlU3RhcnRUaW1lID0gc3RhcnRUaW1lO1xuICAgIH1cbiAgICBpZiAoc3RhcnRUaW1lICsgZHVyYXRpb24gPiB0cmFjZUVuZFRpbWUpIHtcbiAgICAgIHRyYWNlRW5kVGltZSA9IHN0YXJ0VGltZSArIGR1cmF0aW9uO1xuICAgIH1cbiAgICAvLyBtYWtlIHN1cmUgc3BhbiBJRHMgYXJlIHVuaXF1ZVxuICAgIGNvbnN0IGlkQ291bnQgPSBzcGFuSWRDb3VudHMuZ2V0KHNwYW5JRCk7XG4gICAgaWYgKGlkQ291bnQgIT0gbnVsbCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUud2FybihgRHVwZSBzcGFuSUQsICR7aWRDb3VudCArIDF9IHggJHtzcGFuSUR9YCwgc3Bhbiwgc3Bhbk1hcC5nZXQoc3BhbklEKSk7XG4gICAgICBpZiAoX2lzRXF1YWwoc3Bhbiwgc3Bhbk1hcC5nZXQoc3BhbklEKSkpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgY29uc29sZS53YXJuKCdcXHQgdHdvIHNwYW5zIHdpdGggc2FtZSBJRCBoYXZlIGBpc0VxdWFsKC4uLikgPT09IHRydWVgJyk7XG4gICAgICB9XG4gICAgICBzcGFuSWRDb3VudHMuc2V0KHNwYW5JRCwgaWRDb3VudCArIDEpO1xuICAgICAgc3BhbklEID0gYCR7c3BhbklEfV8ke2lkQ291bnR9YDtcbiAgICAgIHNwYW4uc3BhbklEID0gc3BhbklEO1xuICAgIH0gZWxzZSB7XG4gICAgICBzcGFuSWRDb3VudHMuc2V0KHNwYW5JRCwgMSk7XG4gICAgfVxuICAgIHNwYW4ucHJvY2VzcyA9IGRhdGEucHJvY2Vzc2VzW3Byb2Nlc3NJRF07XG4gICAgc3Bhbk1hcC5zZXQoc3BhbklELCBzcGFuKTtcbiAgfVxuICAvLyB0cmVlIGlzIG5lY2Vzc2FyeSB0byBzb3J0IHRoZSBzcGFucywgc28gY2hpbGRyZW4gZm9sbG93IHBhcmVudHMsIGFuZFxuICAvLyBzaWJsaW5ncyBhcmUgc29ydGVkIGJ5IHN0YXJ0IHRpbWVcbiAgY29uc3QgdHJlZSA9IGdldFRyYWNlU3Bhbklkc0FzVHJlZShkYXRhKTtcbiAgY29uc3Qgc3BhbnM6IFRyYWNlU3BhbltdID0gW107XG4gIGNvbnN0IHN2Y0NvdW50czogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuXG4gIC8vIEVzbGludCBjb21wbGFpbnMgYWJvdXQgbnVtYmVyIHR5cGUgbm90IG5lZWRlZCBidXQgdGhlbiBUUyBjb21wbGFpbnMgaXQgaXMgaW1wbGljaXRseSBhbnkuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8taW5mZXJyYWJsZS10eXBlc1xuICB0cmVlLndhbGsoKHNwYW5JRDogc3RyaW5nIHwgbnVtYmVyIHwgdW5kZWZpbmVkLCBub2RlOiBUcmVlTm9kZSwgZGVwdGg6IG51bWJlciA9IDApID0+IHtcbiAgICBpZiAoc3BhbklEID09PSAnX19yb290X18nKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygc3BhbklEICE9PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBzcGFuID0gc3Bhbk1hcC5nZXQoc3BhbklEKSBhcyBUcmFjZVNwYW47XG4gICAgaWYgKCFzcGFuKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHsgc2VydmljZU5hbWUgfSA9IHNwYW4ucHJvY2VzcztcbiAgICBzdmNDb3VudHNbc2VydmljZU5hbWVdID0gKHN2Y0NvdW50c1tzZXJ2aWNlTmFtZV0gfHwgMCkgKyAxO1xuICAgIHNwYW4ucmVsYXRpdmVTdGFydFRpbWUgPSBzcGFuLnN0YXJ0VGltZSAtIHRyYWNlU3RhcnRUaW1lO1xuICAgIHNwYW4uZGVwdGggPSBkZXB0aCAtIDE7XG4gICAgc3Bhbi5oYXNDaGlsZHJlbiA9IG5vZGUuY2hpbGRyZW4ubGVuZ3RoID4gMDtcbiAgICBzcGFuLmNoaWxkU3BhbkNvdW50ID0gbm9kZS5jaGlsZHJlbi5sZW5ndGg7XG4gICAgc3Bhbi53YXJuaW5ncyA9IHNwYW4ud2FybmluZ3MgfHwgW107XG4gICAgc3Bhbi50YWdzID0gc3Bhbi50YWdzIHx8IFtdO1xuICAgIHNwYW4ucmVmZXJlbmNlcyA9IHNwYW4ucmVmZXJlbmNlcyB8fCBbXTtcbiAgICBjb25zdCB0YWdzSW5mbyA9IGRlZHVwbGljYXRlVGFncyhzcGFuLnRhZ3MpO1xuICAgIHNwYW4udGFncyA9IG9yZGVyVGFncyh0YWdzSW5mby50YWdzLCBnZXRDb25maWdWYWx1ZSgndG9wVGFnUHJlZml4ZXMnKSk7XG4gICAgc3Bhbi53YXJuaW5ncyA9IHNwYW4ud2FybmluZ3MuY29uY2F0KHRhZ3NJbmZvLndhcm5pbmdzKTtcbiAgICBzcGFuLnJlZmVyZW5jZXMuZm9yRWFjaCgocmVmLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3QgcmVmU3BhbiA9IHNwYW5NYXAuZ2V0KHJlZi5zcGFuSUQpIGFzIFRyYWNlU3BhbjtcbiAgICAgIGlmIChyZWZTcGFuKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgICByZWYuc3BhbiA9IHJlZlNwYW47XG4gICAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgICAvLyBEb24ndCB0YWtlIGludG8gYWNjb3VudCB0aGUgcGFyZW50LCBqdXN0IG90aGVyIHJlZmVyZW5jZXMuXG4gICAgICAgICAgcmVmU3Bhbi5zdWJzaWRpYXJpbHlSZWZlcmVuY2VkQnkgPSByZWZTcGFuLnN1YnNpZGlhcmlseVJlZmVyZW5jZWRCeSB8fCBbXTtcbiAgICAgICAgICByZWZTcGFuLnN1YnNpZGlhcmlseVJlZmVyZW5jZWRCeS5wdXNoKHtcbiAgICAgICAgICAgIHNwYW5JRCxcbiAgICAgICAgICAgIHRyYWNlSUQsXG4gICAgICAgICAgICBzcGFuLFxuICAgICAgICAgICAgcmVmVHlwZTogcmVmLnJlZlR5cGUsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICBzcGFucy5wdXNoKHNwYW4pO1xuICB9KTtcbiAgY29uc3QgdHJhY2VOYW1lID0gZ2V0VHJhY2VOYW1lKHNwYW5zKTtcbiAgY29uc3Qgc2VydmljZXMgPSBPYmplY3Qua2V5cyhzdmNDb3VudHMpLm1hcCgobmFtZSkgPT4gKHsgbmFtZSwgbnVtYmVyT2ZTcGFuczogc3ZjQ291bnRzW25hbWVdIH0pKTtcbiAgcmV0dXJuIHtcbiAgICBzZXJ2aWNlcyxcbiAgICBzcGFucyxcbiAgICB0cmFjZUlELFxuICAgIHRyYWNlTmFtZSxcbiAgICAvLyBjYW4ndCB1c2Ugc3ByZWFkIG9wZXJhdG9yIGZvciBpbnRlcnNlY3Rpb24gdHlwZXNcbiAgICAvLyByZXBsOiBodHRwczovL2dvby5nbC80WjIzTUpcbiAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL2ZhY2Vib29rL2Zsb3cvaXNzdWVzLzE1MTFcbiAgICBwcm9jZXNzZXM6IGRhdGEucHJvY2Vzc2VzLFxuICAgIGR1cmF0aW9uOiB0cmFjZUVuZFRpbWUgLSB0cmFjZVN0YXJ0VGltZSxcbiAgICBzdGFydFRpbWU6IHRyYWNlU3RhcnRUaW1lLFxuICAgIGVuZFRpbWU6IHRyYWNlRW5kVGltZSxcbiAgfTtcbn1cbiJdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFNBQVNBLE9BQU8sSUFBSUMsUUFBUSxRQUFRLFFBQVE7O0FBRTVDO0FBQ0EsU0FBU0MscUJBQXFCLFFBQVEsb0JBQW9COztB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