import _inheritsLoose from "@babel/runtime/helpers/inheritsLoose";
import _taggedTemplateLiteralLoose from "@babel/runtime/helpers/taggedTemplateLiteralLoose";
var _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8;
// Copyright (c) 2017 Uber Technologies, Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

import { css, cx } from '@emotion/css';
import * as React from 'react';
import { stylesFactory } from '@grafana/ui';
import DraggableManager from '../../utils/DraggableManager';
import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
// exported for testing
export var getStyles = stylesFactory(function () {
  return {
    TimelineViewingLayer: css(_templateObject || (_templateObject = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayer;\n      bottom: 0;\n      cursor: vertical-text;\n      left: 0;\n      position: absolute;\n      right: 0;\n      top: 0;\n    "]))),
    TimelineViewingLayerCursorGuide: css(_templateObject2 || (_templateObject2 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerCursorGuide;\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      width: 1px;\n      background-color: red;\n    "]))),
    TimelineViewingLayerDragged: css(_templateObject3 || (_templateObject3 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDragged;\n      position: absolute;\n      top: 0;\n      bottom: 0;\n    "]))),
    TimelineViewingLayerDraggedDraggingLeft: css(_templateObject4 || (_templateObject4 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedDraggingLeft;\n      border-left: 1px solid;\n    "]))),
    TimelineViewingLayerDraggedDraggingRight: css(_templateObject5 || (_templateObject5 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedDraggingRight;\n      border-right: 1px solid;\n    "]))),
    TimelineViewingLayerDraggedShiftDrag: css(_templateObject6 || (_templateObject6 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedShiftDrag;\n      background-color: rgba(68, 68, 255, 0.2);\n      border-color: #44f;\n    "]))),
    TimelineViewingLayerDraggedReframeDrag: css(_templateObject7 || (_templateObject7 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerDraggedReframeDrag;\n      background-color: rgba(255, 68, 68, 0.2);\n      border-color: #f44;\n    "]))),
    TimelineViewingLayerFullOverlay: css(_templateObject8 || (_templateObject8 = _taggedTemplateLiteralLoose(["\n      label: TimelineViewingLayerFullOverlay;\n      bottom: 0;\n      cursor: col-resize;\n      left: 0;\n      position: fixed;\n      right: 0;\n      top: 0;\n      user-select: none;\n    "])))
  };
});
function isOutOfView(layout) {
  return Reflect.has(layout, 'isOutOfView');
}

/**
 * Map from a sub range to the greater view range, e.g, when the view range is
 * the middle half ([0.25, 0.75]), a value of 0.25 befomes 3/8.
 * @returns {number}
 */
function mapFromViewSubRange(viewStart, viewEnd, value) {
  return viewStart + value * (viewEnd - viewStart);
}

/**
 * Map a value from the view ([0, 1]) to a sub-range, e.g, when the view range is
 * the middle half ([0.25, 0.75]), a value of 3/8 becomes 1/4.
 * @returns {number}
 */
function mapToViewSubRange(viewStart, viewEnd, value) {
  return (value - viewStart) / (viewEnd - viewStart);
}

/**
 * Get the layout for the "next" view range time, e.g. the difference from the
 * drag start and the drag end. This is driven by `shiftStart`, `shiftEnd` or
 * `reframe` on `props.viewRangeTime`, not by the current state of the
 * component. So, it reflects in-progress dragging from the span minimap.
 */
function getNextViewLayout(start, position) {
  var _ref = start < position ? [start, position] : [position, start],
    left = _ref[0],
    right = _ref[1];
  if (left >= 1 || right <= 0) {
    return {
      isOutOfView: true
    };
  }
  if (left < 0) {
    left = 0;
  }
  if (right > 1) {
    right = 1;
  }
  return {
    isDraggingLeft: start > position,
    left: left * 100 + "%",
    width: (right - left) * 100 + "%"
  };
}

/**
 * Render the visual indication of the "next" view range.
 */
function getMarkers(viewStart, viewEnd, from, to, isShift) {
  var _cx;
  var mappedFrom = mapToViewSubRange(viewStart, viewEnd, from);
  var mappedTo = mapToViewSubRange(viewStart, viewEnd, to);
  var layout = getNextViewLayout(mappedFrom, mappedTo);
  if (isOutOfView(layout)) {
    return null;
  }
  var isDraggingLeft = layout.isDraggingLeft,
    left = layout.left,
    width = layout.width;
  var styles = getStyles();
  var cls = cx((_cx = {}, _cx[styles.TimelineViewingLayerDraggedDraggingRight] = !isDraggingLeft, _cx[styles.TimelineViewingLayerDraggedReframeDrag] = !isShift, _cx[styles.TimelineViewingLayerDraggedShiftDrag] = isShift, _cx));
  return /*#__PURE__*/_jsx("div", {
    className: cx(styles.TimelineViewingLayerDragged, styles.TimelineViewingLayerDraggedDraggingLeft, cls),
    style: {
      left: left,
      width: width
    },
    "data-testid": "Dragged"
  });
}

/**
 * `TimelineViewingLayer` is rendered on top of the TimelineHeaderRow time
 * labels; it handles showing the current view range and handles mouse UX for
 * modifying it.
 */
var TimelineViewingLayer = /*#__PURE__*/function (_React$PureComponent) {
  function TimelineViewingLayer(props) {
    var _this;
    _this = _React$PureComponent.call(this, props) || this;
    _this._setRoot = function (elm) {
      _this._root = elm;
    };
    _this._getDraggingBounds = function () {
      if (!_this._root) {
        throw new Error('invalid state');
      }
      var _this$_root$getBoundi = _this._root.getBoundingClientRect(),
        clientXLeft = _this$_root$getBoundi.left,
        width = _this$_root$getBoundi.width;
      return {
        clientXLeft: clientXLeft,
        width: width
      };
    };
    _this._handleReframeMouseMove = function (_ref2) {
      var value = _ref2.value;
      var _this$props$viewRange = _this.props.viewRangeTime.current,
        viewStart = _this$props$viewRange[0],
        viewEnd = _this$props$viewRange[1];
      var cursor = mapFromViewSubRange(viewStart, viewEnd, value);
      _this.props.updateNextViewRangeTime({
        cursor: cursor
      });
    };
    _this._handleReframeMouseLeave = function () {
      _this.props.updateNextViewRangeTime({
        cursor: undefined
      });
    };
    _this._handleReframeDragUpdate = function (_ref3) {
      var value = _ref3.value;
      var _this$props$viewRange2 = _this.props.viewRangeTime,
        current = _this$props$viewRange2.current,
        reframe = _this$props$viewRange2.reframe;
      var viewStart = current[0],
        viewEnd = current[1];
      var shift = mapFromViewSubRange(viewStart, viewEnd, value);
      var anchor = reframe ? reframe.anchor : shift;
      var update = {
        reframe: {
          anchor: anchor,
          shift: shift
        }
      };
      _this.props.updateNextViewRangeTime(update);
    };
    _this._handleReframeDragEnd = function (_ref4) {
      var manager = _ref4.manager,
        value = _ref4.value;
      var _this$props$viewRange3 = _this.props.viewRangeTime,
        current = _this$props$viewRange3.current,
        reframe = _this$props$viewRange3.reframe;
      var viewStart = current[0],
        viewEnd = current[1];
      var shift = mapFromViewSubRange(viewStart, viewEnd, value);
      var anchor = reframe ? reframe.anchor : shift;
      var _ref5 = shift < anchor ? [shift, anchor] : [anchor, shift],
        start = _ref5[0],
        end = _ref5[1];
      manager.resetBounds();
      _this.props.updateViewRangeTime(start, end, 'timeline-header');
    };
    _this._draggerReframe = new DraggableManager({
      getBounds: _this._getDraggingBounds,
      onDragEnd: _this._handleReframeDragEnd,
      onDragMove: _this._handleReframeDragUpdate,
      onDragStart: _this._handleReframeDragUpdate,
      onMouseLeave: _this._handleReframeMouseLeave,
      onMouseMove: _this._handleReframeMouseMove
    });
    _this._root = undefined;
    return _this;
  }
  _inheritsLoose(TimelineViewingLayer, _React$PureComponent);
  var _proto = TimelineViewingLayer.prototype;
  _proto.UNSAFE_componentWillReceiveProps = function UNSAFE_componentWillReceiveProps(nextProps) {
    var boundsInvalidator = this.props.boundsInvalidator;
    if (boundsInvalidator !== nextProps.boundsInvalidator) {
      this._draggerReframe.resetBounds();
    }
  };
  _proto.componentWillUnmount = function componentWillUnmount() {
    this._draggerReframe.dispose();
  };
  _proto.render = function render() {
    var viewRangeTime = this.props.viewRangeTime;
    var current = viewRangeTime.current,
      cursor = viewRangeTime.cursor,
      reframe = viewRangeTime.reframe,
      shiftEnd = viewRangeTime.shiftEnd,
      shiftStart = viewRangeTime.shiftStart;
    var viewStart = current[0],
      viewEnd = current[1];
    var haveNextTimeRange = reframe != null || shiftEnd != null || shiftStart != null;
    var cusrorPosition;
    if (!haveNextTimeRange && cursor != null && cursor >= viewStart && cursor <= viewEnd) {
      cusrorPosition = mapToViewSubRange(viewStart, viewEnd, cursor) * 100 + "%";
    }
    var styles = getStyles();
    return /*#__PURE__*/_jsxs("div", {
      "aria-hidden": true,
      className: styles.TimelineViewingLayer,
      ref: this._setRoot,
      onMouseDown: this._draggerReframe.handleMouseDown,
      onMouseLeave: this._draggerReframe.handleMouseLeave,
      onMouseMove: this._draggerReframe.handleMouseMove,
      "data-testid": "TimelineViewingLayer",
      children: [cusrorPosition != null && /*#__PURE__*/_jsx("div", {
        className: styles.TimelineViewingLayerCursorGuide,
        style: {
          left: cusrorPosition
        },
        "data-testid": "TimelineViewingLayer--cursorGuide"
      }), reframe != null && getMarkers(viewStart, viewEnd, reframe.anchor, reframe.shift, false), shiftEnd != null && getMarkers(viewStart, viewEnd, viewEnd, shiftEnd, true), shiftStart != null && getMarkers(viewStart, viewEnd, viewStart, shiftStart, true)]
    });
  };
  return TimelineViewingLayer;
}(React.PureComponent);
export { TimelineViewingLayer as default };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjc3MiLCJjeCIsIlJlYWN0Iiwic3R5bGVzRmFjdG9yeSIsIkRyYWdnYWJsZU1hbmFnZXIiLCJqc3giLCJfanN4IiwianN4cyIsIl9qc3hzIiwiZ2V0U3R5bGVzIiwiVGltZWxpbmVWaWV3aW5nTGF5ZXIiLCJfdGVtcGxhdGVPYmplY3QiLCJfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsTG9vc2UiLCJUaW1lbGluZVZpZXdpbmdMYXllckN1cnNvckd1aWRlIiwiX3RlbXBsYXRlT2JqZWN0MiIsIlRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZCIsIl90ZW1wbGF0ZU9iamVjdDMiLCJUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWREcmFnZ2luZ0xlZnQiLCJfdGVtcGxhdGVPYmplY3Q0IiwiVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkRHJhZ2dpbmdSaWdodCIsIl90ZW1wbGF0ZU9iamVjdDUiLCJUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWRTaGlmdERyYWciLCJfdGVtcGxhdGVPYmplY3Q2IiwiVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkUmVmcmFtZURyYWciLCJfdGVtcGxhdGVPYmplY3Q3IiwiVGltZWxpbmVWaWV3aW5nTGF5ZXJGdWxsT3ZlcmxheSIsIl90ZW1wbGF0ZU9iamVjdDgiLCJpc091dE9mVmlldyIsImxheW91dCIsIlJlZmxlY3QiLCJoYXMiLCJtYXBGcm9tVmlld1N1YlJhbmdlIiwidmlld1N0YXJ0Iiwidmlld0VuZCIsInZhbHVlIiwibWFwVG9WaWV3U3ViUmFuZ2UiLCJnZXROZXh0Vmlld0xheW91dCIsInN0YXJ0IiwicG9zaXRpb24iLCJfcmVmIiwibGVmdCIsInJpZ2h0IiwiaXNEcmFnZ2luZ0xlZnQiLCJ3aWR0aCIsImdldE1hcmtlcnMiLCJmcm9tIiwidG8iLCJpc1NoaWZ0IiwiX2N4IiwibWFwcGVkRnJvbSIsIm1hcHBlZFRvIiwic3R5bGVzIiwiY2xzIiwiY2xhc3NOYW1lIiwic3R5bGUiLCJfUmVhY3QkUHVyZUNvbXBvbmVudCIsInByb3BzIiwiX3RoaXMiLCJjYWxsIiwiX3NldFJvb3QiLCJlbG0iLCJfcm9vdCIsIl9nZXREcmFnZ2luZ0JvdW5kcyIsIkVycm9yIiwiX3RoaXMkX3Jvb3QkZ2V0Qm91bmRpIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiY2xpZW50WExlZnQiLCJfaGFuZGxlUmVmcmFtZU1vdXNlTW92ZSIsIl9yZWYyIiwiX3RoaXMkcHJvcHMkdmlld1JhbmdlIiwidmlld1JhbmdlVGltZSIsImN1cnJlbnQiLCJjdXJzb3IiLCJ1cGRhdGVOZXh0Vmlld1JhbmdlVGltZSIsIl9oYW5kbGVSZWZyYW1lTW91c2VMZWF2ZSIsInVuZGVmaW5lZCIsIl9oYW5kbGVSZWZyYW1lRHJhZ1VwZGF0ZSIsIl9yZWYzIiwiX3RoaXMkcHJvcHMkdmlld1JhbmdlMiIsInJlZnJhbWUiLCJzaGlmdCIsImFuY2hvciIsInVwZGF0ZSIsIl9oYW5kbGVSZWZyYW1lRHJhZ0VuZCIsIl9yZWY0IiwibWFuYWdlciIsIl90aGlzJHByb3BzJHZpZXdSYW5nZTMiLCJfcmVmNSIsImVuZCIsInJlc2V0Qm91bmRzIiwidXBkYXRlVmlld1JhbmdlVGltZSIsIl9kcmFnZ2VyUmVmcmFtZSIsImdldEJvdW5kcyIsIm9uRHJhZ0VuZCIsIm9uRHJhZ01vdmUiLCJvbkRyYWdTdGFydCIsIm9uTW91c2VMZWF2ZSIsIm9uTW91c2VNb3ZlIiwiX2luaGVyaXRzTG9vc2UiLCJfcHJvdG8iLCJwcm90b3R5cGUiLCJVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyIsIm5leHRQcm9wcyIsImJvdW5kc0ludmFsaWRhdG9yIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJkaXNwb3NlIiwicmVuZGVyIiwic2hpZnRFbmQiLCJzaGlmdFN0YXJ0IiwiaGF2ZU5leHRUaW1lUmFuZ2UiLCJjdXNyb3JQb3NpdGlvbiIsInJlZiIsIm9uTW91c2VEb3duIiwiaGFuZGxlTW91c2VEb3duIiwiaGFuZGxlTW91c2VMZWF2ZSIsImhhbmRsZU1vdXNlTW92ZSIsImNoaWxkcmVuIiwiUHVyZUNvbXBvbmVudCIsImRlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvVHJhY2VUaW1lbGluZVZpZXdlci9UaW1lbGluZUhlYWRlclJvdy9UaW1lbGluZVZpZXdpbmdMYXllci50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE3IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy9cbi8vIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCB7IGNzcywgY3ggfSBmcm9tICdAZW1vdGlvbi9jc3MnO1xuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgeyBzdHlsZXNGYWN0b3J5IH0gZnJvbSAnQGdyYWZhbmEvdWknO1xuXG5pbXBvcnQgeyBUTmlsIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuaW1wb3J0IERyYWdnYWJsZU1hbmFnZXIsIHsgRHJhZ2dhYmxlQm91bmRzLCBEcmFnZ2luZ1VwZGF0ZSB9IGZyb20gJy4uLy4uL3V0aWxzL0RyYWdnYWJsZU1hbmFnZXInO1xuaW1wb3J0IHsgVFVwZGF0ZVZpZXdSYW5nZVRpbWVGdW5jdGlvbiwgVmlld1JhbmdlVGltZSwgVmlld1JhbmdlVGltZVVwZGF0ZSB9IGZyb20gJy4uL3R5cGVzJztcblxuLy8gZXhwb3J0ZWQgZm9yIHRlc3RpbmdcbmV4cG9ydCBjb25zdCBnZXRTdHlsZXMgPSBzdHlsZXNGYWN0b3J5KCgpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBUaW1lbGluZVZpZXdpbmdMYXllcjogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyO1xuICAgICAgYm90dG9tOiAwO1xuICAgICAgY3Vyc29yOiB2ZXJ0aWNhbC10ZXh0O1xuICAgICAgbGVmdDogMDtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIHJpZ2h0OiAwO1xuICAgICAgdG9wOiAwO1xuICAgIGAsXG4gICAgVGltZWxpbmVWaWV3aW5nTGF5ZXJDdXJzb3JHdWlkZTogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyQ3Vyc29yR3VpZGU7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICB0b3A6IDA7XG4gICAgICBib3R0b206IDA7XG4gICAgICBsZWZ0OiAwO1xuICAgICAgd2lkdGg6IDFweDtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6IHJlZDtcbiAgICBgLFxuICAgIFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZDogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZDtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIHRvcDogMDtcbiAgICAgIGJvdHRvbTogMDtcbiAgICBgLFxuICAgIFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZERyYWdnaW5nTGVmdDogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZERyYWdnaW5nTGVmdDtcbiAgICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQ7XG4gICAgYCxcbiAgICBUaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWREcmFnZ2luZ1JpZ2h0OiBjc3NgXG4gICAgICBsYWJlbDogVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkRHJhZ2dpbmdSaWdodDtcbiAgICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkO1xuICAgIGAsXG4gICAgVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkU2hpZnREcmFnOiBjc3NgXG4gICAgICBsYWJlbDogVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkU2hpZnREcmFnO1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg2OCwgNjgsIDI1NSwgMC4yKTtcbiAgICAgIGJvcmRlci1jb2xvcjogIzQ0ZjtcbiAgICBgLFxuICAgIFRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZFJlZnJhbWVEcmFnOiBjc3NgXG4gICAgICBsYWJlbDogVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkUmVmcmFtZURyYWc7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgNjgsIDY4LCAwLjIpO1xuICAgICAgYm9yZGVyLWNvbG9yOiAjZjQ0O1xuICAgIGAsXG4gICAgVGltZWxpbmVWaWV3aW5nTGF5ZXJGdWxsT3ZlcmxheTogY3NzYFxuICAgICAgbGFiZWw6IFRpbWVsaW5lVmlld2luZ0xheWVyRnVsbE92ZXJsYXk7XG4gICAgICBib3R0b206IDA7XG4gICAgICBjdXJzb3I6IGNvbC1yZXNpemU7XG4gICAgICBsZWZ0OiAwO1xuICAgICAgcG9zaXRpb246IGZpeGVkO1xuICAgICAgcmlnaHQ6IDA7XG4gICAgICB0b3A6IDA7XG4gICAgICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgICBgLFxuICB9O1xufSk7XG5cbmV4cG9ydCB0eXBlIFRpbWVsaW5lVmlld2luZ0xheWVyUHJvcHMgPSB7XG4gIC8qKlxuICAgKiBgYm91bmRzSW52YWxpZGF0b3JgIGlzIGFuIGFyYml0cmFyeSBwcm9wIHRoYXQgbGV0cyB0aGUgY29tcG9uZW50IGtub3cgdGhlXG4gICAqIGJvdW5kcyBmb3IgZHJhZ2dpbmcgbmVlZCB0byBiZSByZWNhbGN1bGF0ZWQuIEluIHByYWN0aWNlLCB0aGUgbmFtZSBjb2x1bW5cbiAgICogd2lkdGggc2VydmVzIGZpbmUgZm9yIHRoaXMuXG4gICAqL1xuICBib3VuZHNJbnZhbGlkYXRvcjogYW55IHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgdXBkYXRlTmV4dFZpZXdSYW5nZVRpbWU6ICh1cGRhdGU6IFZpZXdSYW5nZVRpbWVVcGRhdGUpID0+IHZvaWQ7XG4gIHVwZGF0ZVZpZXdSYW5nZVRpbWU6IFRVcGRhdGVWaWV3UmFuZ2VUaW1lRnVuY3Rpb247XG4gIHZpZXdSYW5nZVRpbWU6IFZpZXdSYW5nZVRpbWU7XG59O1xuXG50eXBlIFREcmFnZ2luZ0xlZnRMYXlvdXQgPSB7XG4gIGlzRHJhZ2dpbmdMZWZ0OiBib29sZWFuO1xuICBsZWZ0OiBzdHJpbmc7XG4gIHdpZHRoOiBzdHJpbmc7XG59O1xuXG50eXBlIFRPdXRPZlZpZXdMYXlvdXQgPSB7XG4gIGlzT3V0T2ZWaWV3OiB0cnVlO1xufTtcblxuZnVuY3Rpb24gaXNPdXRPZlZpZXcobGF5b3V0OiBURHJhZ2dpbmdMZWZ0TGF5b3V0IHwgVE91dE9mVmlld0xheW91dCk6IGxheW91dCBpcyBUT3V0T2ZWaWV3TGF5b3V0IHtcbiAgcmV0dXJuIFJlZmxlY3QuaGFzKGxheW91dCwgJ2lzT3V0T2ZWaWV3Jyk7XG59XG5cbi8qKlxuICogTWFwIGZyb20gYSBzdWIgcmFuZ2UgdG8gdGhlIGdyZWF0ZXIgdmlldyByYW5nZSwgZS5nLCB3aGVuIHRoZSB2aWV3IHJhbmdlIGlzXG4gKiB0aGUgbWlkZGxlIGhhbGYgKFswLjI1LCAwLjc1XSksIGEgdmFsdWUgb2YgMC4yNSBiZWZvbWVzIDMvOC5cbiAqIEByZXR1cm5zIHtudW1iZXJ9XG4gKi9cbmZ1bmN0aW9uIG1hcEZyb21WaWV3U3ViUmFuZ2Uodmlld1N0YXJ0OiBudW1iZXIsIHZpZXdFbmQ6IG51bWJlciwgdmFsdWU6IG51bWJlcikge1xuICByZXR1cm4gdmlld1N0YXJ0ICsgdmFsdWUgKiAodmlld0VuZCAtIHZpZXdTdGFydCk7XG59XG5cbi8qKlxuICogTWFwIGEgdmFsdWUgZnJvbSB0aGUgdmlldyAoWzAsIDFdKSB0byBhIHN1Yi1yYW5nZSwgZS5nLCB3aGVuIHRoZSB2aWV3IHJhbmdlIGlzXG4gKiB0aGUgbWlkZGxlIGhhbGYgKFswLjI1LCAwLjc1XSksIGEgdmFsdWUgb2YgMy84IGJlY29tZXMgMS80LlxuICogQHJldHVybnMge251bWJlcn1cbiAqL1xuZnVuY3Rpb24gbWFwVG9WaWV3U3ViUmFuZ2Uodmlld1N0YXJ0OiBudW1iZXIsIHZpZXdFbmQ6IG51bWJlciwgdmFsdWU6IG51bWJlcikge1xuICByZXR1cm4gKHZhbHVlIC0gdmlld1N0YXJ0KSAvICh2aWV3RW5kIC0gdmlld1N0YXJ0KTtcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGxheW91dCBmb3IgdGhlIFwibmV4dFwiIHZpZXcgcmFuZ2UgdGltZSwgZS5nLiB0aGUgZGlmZmVyZW5jZSBmcm9tIHRoZVxuICogZHJhZyBzdGFydCBhbmQgdGhlIGRyYWcgZW5kLiBUaGlzIGlzIGRyaXZlbiBieSBgc2hpZnRTdGFydGAsIGBzaGlmdEVuZGAgb3JcbiAqIGByZWZyYW1lYCBvbiBgcHJvcHMudmlld1JhbmdlVGltZWAsIG5vdCBieSB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGVcbiAqIGNvbXBvbmVudC4gU28sIGl0IHJlZmxlY3RzIGluLXByb2dyZXNzIGRyYWdnaW5nIGZyb20gdGhlIHNwYW4gbWluaW1hcC5cbiAqL1xuZnVuY3Rpb24gZ2V0TmV4dFZpZXdMYXlvdXQoc3RhcnQ6IG51bWJlciwgcG9zaXRpb246IG51bWJlcik6IFREcmFnZ2luZ0xlZnRMYXlvdXQgfCBUT3V0T2ZWaWV3TGF5b3V0IHtcbiAgbGV0IFtsZWZ0LCByaWdodF0gPSBzdGFydCA8IHBvc2l0aW9uID8gW3N0YXJ0LCBwb3NpdGlvbl0gOiBbcG9zaXRpb24sIHN0YXJ0XTtcbiAgaWYgKGxlZnQgPj0gMSB8fCByaWdodCA8PSAwKSB7XG4gICAgcmV0dXJuIHsgaXNPdXRPZlZpZXc6IHRydWUgfTtcbiAgfVxuICBpZiAobGVmdCA8IDApIHtcbiAgICBsZWZ0ID0gMDtcbiAgfVxuICBpZiAocmlnaHQgPiAxKSB7XG4gICAgcmlnaHQgPSAxO1xuICB9XG4gIHJldHVybiB7XG4gICAgaXNEcmFnZ2luZ0xlZnQ6IHN0YXJ0ID4gcG9zaXRpb24sXG4gICAgbGVmdDogYCR7bGVmdCAqIDEwMH0lYCxcbiAgICB3aWR0aDogYCR7KHJpZ2h0IC0gbGVmdCkgKiAxMDB9JWAsXG4gIH07XG59XG5cbi8qKlxuICogUmVuZGVyIHRoZSB2aXN1YWwgaW5kaWNhdGlvbiBvZiB0aGUgXCJuZXh0XCIgdmlldyByYW5nZS5cbiAqL1xuZnVuY3Rpb24gZ2V0TWFya2Vycyh2aWV3U3RhcnQ6IG51bWJlciwgdmlld0VuZDogbnVtYmVyLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIsIGlzU2hpZnQ6IGJvb2xlYW4pOiBSZWFjdC5SZWFjdE5vZGUge1xuICBjb25zdCBtYXBwZWRGcm9tID0gbWFwVG9WaWV3U3ViUmFuZ2Uodmlld1N0YXJ0LCB2aWV3RW5kLCBmcm9tKTtcbiAgY29uc3QgbWFwcGVkVG8gPSBtYXBUb1ZpZXdTdWJSYW5nZSh2aWV3U3RhcnQsIHZpZXdFbmQsIHRvKTtcbiAgY29uc3QgbGF5b3V0ID0gZ2V0TmV4dFZpZXdMYXlvdXQobWFwcGVkRnJvbSwgbWFwcGVkVG8pO1xuICBpZiAoaXNPdXRPZlZpZXcobGF5b3V0KSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHsgaXNEcmFnZ2luZ0xlZnQsIGxlZnQsIHdpZHRoIH0gPSBsYXlvdXQ7XG4gIGNvbnN0IHN0eWxlcyA9IGdldFN0eWxlcygpO1xuICBjb25zdCBjbHMgPSBjeCh7XG4gICAgW3N0eWxlcy5UaW1lbGluZVZpZXdpbmdMYXllckRyYWdnZWREcmFnZ2luZ1JpZ2h0XTogIWlzRHJhZ2dpbmdMZWZ0LFxuICAgIFtzdHlsZXMuVGltZWxpbmVWaWV3aW5nTGF5ZXJEcmFnZ2VkUmVmcmFtZURyYWddOiAhaXNTaGlmdCxcbiAgICBbc3R5bGVzLlRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZFNoaWZ0RHJhZ106IGlzU2hpZnQsXG4gIH0pO1xuICByZXR1cm4gKFxuICAgIDxkaXZcbiAgICAgIGNsYXNzTmFtZT17Y3goc3R5bGVzLlRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZCwgc3R5bGVzLlRpbWVsaW5lVmlld2luZ0xheWVyRHJhZ2dlZERyYWdnaW5nTGVmdCwgY2xzKX1cbiAgICAgIHN0eWxlPXt7IGxlZnQsIHdpZHRoIH19XG4gICAgICBkYXRhLXRlc3RpZD1cIkRyYWdnZWRcIlxuICAgIC8+XG4gICk7XG59XG5cbi8qKlxuICogYFRpbWVsaW5lVmlld2luZ0xheWVyYCBpcyByZW5kZXJlZCBvbiB0b3Agb2YgdGhlIFRpbWVsaW5lSGVhZGVyUm93IHRpbWVcbiAqIGxhYmVsczsgaXQgaGFuZGxlcyBzaG93aW5nIHRoZSBjdXJyZW50IHZpZXcgcmFuZ2UgYW5kIGhhbmRsZXMgbW91c2UgVVggZm9yXG4gKiBtb2RpZnlpbmcgaXQuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRpbWVsaW5lVmlld2luZ0xheWVyIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxUaW1lbGluZVZpZXdpbmdMYXllclByb3BzPiB7XG4gIF9kcmFnZ2VyUmVmcmFtZTogRHJhZ2dhYmxlTWFuYWdlcjtcbiAgX3Jvb3Q6IEVsZW1lbnQgfCBUTmlsO1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBUaW1lbGluZVZpZXdpbmdMYXllclByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuX2RyYWdnZXJSZWZyYW1lID0gbmV3IERyYWdnYWJsZU1hbmFnZXIoe1xuICAgICAgZ2V0Qm91bmRzOiB0aGlzLl9nZXREcmFnZ2luZ0JvdW5kcyxcbiAgICAgIG9uRHJhZ0VuZDogdGhpcy5faGFuZGxlUmVmcmFtZURyYWdFbmQsXG4gICAgICBvbkRyYWdNb3ZlOiB0aGlzLl9oYW5kbGVSZWZyYW1lRHJhZ1VwZGF0ZSxcbiAgICAgIG9uRHJhZ1N0YXJ0OiB0aGlzLl9oYW5kbGVSZWZyYW1lRHJhZ1VwZGF0ZSxcbiAgICAgIG9uTW91c2VMZWF2ZTogdGhpcy5faGFuZGxlUmVmcmFtZU1vdXNlTGVhdmUsXG4gICAgICBvbk1vdXNlTW92ZTogdGhpcy5faGFuZGxlUmVmcmFtZU1vdXNlTW92ZSxcbiAgICB9KTtcbiAgICB0aGlzLl9yb290ID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBUaW1lbGluZVZpZXdpbmdMYXllclByb3BzKSB7XG4gICAgY29uc3QgeyBib3VuZHNJbnZhbGlkYXRvciB9ID0gdGhpcy5wcm9wcztcbiAgICBpZiAoYm91bmRzSW52YWxpZGF0b3IgIT09IG5leHRQcm9wcy5ib3VuZHNJbnZhbGlkYXRvcikge1xuICAgICAgdGhpcy5fZHJhZ2dlclJlZnJhbWUucmVzZXRCb3VuZHMoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLl9kcmFnZ2VyUmVmcmFtZS5kaXNwb3NlKCk7XG4gIH1cblxuICBfc2V0Um9vdCA9IChlbG06IEVsZW1lbnQgfCBUTmlsKSA9PiB7XG4gICAgdGhpcy5fcm9vdCA9IGVsbTtcbiAgfTtcblxuICBfZ2V0RHJhZ2dpbmdCb3VuZHMgPSAoKTogRHJhZ2dhYmxlQm91bmRzID0+IHtcbiAgICBpZiAoIXRoaXMuX3Jvb3QpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBzdGF0ZScpO1xuICAgIH1cbiAgICBjb25zdCB7IGxlZnQ6IGNsaWVudFhMZWZ0LCB3aWR0aCB9ID0gdGhpcy5fcm9vdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4geyBjbGllbnRYTGVmdCwgd2lkdGggfTtcbiAgfTtcblxuICBfaGFuZGxlUmVmcmFtZU1vdXNlTW92ZSA9ICh7IHZhbHVlIH06IERyYWdnaW5nVXBkYXRlKSA9PiB7XG4gICAgY29uc3QgW3ZpZXdTdGFydCwgdmlld0VuZF0gPSB0aGlzLnByb3BzLnZpZXdSYW5nZVRpbWUuY3VycmVudDtcbiAgICBjb25zdCBjdXJzb3IgPSBtYXBGcm9tVmlld1N1YlJhbmdlKHZpZXdTdGFydCwgdmlld0VuZCwgdmFsdWUpO1xuICAgIHRoaXMucHJvcHMudXBkYXRlTmV4dFZpZXdSYW5nZVRpbWUoeyBjdXJzb3IgfSk7XG4gIH07XG5cbiAgX2hhbmRsZVJlZnJhbWVNb3VzZUxlYXZlID0gKCkgPT4ge1xuICAgIHRoaXMucHJvcHMudXBkYXRlTmV4dFZpZXdSYW5nZVRpbWUoeyBjdXJzb3I6IHVuZGVmaW5lZCB9KTtcbiAgfTtcblxuICBfaGFuZGxlUmVmcmFtZURyYWdVcGRhdGUgPSAoeyB2YWx1ZSB9OiBEcmFnZ2luZ1VwZGF0ZSkgPT4ge1xuICAgIGNvbnN0IHsgY3VycmVudCwgcmVmcmFtZSB9ID0gdGhpcy5wcm9wcy52aWV3UmFuZ2VUaW1lO1xuICAgIGNvbnN0IFt2aWV3U3RhcnQsIHZpZXdFbmRdID0gY3VycmVudDtcbiAgICBjb25zdCBzaGlmdCA9IG1hcEZyb21WaWV3U3ViUmFuZ2Uodmlld1N0YXJ0LCB2aWV3RW5kLCB2YWx1ZSk7XG4gICAgY29uc3QgYW5jaG9yID0gcmVmcmFtZSA/IHJlZnJhbWUuYW5jaG9yIDogc2hpZnQ7XG4gICAgY29uc3QgdXBkYXRlID0geyByZWZyYW1lOiB7IGFuY2hvciwgc2hpZnQgfSB9O1xuICAgIHRoaXMucHJvcHMudXBkYXRlTmV4dFZpZXdSYW5nZVRpbWUodXBkYXRlKTtcbiAgfTtcblxuICBfaGFuZGxlUmVmcmFtZURyYWdFbmQgPSAoeyBtYW5hZ2VyLCB2YWx1ZSB9OiBEcmFnZ2luZ1VwZGF0ZSkgPT4ge1xuICAgIGNvbnN0IHsgY3VycmVudCwgcmVmcmFtZSB9ID0gdGhpcy5wcm9wcy52aWV3UmFuZ2VUaW1lO1xuICAgIGNvbnN0IFt2aWV3U3RhcnQsIHZpZXdFbmRdID0gY3VycmVudDtcbiAgICBjb25zdCBzaGlmdCA9IG1hcEZyb21WaWV3U3ViUmFuZ2Uodmlld1N0YXJ0LCB2aWV3RW5kLCB2YWx1ZSk7XG4gICAgY29uc3QgYW5jaG9yID0gcmVmcmFtZSA/IHJlZnJhbWUuYW5jaG9yIDogc2hpZnQ7XG4gICAgY29uc3QgW3N0YXJ0LCBlbmRdID0gc2hpZnQgPCBhbmNob3IgPyBbc2hpZnQsIGFuY2hvcl0gOiBbYW5jaG9yLCBzaGlmdF07XG4gICAgbWFuYWdlci5yZXNldEJvdW5kcygpO1xuICAgIHRoaXMucHJvcHMudXBkYXRlVmlld1JhbmdlVGltZShzdGFydCwgZW5kLCAndGltZWxpbmUtaGVhZGVyJyk7XG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgdmlld1JhbmdlVGltZSB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IGN1cnJlbnQsIGN1cnNvciwgcmVmcmFtZSwgc2hpZnRFbmQsIHNoaWZ0U3RhcnQgfSA9IHZpZXdSYW5nZVRpbWU7XG4gICAgY29uc3QgW3ZpZXdTdGFydCwgdmlld0VuZF0gPSBjdXJyZW50O1xuICAgIGNvbnN0IGhhdmVOZXh0VGltZVJhbmdlID0gcmVmcmFtZSAhPSBudWxsIHx8IHNoaWZ0RW5kICE9IG51bGwgfHwgc2hpZnRTdGFydCAhPSBudWxsO1xuICAgIGxldCBjdXNyb3JQb3NpdGlvbjogc3RyaW5nIHwgVE5pbDtcbiAgICBpZiAoIWhhdmVOZXh0VGltZVJhbmdlICYmIGN1cnNvciAhPSBudWxsICYmIGN1cnNvciA+PSB2aWV3U3RhcnQgJiYgY3Vyc29yIDw9IHZpZXdFbmQpIHtcbiAgICAgIGN1c3JvclBvc2l0aW9uID0gYCR7bWFwVG9WaWV3U3ViUmFuZ2Uodmlld1N0YXJ0LCB2aWV3RW5kLCBjdXJzb3IpICogMTAwfSVgO1xuICAgIH1cbiAgICBjb25zdCBzdHlsZXMgPSBnZXRTdHlsZXMoKTtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdlxuICAgICAgICBhcmlhLWhpZGRlblxuICAgICAgICBjbGFzc05hbWU9e3N0eWxlcy5UaW1lbGluZVZpZXdpbmdMYXllcn1cbiAgICAgICAgcmVmPXt0aGlzLl9zZXRSb290fVxuICAgICAgICBvbk1vdXNlRG93bj17dGhpcy5fZHJhZ2dlclJlZnJhbWUuaGFuZGxlTW91c2VEb3dufVxuICAgICAgICBvbk1vdXNlTGVhdmU9e3RoaXMuX2RyYWdnZXJSZWZyYW1lLmhhbmRsZU1vdXNlTGVhdmV9XG4gICAgICAgIG9uTW91c2VNb3ZlPXt0aGlzLl9kcmFnZ2VyUmVmcmFtZS5oYW5kbGVNb3VzZU1vdmV9XG4gICAgICAgIGRhdGEtdGVzdGlkPVwiVGltZWxpbmVWaWV3aW5nTGF5ZXJcIlxuICAgICAgPlxuICAgICAgICB7Y3Vzcm9yUG9zaXRpb24gIT0gbnVsbCAmJiAoXG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAgY2xhc3NOYW1lPXtzdHlsZXMuVGltZWxpbmVWaWV3aW5nTGF5ZXJDdXJzb3JHdWlkZX1cbiAgICAgICAgICAgIHN0eWxlPXt7IGxlZnQ6IGN1c3JvclBvc2l0aW9uIH19XG4gICAgICAgICAgICBkYXRhLXRlc3RpZD1cIlRpbWVsaW5lVmlld2luZ0xheWVyLS1jdXJzb3JHdWlkZVwiXG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cbiAgICAgICAge3JlZnJhbWUgIT0gbnVsbCAmJiBnZXRNYXJrZXJzKHZpZXdTdGFydCwgdmlld0VuZCwgcmVmcmFtZS5hbmNob3IsIHJlZnJhbWUuc2hpZnQsIGZhbHNlKX1cbiAgICAgICAge3NoaWZ0RW5kICE9IG51bGwgJiYgZ2V0TWFya2Vycyh2aWV3U3RhcnQsIHZpZXdFbmQsIHZpZXdFbmQsIHNoaWZ0RW5kLCB0cnVlKX1cbiAgICAgICAge3NoaWZ0U3RhcnQgIT0gbnVsbCAmJiBnZXRNYXJrZXJzKHZpZXdTdGFydCwgdmlld0VuZCwgdmll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LFFBQVEsSUFBSSxJQUFJLElBQUlDLFVBQVUsSUFBSSxJQUFJO0lBQ25GLElBQUlFLGNBQTZCO0lBQ2pDLElBQUksQ0FBQ0QsaUJBQWlCLElBQUlyQyxNQUFNLElBQUksSUFBSSxJQUFJQSxNQUFNLElBQUl4QyxTQUFTLElBQUl3QyxNQUFNLElBQUl2QyxPQUFPLEVBQUU7TUFDcEY2RSxjQUFjLEdBQU0zRSxpQkFBaUIsQ0FBQ0gsU0FBUyxFQUFFQyxPQUFPLEVBQUV1QyxNQUFNLENBQUMsR0FBRyxHQUFHLE1BQUc7SUFDNUU7SUFDQSxJQUFNckIsTUFBTSxHQUFHMUMsU0FBUyxDQUFDLENBQUM7SUFDMUIsb0JBQ0VELEtBQUE7TUFDRSxtQkFBVztNQUNYNkMsU0FBUyxFQUFFRixNQUFNLENBQUN6QyxvQkFBcUI7TUFDdkNxRyxHQUFHLEVBQUUsSUFBSSxDQUFDcEQsUUFBUztNQUNuQnFELFdBQVcsRUFBRSxJQUFJLENBQUNyQixlQUFlLENBQUNzQixlQUFnQjtNQUNsRGpCLFlBQVksRUFBRSxJQUFJLENBQUNMLGVBQWUsQ0FBQ3VCLGdCQUFpQjtNQUNwRGpCLFdBQVcsRUFBRSxJQUFJLENBQUNOLGVBQWUsQ0FBQ3dCLGVBQWdCO01BQ2xELGVBQVksc0JBQXNCO01BQUFDLFFBQUEsR0FFakNOLGNBQWMsSUFBSSxJQUFJLGlCQUNyQnhHLElBQUE7UUFDRStDLFNBQVMsRUFBRUYsTUFBTSxDQUFDdEMsK0JBQWdDO1FBQ2xEeUMsS0FBSyxFQUFFO1VBQUVkLElBQUksRUFBRXNFO1FBQWUsQ0FBRTtRQUNoQyxlQUFZO01BQW1DLENBQ2hELENBQ0YsRUFDQS9CLE9BQU8sSUFBSSxJQUFJLElBQUluQyxVQUFVLENBQUNaLFNBQVMsRUFBRUMsT0FBTyxFQUFFOEMsT0FBTyxDQUFDRSxNQUFNLEVBQUVGLE9BQU8sQ0FBQ0MsS0FBSyxFQUFFLEtBQUssQ0FBQyxFQUN2RjJCLFFBQVEsSUFBSSxJQUFJLElBQUkvRCxVQUFVLENBQUNaLFNBQVMsRUFBRUMsT0FBTyxFQUFFQSxPQUFPLEVBQUUwRSxRQUFRLEVBQUUsSUFBSSxDQUFDLEVBQzNFQyxVQUFVLElBQUksSUFBSSxJQUFJaEUsVUFBVSxDQUFDWixTQUFTLEVBQUVDLE9BQU8sRUFBRUQsU0FBUyxFQUFFNEUsVUFBVSxFQUFFLElBQUksQ0FBQztJQUFBLENBQy9FLENBQUM7RUFFVixDQUFDO0VBQUEsT0FBQWxHLG9CQUFBO0FBQUEsRUFyRytDUixLQUFLLENBQUNtSCxhQUFhO0FBQUEsU0FBaEQzRyxvQkFBb0IsSUFBQTRHLE9BQUEiLCJpZ25vcmVMaXN0IjpbXX0=